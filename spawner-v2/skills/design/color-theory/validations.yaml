# Color Theory Validations
# Automated checks to catch color-related issues in code

validations:
  - id: hardcoded-hex-colors
    name: Hardcoded Hex Colors
    severity: warning
    type: regex
    pattern: '(?:color|background|border-color|fill|stroke):\s*#[0-9a-fA-F]{3,8}(?!.*var\()'
    message: "Hardcoded hex color detected. Use color tokens for maintainability."
    fix_action: "Replace with CSS variable (e.g., var(--color-primary)) or Tailwind class"
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.less"
    test_cases:
      should_match:
        - "color: #FF0000;"
        - "background: #fff;"
        - "border-color: #2563EB;"
      should_not_match:
        - "color: var(--text-primary);"
        - "/* #FF0000 is the brand color */"

  - id: hardcoded-rgb-colors
    name: Hardcoded RGB Colors
    severity: warning
    type: regex
    pattern: '(?:color|background|border-color):\s*rgba?\([^)]+\)(?!.*var\()'
    message: "Hardcoded RGB/RGBA color detected. Use color tokens."
    fix_action: "Replace with CSS variable that contains the color value"
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "color: rgb(255, 0, 0);"
        - "background: rgba(0, 0, 0, 0.5);"
      should_not_match:
        - "background: var(--overlay-bg);"

  - id: inline-style-colors
    name: Inline Style Color Values
    severity: warning
    type: regex
    pattern: 'style=\{?\{[^}]*(?:color|background|backgroundColor|borderColor):\s*["\']#[0-9a-fA-F]+'
    message: "Inline style with hardcoded color. Use className with tokens."
    fix_action: "Move color to CSS class or use Tailwind utility with design token"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "style={{ color: '#FF0000' }}"
        - "style={{ backgroundColor: '#2563EB' }}"
      should_not_match:
        - "style={{ color: 'var(--primary)' }}"
        - "className=\"text-primary\""

  - id: low-contrast-gray-text
    name: Potential Low Contrast Gray Text
    severity: error
    type: regex
    pattern: 'text-gray-[345]00(?:\s|"|$)|color:\s*#[9-b][9-b][9-b]'
    message: "Light gray text may fail WCAG contrast requirements on white backgrounds."
    fix_action: "Use text-gray-600 or darker (5.0:1+ contrast on white)"
    applies_to:
      - "*.tsx"
      - "*.jsx"
      - "*.css"
    test_cases:
      should_match:
        - "className=\"text-gray-400\""
        - "text-gray-300 bg-white"
        - "color: #999999;"
      should_not_match:
        - "text-gray-600"
        - "text-gray-700"
        - "color: #374151;"

  - id: missing-dark-mode-variant
    name: Missing Dark Mode Color Variant
    severity: warning
    type: regex
    pattern: '(?:bg-white|bg-black|bg-gray-[0-9]{2,3})(?![^"]*dark:)'
    message: "Background color without dark mode variant."
    fix_action: "Add dark: variant (e.g., bg-white dark:bg-gray-900)"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "className=\"bg-white\""
        - "className=\"bg-gray-100\""
      should_not_match:
        - "className=\"bg-white dark:bg-gray-900\""
        - "className=\"bg-gray-100 dark:bg-gray-800\""

  - id: color-only-error-state
    name: Color-Only Error Indicator
    severity: error
    type: regex
    pattern: '(?:border|ring)-red-[0-9]+(?![^"]*(?:icon|Icon|error|Error|message|Message|text-))'
    message: "Error indicated by color only. Add icon or text for accessibility."
    fix_action: "Pair red border with error icon and/or error message text"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "className=\"border-red-500\""
        - "ring-red-400"
      should_not_match:
        - "border-red-500 flex\"><ErrorIcon"
        - "border-red-500\"><span className=\"text-red"

  - id: oklch-without-fallback
    name: OKLCH Without Fallback
    severity: warning
    type: regex
    pattern: '^\s*(?:color|background|border-color):\s*oklch\([^)]+\);?\s*$'
    message: "OKLCH color without fallback for older browsers."
    fix_action: "Add hex or rgb fallback before OKLCH declaration"
    applies_to:
      - "*.css"
      - "*.scss"
    test_cases:
      should_match:
        - "color: oklch(50% 0.2 240);"
        - "background: oklch(95% 0.05 150);"
      should_not_match:
        - |
          color: #2563EB;
          color: oklch(55% 0.25 240);

  - id: removed-focus-outline
    name: Removed Focus Outline
    severity: critical
    type: regex
    pattern: 'outline:\s*(?:none|0)(?![^}]*outline:\s*[^none0])|outline-width:\s*0'
    message: "Focus outline removed. Keyboard users cannot see focus."
    fix_action: "Add focus-visible styles with visible indicator (2px+ solid color)"
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "outline: none;"
        - "outline: 0;"
        - "outline-width: 0;"
      should_not_match:
        - |
          outline: none;
          outline: 2px solid blue;

  - id: pure-black-white-colors
    name: Pure Black or White Colors
    severity: info
    type: regex
    pattern: '(?:bg|text|border)-(?:black|white)(?!\s*dark:)|#(?:000000|FFFFFF|fff|000)(?:\s|;|"|$)'
    message: "Pure black/white creates harsh contrast (21:1). Consider softer alternatives."
    fix_action: "Use near-black (#1A1A1A) or off-white (#FAFAFA) for gentler contrast"
    applies_to:
      - "*.tsx"
      - "*.jsx"
      - "*.css"
    test_cases:
      should_match:
        - "bg-black"
        - "text-white"
        - "color: #000000;"
        - "background: #FFFFFF;"
      should_not_match:
        - "bg-gray-900"
        - "text-gray-50"
        - "bg-black dark:bg-white"

  - id: saturated-dark-mode-colors
    name: High Saturation in Dark Mode
    severity: warning
    type: regex
    pattern: 'dark:(?:bg|text|border)-(?:red|green|blue|yellow|purple|pink|orange)-[5-9]00'
    message: "Highly saturated color in dark mode may cause eye strain."
    fix_action: "Use lighter, less saturated variant for dark mode (e.g., dark:text-blue-400)"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "dark:bg-blue-600"
        - "dark:text-red-500"
        - "dark:border-green-700"
      should_not_match:
        - "dark:bg-blue-400"
        - "dark:text-red-300"

  - id: red-green-combination
    name: Red/Green Color Combination
    severity: warning
    type: regex
    pattern: '(?:bg|text|border)-red-[0-9]+[^"]*(?:bg|text|border)-green-|(?:bg|text|border)-green-[0-9]+[^"]*(?:bg|text|border)-red-'
    message: "Red and green combination problematic for color blind users (8% of men)."
    fix_action: "Use blue/orange or add non-color indicators (icons, patterns)"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "className=\"bg-red-500 text-green-500\""
        - "border-green-400 bg-red-100"
      should_not_match:
        - "bg-red-500 text-white"
        - "bg-green-500"

  - id: magic-color-numbers
    name: Magic Color Values
    severity: warning
    type: regex
    pattern: 'bg-\[[^\]]*(?:#|rgb|hsl|oklch)[^\]]+\]|text-\[[^\]]*(?:#|rgb)[^\]]+\]'
    message: "Arbitrary color value. Define as design token for consistency."
    fix_action: "Add to Tailwind config as named color or use CSS variable"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "bg-[#FF5733]"
        - "text-[rgb(255,87,51)]"
      should_not_match:
        - "bg-primary"
        - "bg-blue-500"

  - id: opacity-color-hack
    name: Opacity Color Hack
    severity: info
    type: regex
    pattern: '(?:bg|text|border)-[a-z]+-[0-9]+/[0-9]+'
    message: "Using opacity modifier. Ensure adequate contrast is maintained."
    fix_action: "Verify contrast ratio of resulting color combination"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "bg-blue-500/50"
        - "text-gray-900/75"
      should_not_match:
        - "bg-blue-500"
        - "opacity-50"

  - id: missing-semantic-color
    name: Missing Semantic Color Usage
    severity: info
    type: regex
    pattern: '(?:success|error|warning|danger|info).*(?:bg|text|border)-(?:green|red|yellow|blue)-[0-9]+'
    message: "Consider using semantic color token instead of direct color."
    fix_action: "Use semantic tokens: color-success, color-danger, color-warning, color-info"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "isError && \"text-red-500\""
        - "success ? \"bg-green-100\""
      should_not_match:
        - "text-success"
        - "bg-danger"
