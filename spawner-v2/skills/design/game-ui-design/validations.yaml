# Game UI Design Validations
# Automated regex checks to catch common game UI mistakes

validations:
  # ==============================================================================
  # CRITICAL: Platform compatibility and accessibility
  # ==============================================================================

  - id: hardcoded-screen-position
    name: Hardcoded Screen Position
    severity: error
    type: regex
    pattern: 'position:\s*(absolute|fixed)[^}]*(left|right|top|bottom):\s*0(px)?[^}]*(left|right|top|bottom):\s*0(px)?'
    message: "UI element positioned at exact screen corner. May be cut off on TVs due to overscan."
    fix_action: "Implement safe zone margins (5-10%) and allow user adjustment in settings"
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "position: absolute; left: 0; top: 0;"
        - "position: fixed; right: 0px; bottom: 0px;"
      should_not_match:
        - "position: absolute; left: 5%; top: 5%;"
        - "position: relative; left: 0;"

  - id: small-font-size
    name: Font Size Too Small
    severity: error
    type: regex
    pattern: 'font-?[Ss]ize[:\s=]+["\']?([0-9]|1[0-3])(px|pt|rem)?["\']?'
    message: "Font size under 14px. Too small for game UI, especially on TVs and handhelds."
    fix_action: "Use minimum 14px for secondary text, 16-18px for body, 24px+ for important info"
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.tsx"
      - "*.jsx"
      - "*.cs"
      - "*.gd"
    test_cases:
      should_match:
        - "font-size: 12px"
        - "fontSize: 10"
        - "fontSize=\"11px\""
      should_not_match:
        - "font-size: 16px"
        - "fontSize: 24"
        - "font-size: 14px"

  - id: hardcoded-button-prompt
    name: Hardcoded Button Prompt
    severity: error
    type: regex
    pattern: '["\'](Press|Hit|Tap|Push)\s+(A|B|X|Y|Start|Select|Space|Enter|LB|RB|LT|RT|L1|R1|L2|R2)["\']'
    message: "Hardcoded button prompt. Won't adapt to controller type or key rebinding."
    fix_action: "Use input action names and dynamically resolve to current binding/controller glyphs"
    applies_to:
      - "*.cs"
      - "*.gd"
      - "*.tsx"
      - "*.jsx"
      - "*.json"
    test_cases:
      should_match:
        - "\"Press A to continue\""
        - "'Hit Space to jump'"
        - "\"Tap X\""
      should_not_match:
        - "GetActionPrompt(\"jump\")"
        - "Press {jumpButton} to continue"

  - id: small-touch-target
    name: Touch Target Too Small
    severity: error
    type: regex
    pattern: '(width|height|size)[:\s=]+["\']?([0-3][0-9]|[0-9])(px|dp|pt)?["\']?(?!\d)'
    message: "Element smaller than 44px. Too small for reliable touch or controller selection."
    fix_action: "Minimum touch target: 44x44pt (Apple), 48x48dp (Google). Expand hit area if visual must be smaller."
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "width: 24px"
        - "height: 32px"
        - "size: 16"
      should_not_match:
        - "width: 48px"
        - "height: 100px"
        - "size: 300"

  - id: color-only-meaning
    name: Color-Only Information
    severity: warning
    type: regex
    pattern: '(enemy|hostile|danger|warning|error).*color:\s*(red|#[fF][0-9a-fA-F]{2}[0-9a-fA-F]{2})|color:\s*(red|green).*!(icon|shape|text)'
    message: "Color appears to be sole indicator. Colorblind players may not distinguish."
    fix_action: "Add shape, icon, or text backup for all color-coded information"
    applies_to:
      - "*.css"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "enemy: { color: red }"
        - "color: red; // danger indicator"
      should_not_match:
        - "enemy: { color: red, icon: skull }"

  # ==============================================================================
  # HIGH: Common UI design mistakes
  # ==============================================================================

  - id: no-text-shadow-outline
    name: HUD Text Without Shadow/Outline
    severity: warning
    type: regex
    pattern: 'class.*["\'].*hud.*["\'][^}]*(?!text-shadow|outline|stroke)'
    message: "HUD text element without shadow or outline. May be unreadable on varied backgrounds."
    fix_action: "Add 2px contrasting outline or drop shadow to all HUD text"
    applies_to:
      - "*.css"
      - "*.scss"

  - id: missing-controller-navigation
    name: Missing Controller Navigation Setup
    severity: warning
    type: regex
    pattern: '<(button|Button|a)[^>]+(?!.*navigation|.*selectable|.*focusable)[^>]*>'
    message: "Interactive element may not support controller navigation."
    fix_action: "Ensure element is focusable and has explicit navigation to adjacent elements"
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "<button onClick={click}>Submit</button>"
      should_not_match:
        - "<Button navigation={nav} onClick={click}>Submit</Button>"

  - id: long-animation-duration
    name: Long Animation Duration
    severity: warning
    type: regex
    pattern: 'animation-?[Dd]uration[:\s=]+["\']?([5-9][0-9]{2}|[1-9][0-9]{3,})(ms)?["\']?|animation-?[Dd]uration[:\s=]+["\']?([1-9])(s)["\']?'
    message: "Animation longer than 500ms. May cause motion discomfort for sensitive players."
    fix_action: "Keep UI animations under 300ms. Provide reduced motion option in settings."
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "animation-duration: 1s"
        - "animationDuration: 800ms"
        - "animation-duration: 1500"
      should_not_match:
        - "animation-duration: 200ms"
        - "animationDuration: 300"

  - id: fixed-pixel-dimensions
    name: Fixed Pixel Dimensions
    severity: warning
    type: regex
    pattern: '(width|height):\s*[0-9]{3,4}px(?!\s*\/\*.*scale|.*responsive)'
    message: "Large fixed pixel dimensions. May not scale properly across resolutions."
    fix_action: "Use percentage, viewport units, or scale relative to reference resolution"
    applies_to:
      - "*.css"
      - "*.scss"
    test_cases:
      should_match:
        - "width: 1920px"
        - "height: 1080px"
      should_not_match:
        - "width: 100%"
        - "height: 50vh"

  - id: z-index-war
    name: Excessive Z-Index
    severity: warning
    type: regex
    pattern: 'z-?[Ii]ndex[:\s=]+["\']?[0-9]{4,}["\']?'
    message: "Z-index over 1000. Indicates layering system problems."
    fix_action: "Establish z-index scale: dropdowns 100, modals 200, tooltips 300, notifications 400"
    applies_to:
      - "*.css"
      - "*.scss"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - "z-index: 9999"
        - "zIndex: 10000"
      should_not_match:
        - "z-index: 100"
        - "zIndex: 500"

  # ==============================================================================
  # MEDIUM: Best practices
  # ==============================================================================

  - id: magic-number-positions
    name: Magic Number Positioning
    severity: info
    type: regex
    pattern: '(margin|padding|top|left|right|bottom):\s*[0-9]{2,}px(?!\s*\/\*)'
    message: "Hardcoded pixel positions. Consider using spacing scale or design tokens."
    fix_action: "Use spacing scale (8px, 16px, 24px, 32px) or CSS variables for consistency"
    applies_to:
      - "*.css"
      - "*.scss"
    test_cases:
      should_match:
        - "margin: 17px"
        - "padding-left: 23px"
      should_not_match:
        - "margin: var(--space-md)"
        - "padding: 16px"

  - id: missing-hover-state
    name: Missing Hover State
    severity: warning
    type: regex
    pattern: '<[Bb]utton[^>]*className=["\'][^"\']*["\'][^>]*>(?![^<]*:hover)'
    message: "Button without hover state indication. May confuse players about interactivity."
    fix_action: "Add hover state with visual change (background, border, scale)"
    applies_to:
      - "*.tsx"
      - "*.jsx"

  - id: missing-focus-visible
    name: Missing Keyboard Focus Indicator
    severity: warning
    type: regex
    pattern: '(outline:\s*none|outline:\s*0)(?![^}]*:focus-visible)'
    message: "Removed outline without focus-visible alternative. Keyboard/controller users can't see focus."
    fix_action: "Add :focus-visible style with visible indicator (outline, ring, glow)"
    applies_to:
      - "*.css"
      - "*.scss"
    test_cases:
      should_match:
        - "outline: none;"
        - "outline: 0;"
      should_not_match:
        - "outline: none; } .btn:focus-visible { outline: 2px solid blue; }"

  - id: unity-canvas-no-scaler
    name: Unity Canvas Without Scaler
    severity: warning
    type: regex
    pattern: 'Canvas[^}]*(?!CanvasScaler|ScaleWithScreenSize)'
    message: "Unity Canvas may not have proper scaling for different resolutions."
    fix_action: "Add CanvasScaler with Scale With Screen Size mode, reference 1920x1080"
    applies_to:
      - "*.cs"
      - "*.unity"

  - id: godot-control-fixed-size
    name: Godot Control Fixed Size
    severity: warning
    type: regex
    pattern: 'custom_minimum_size\s*=\s*Vector2\s*\(\s*[0-9]{3,}'
    message: "Large fixed minimum size on Godot Control node. May not scale properly."
    fix_action: "Use anchors, grow directions, and size flags for responsive UI"
    applies_to:
      - "*.tscn"
      - "*.tres"
      - "*.gd"

  - id: no-reduced-motion-check
    name: Missing Reduced Motion Check
    severity: info
    type: regex
    pattern: '@keyframes|animation:|transition:[^}]*[5-9][0-9]{2}ms'
    message: "Animations defined without checking prefers-reduced-motion."
    fix_action: "Add @media (prefers-reduced-motion: reduce) to disable/reduce animations"
    applies_to:
      - "*.css"
      - "*.scss"

  - id: hardcoded-resolution
    name: Hardcoded Resolution Reference
    severity: warning
    type: regex
    pattern: '(1920|1080|2560|1440|3840|2160)[^0-9].*resolution|screenWidth.*=.*1920|screenHeight.*=.*1080'
    message: "Hardcoded resolution values. Should use dynamic screen dimensions."
    fix_action: "Use Screen.width/height or reference resolution with scaling"
    applies_to:
      - "*.cs"
      - "*.gd"
      - "*.tsx"
    test_cases:
      should_match:
        - "const screenWidth = 1920;"
        - "if (resolution.x == 1920)"
      should_not_match:
        - "referenceResolution = new Vector2(1920, 1080);"

  - id: static-button-text
    name: Static Button Text Instead of Localized
    severity: info
    type: regex
    pattern: '>["\']?(OK|Cancel|Yes|No|Continue|Back|Exit|Quit|Save|Load)["\']?<'
    message: "Static button text. Consider localization support."
    fix_action: "Use localization keys: GetLocalizedString(\"ui_ok\") or equivalent"
    applies_to:
      - "*.tsx"
      - "*.jsx"
      - "*.xml"

  - id: tooltip-no-delay
    name: Tooltip Without Delay
    severity: info
    type: regex
    pattern: '(onMouseEnter|onHover|@mouse_entered)[^}]*show.*[Tt]ooltip(?![^}]*delay|setTimeout|timer)'
    message: "Tooltip appears immediately on hover. May flash during normal navigation."
    fix_action: "Add 300-500ms delay before showing tooltips"
    applies_to:
      - "*.tsx"
      - "*.jsx"
      - "*.cs"
      - "*.gd"

  # ==============================================================================
  # GAME ENGINE SPECIFIC
  # ==============================================================================

  - id: unity-find-ui-element
    name: Unity Find for UI Element
    severity: warning
    type: regex
    pattern: 'GameObject\.Find\s*\([^)]*("Canvas"|"Button"|"Text"|"Image"|"Panel"|UI)'
    message: "Using Find to locate UI elements. Cache references in Awake or use SerializeField."
    fix_action: "Use [SerializeField] private Button _button; and assign in Inspector"
    applies_to:
      - "*.cs"

  - id: unity-ui-raycast-target
    name: Unity UI Without Raycast Consideration
    severity: info
    type: regex
    pattern: 'Image[^}]*(?!raycastTarget\s*=\s*false)'
    message: "Image components default to raycastTarget=true. Disable on decorative images."
    fix_action: "Set raycastTarget=false on non-interactive images to improve performance"
    applies_to:
      - "*.cs"

  - id: godot-signal-not-connected
    name: Godot UI Signal Emission Without Connection
    severity: info
    type: regex
    pattern: '\.emit\s*\([^)]*\)(?![^}]*\.connect)'
    message: "Signal emitted but connection not visible in same file. Ensure signal is connected."
    fix_action: "Connect signals in _ready() or via editor"
    applies_to:
      - "*.gd"
