# Icon Design Validations
# Automated checks to catch icon design anti-patterns in code

validations:
  - id: hardcoded-svg-fill-color
    name: Hardcoded Fill Color in SVG
    severity: error
    type: regex
    pattern: 'fill="(#[0-9a-fA-F]{3,6}|rgb\(|rgba\(|black|white|gray|grey|red|blue|green)'
    message: "Hardcoded fill color prevents theme/dark mode support."
    fix_action: "Use fill='currentColor' to inherit color from CSS, or use CSS custom properties."
    applies_to:
      - "*.svg"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - 'fill="#000000"'
        - 'fill="#fff"'
        - 'fill="rgb(0, 0, 0)"'
        - 'fill="black"'
        - 'fill="#333333"'
      should_not_match:
        - 'fill="currentColor"'
        - 'fill="none"'
        - "fill={color}"
        - "fill='var(--icon-color)'"

  - id: hardcoded-svg-stroke-color
    name: Hardcoded Stroke Color in SVG
    severity: error
    type: regex
    pattern: 'stroke="(#[0-9a-fA-F]{3,6}|rgb\(|rgba\(|black|white|gray|grey|red|blue|green)'
    message: "Hardcoded stroke color prevents theme/dark mode support."
    fix_action: "Use stroke='currentColor' to inherit color from CSS."
    applies_to:
      - "*.svg"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - 'stroke="#000"'
        - 'stroke="#1a1a1a"'
        - 'stroke="rgb(51, 51, 51)"'
        - 'stroke="black"'
      should_not_match:
        - 'stroke="currentColor"'
        - 'stroke="none"'
        - "stroke={strokeColor}"

  - id: missing-viewbox
    name: SVG Missing viewBox Attribute
    severity: error
    type: regex
    pattern: '<svg(?![^>]*viewBox)[^>]*>'
    message: "SVG missing viewBox attribute - required for proper scaling."
    fix_action: "Add viewBox attribute matching design dimensions (e.g., viewBox='0 0 24 24')."
    applies_to:
      - "*.svg"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - '<svg width="24" height="24">'
        - '<svg xmlns="http://www.w3.org/2000/svg">'
        - '<svg className="icon">'
      should_not_match:
        - '<svg viewBox="0 0 24 24">'
        - '<svg viewBox="0 0 16 16" fill="none">'

  - id: non-standard-viewbox
    name: Non-Standard SVG viewBox Dimensions
    severity: warning
    type: regex
    pattern: 'viewBox="0 0 (?!(16 16|20 20|24 24|32 32|48 48)")[0-9]+ [0-9]+"'
    message: "Non-standard viewBox dimensions may cause inconsistent sizing."
    fix_action: "Use standard icon sizes: 16x16, 20x20, 24x24, 32x32, or 48x48."
    applies_to:
      - "*.svg"
    test_cases:
      should_match:
        - 'viewBox="0 0 18 18"'
        - 'viewBox="0 0 22 22"'
        - 'viewBox="0 0 28 28"'
      should_not_match:
        - 'viewBox="0 0 24 24"'
        - 'viewBox="0 0 16 16"'
        - 'viewBox="0 0 32 32"'

  - id: hardcoded-svg-dimensions
    name: Hardcoded Width/Height on SVG
    severity: warning
    type: regex
    pattern: '<svg[^>]*(width="[0-9]+(px)?"|height="[0-9]+(px)?")[^>]*>'
    message: "Hardcoded dimensions prevent flexible sizing via CSS."
    fix_action: "Remove width/height attributes; use viewBox only. Size via CSS."
    applies_to:
      - "*.svg"
    test_cases:
      should_match:
        - '<svg width="24" height="24" viewBox="0 0 24 24">'
        - '<svg height="16px" viewBox="0 0 16 16">'
        - '<svg width="32">'
      should_not_match:
        - '<svg viewBox="0 0 24 24">'
        - '<svg viewBox="0 0 24 24" fill="none">'

  - id: svg-metadata-bloat
    name: Unnecessary SVG Metadata
    severity: info
    type: regex
    pattern: '<(metadata|defs>|desc>|title>(?!.*</title>)|sodipodi|inkscape)'
    message: "SVG contains unnecessary metadata adding file size."
    fix_action: "Optimize SVG with SVGO or SVGOMG to remove metadata."
    applies_to:
      - "*.svg"
    test_cases:
      should_match:
        - '<metadata>Created with Illustrator</metadata>'
        - '<defs>'
        - '<sodipodi:namedview'
        - '<inkscape:version>'
      should_not_match:
        - '<path d="M0 0h24v24H0z"/>'
        - '<title id="icon-title">Settings</title>'

  - id: excessive-path-precision
    name: Excessive Path Coordinate Precision
    severity: info
    type: regex
    pattern: 'd="[^"]*\d+\.\d{4,}'
    message: "Path coordinates have excessive decimal precision."
    fix_action: "Optimize with SVGO - 2 decimal places is sufficient for icons."
    applies_to:
      - "*.svg"
    test_cases:
      should_match:
        - 'd="M12.345678 0L24.12345678 12"'
        - 'd="M3.14159265359 12"'
      should_not_match:
        - 'd="M12.35 0L24.12 12"'
        - 'd="M3 12h18"'
        - 'd="M12 3L22 12L12 21"'

  - id: inconsistent-stroke-width
    name: Non-Standard Stroke Width
    severity: warning
    type: regex
    pattern: 'stroke-width="(?!1|1\.5|2|2\.5|3")[0-9.]+"'
    message: "Stroke width outside standard scale (1, 1.5, 2, 2.5, 3)."
    fix_action: "Use standard stroke widths for consistency across icon set."
    applies_to:
      - "*.svg"
    test_cases:
      should_match:
        - 'stroke-width="1.2"'
        - 'stroke-width="1.75"'
        - 'stroke-width="0.5"'
      should_not_match:
        - 'stroke-width="1"'
        - 'stroke-width="1.5"'
        - 'stroke-width="2"'

  - id: icon-missing-aria-hidden
    name: Decorative Icon Missing aria-hidden
    severity: warning
    type: regex
    pattern: '<svg[^>]*className="[^"]*icon[^"]*"[^>]*>(?![^<]*aria-hidden)'
    message: "Icon may need aria-hidden='true' if decorative."
    fix_action: "Add aria-hidden='true' for decorative icons, or aria-label for meaningful icons."
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - '<svg className="icon">'
        - '<svg className="w-4 h-4 icon-sm">'
      should_not_match:
        - '<svg className="icon" aria-hidden="true">'
        - '<svg aria-hidden="true" className="icon">'

  - id: icon-button-missing-label
    name: Icon Button Missing Accessible Label
    severity: error
    type: regex
    pattern: '<button[^>]*>[\s\n]*<(svg|Icon|[A-Z][a-z]+Icon)[^>]*/?>'
    message: "Icon-only button missing accessible name."
    fix_action: "Add aria-label to button or include visually hidden text."
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - '<button><svg viewBox="0 0 24 24"></svg>'
        - '<button className="btn">\n<TrashIcon />'
        - '<button><Icon name="close" /></button>'
      should_not_match:
        - '<button aria-label="Close"><XIcon /></button>'
        - '<button><SaveIcon /><span>Save</span></button>'

  - id: tiny-icon-touch-target
    name: Icon Touch Target Too Small
    severity: error
    type: regex
    pattern: '<button[^>]*className="[^"]*\b(p-0|p-1|w-4|w-5|w-6|h-4|h-5|h-6)\b[^"]*"[^>]*>[\s\n]*<(svg|Icon|[A-Z][a-z]+Icon)'
    message: "Icon button touch target smaller than 44x44px minimum."
    fix_action: "Ensure button is at least 44x44px for accessibility (p-2.5 with 24px icon)."
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - '<button className="p-1"><TrashIcon /></button>'
        - '<button className="w-6 h-6"><XIcon />'
      should_not_match:
        - '<button className="p-3"><TrashIcon /></button>'
        - '<button className="w-11 h-11"><XIcon />'

  - id: animation-missing-reduced-motion
    name: Icon Animation Without Reduced Motion Support
    severity: error
    type: regex
    pattern: '(animate-spin|animate-bounce|animate-pulse)(?![^}]*prefers-reduced-motion)'
    message: "Animated icon class without reduced motion consideration."
    fix_action: "Add @media (prefers-reduced-motion: reduce) override or use motion-safe: prefix."
    applies_to:
      - "*.tsx"
      - "*.jsx"
      - "*.css"
    test_cases:
      should_match:
        - 'className="animate-spin"'
        - 'animate-bounce'
        - 'class="animate-pulse"'
      should_not_match:
        - 'className="motion-safe:animate-spin"'
        - 'motion-reduce:animate-none'

  - id: inline-svg-style
    name: Inline Style on SVG Elements
    severity: warning
    type: regex
    pattern: '<(svg|path|circle|rect|line|polygon)[^>]*style="[^"]*"'
    message: "Inline styles on SVG elements - prefer classes or attributes."
    fix_action: "Move styles to CSS classes or use SVG attributes directly."
    applies_to:
      - "*.svg"
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - '<path style="fill: red">'
        - '<svg style="width: 24px">'
        - '<circle style="stroke-width: 2px">'
      should_not_match:
        - '<path fill="currentColor">'
        - '<svg className="icon">'

  - id: mixed-icon-styles
    name: Mixed Filled and Outline Icons in Same Context
    severity: info
    type: regex
    pattern: '(Outline|Solid|Filled|Fill)[A-Z][a-z]+Icon[^}]*\s+(Outline|Solid|Filled|Fill)[A-Z][a-z]+Icon'
    message: "Mixing icon styles (outline/filled) in same component."
    fix_action: "Use consistent icon style within a component or icon group."
    applies_to:
      - "*.tsx"
      - "*.jsx"
    test_cases:
      should_match:
        - 'OutlineHomeIcon /> <SolidUserIcon />'
        - '<FilledIcon />\n<OutlineIcon />'
      should_not_match:
        - 'OutlineHomeIcon /> <OutlineUserIcon />'
        - '<SolidTrashIcon /> <SolidEditIcon />'

# Additional validation context
validation_context:
  icon_size_standards:
    - "16x16 - Small icons, tight spaces"
    - "20x20 - Compact UI, dense lists"
    - "24x24 - Standard UI icons"
    - "32x32 - Emphasized icons, headers"
    - "48x48 - Large display, marketing"

  stroke_width_standards:
    - "1px - 16px icons or minimal style"
    - "1.5px - 24px icons standard"
    - "2px - 32px+ icons or bold style"

  touch_target_requirements:
    - "44x44px - WCAG 2.5.5 minimum"
    - "48x48dp - Android Material guidelines"
    - "44x44pt - Apple HIG minimum"
