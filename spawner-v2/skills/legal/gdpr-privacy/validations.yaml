validations:

  - id: hardcoded-consent
    name: Hardcoded Consent Value
    severity: error
    type: regex
    pattern:
      - "consent\\s*[:=]\\s*true"
      - "hasConsent\\s*=\\s*true"
      - "gdprConsent.*true"
    message: "Consent appears hardcoded. Must be explicit user action."
    fix_action: "Implement proper consent collection with user action"
    applies_to:
      - "**/*.js"
      - "**/*.ts"

  - id: no-consent-timestamp
    name: Missing Consent Timestamp
    severity: warning
    type: regex
    pattern:
      - "consent(?!.*timestamp|.*date|.*time|.*when)"
    message: "Consent storage may lack timestamp for audit trail."
    fix_action: "Record when consent was given with ISO timestamp"
    applies_to:
      - "**/*.js"
      - "**/*.ts"

  - id: preticked-checkbox
    name: Pre-ticked Consent Checkbox
    severity: error
    type: regex
    pattern:
      - "checked\\s*[:=]\\s*true.*consent"
      - "defaultChecked.*consent"
      - "consent.*checked.*default"
    message: "Pre-ticked consent boxes are invalid under GDPR."
    fix_action: "Remove default checked state from consent checkboxes"
    applies_to:
      - "**/*.jsx"
      - "**/*.tsx"
      - "**/*.html"

  - id: missing-withdrawal-mechanism
    name: No Consent Withdrawal Mechanism
    severity: warning
    type: regex
    pattern:
      - "setConsent.*true(?!.*withdraw|.*revoke|.*remove)"
    message: "Consent collection without corresponding withdrawal mechanism."
    fix_action: "Implement equally easy consent withdrawal"
    applies_to:
      - "**/*.js"
      - "**/*.ts"

  - id: personal-data-logging
    name: Personal Data in Logs
    severity: error
    type: regex
    pattern:
      - "console\\.log.*email"
      - "logger.*personalData"
      - "log.*\\b(ssn|passport|dob)\\b"
    message: "Personal data may be logged without protection."
    fix_action: "Mask or remove personal data from logs"
    applies_to:
      - "**/*.js"
      - "**/*.ts"
      - "**/*.py"

  - id: infinite-retention
    name: No Data Retention Limit
    severity: warning
    type: regex
    pattern:
      - "store.*personal.*(?!expir|ttl|retention)"
      - "save.*userData(?!.*delete|.*purge)"
    message: "Personal data storage without retention limit."
    fix_action: "Implement retention policy with automatic deletion"
    applies_to:
      - "**/*.js"
      - "**/*.ts"

  - id: unencrypted-sensitive-data
    name: Unencrypted Sensitive Data
    severity: error
    type: regex
    pattern:
      - "healthData.*=.*\\{(?!.*encrypt)"
      - "biometric.*store(?!.*encrypt)"
      - "racialOrigin|politicalOpinion|religiousBelief"
    message: "Sensitive data may not be encrypted at rest."
    fix_action: "Encrypt sensitive (Article 9) data at rest"
    applies_to:
      - "**/*.js"
      - "**/*.ts"

  - id: missing-legal-basis
    name: Processing Without Legal Basis
    severity: warning
    type: regex
    pattern:
      - "processPersonalData(?!.*legalBasis|.*consent|.*contract)"
    message: "Processing function may not document legal basis."
    fix_action: "Document and validate legal basis before processing"
    applies_to:
      - "**/*.js"
      - "**/*.ts"
