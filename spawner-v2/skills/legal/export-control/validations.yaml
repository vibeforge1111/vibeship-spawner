validations:

  - id: no-country-check
    name: Export Without Country Check
    severity: error
    type: regex
    pattern:
      - "export(?!.*country|.*destination|.*embargo)"
      - "shipTo(?!.*validateCountry|.*checkEmbargo)"
    message: "Export may not validate destination country restrictions."
    fix_action: "Check country against embargo and license requirements"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: no-party-screening
    name: Missing Party Screening
    severity: error
    type: regex
    pattern:
      - "createOrder(?!.*screenParty|.*dplCheck|.*sdnCheck)"
      - "processExport(?!.*denied.*list)"
    message: "Transaction may not screen against denied party lists."
    fix_action: "Screen all parties against DPL, Entity List, SDN"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: hardcoded-country-list
    name: Hardcoded Embargo List
    severity: warning
    type: regex
    pattern:
      - "embargoedCountries\\s*=\\s*\\["
      - "restrictedCountries.*\\[.*'CU'.*'IR'"
    message: "Hardcoded embargo list may become outdated."
    fix_action: "Use external source for embargo list with regular updates"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: encryption-no-classification
    name: Encryption Without Classification
    severity: warning
    type: regex
    pattern:
      - "AES|RSA|crypto(?!.*eccn|.*classification|.*ear)"
    message: "Encryption functionality may require export classification."
    fix_action: "Classify encryption items under EAR Category 5"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: foreign-access-unchecked
    name: Foreign National Access Unchecked
    severity: warning
    type: regex
    pattern:
      - "grantAccess(?!.*citizenship|.*usPersonCheck)"
      - "addTeamMember(?!.*nationality)"
    message: "Access granted without checking foreign national status."
    fix_action: "Verify US person status before controlled data access"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: no-end-use-check
    name: Missing End Use Verification
    severity: warning
    type: regex
    pattern:
      - "export(?!.*endUse|.*prohibited.*use)"
      - "shipment(?!.*intended.*use)"
    message: "Export may not verify end use restrictions."
    fix_action: "Document and verify intended end use"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: screening-not-logged
    name: Party Screening Not Logged
    severity: info
    type: regex
    pattern:
      - "screenParty(?!.*log|.*audit|.*record)"
      - "dplCheck(?!.*document)"
    message: "Party screening results may not be logged for audit."
    fix_action: "Log all screening results with timestamp"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: cloud-region-uncontrolled
    name: Cloud Region Not Restricted
    severity: warning
    type: regex
    pattern:
      - "s3.*Bucket(?!.*region.*us-)"
      - "createStorage(?!.*location.*domestic)"
    message: "Cloud storage may allow foreign region replication."
    fix_action: "Restrict to US regions for controlled data"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.yaml"
