# MCP Testing Validations

validations:
  - id: mcp-no-test-files
    name: No Test Files Found
    severity: warning
    type: regex
    pattern: 'setRequestHandler'
    negative_pattern: '\.test\.|\.spec\.|__tests__|/tests/'
    message: "MCP server without test files. Tests are critical for MCP reliability."
    fix_action: "Create test files: *.test.ts or *.spec.ts"
    applies_to:
      - "*.ts"
      - "*.js"

  - id: mcp-no-error-case-tests
    name: Missing Error Case Tests
    severity: warning
    type: regex
    pattern: 'describe.*|it\s*\('
    negative_pattern: 'error|Error|invalid|Invalid|reject|fail'
    message: "Tests may lack error case coverage. Test invalid inputs and error paths."
    fix_action: "Add tests for invalid inputs, missing fields, and error conditions"
    applies_to:
      - "*.test.ts"
      - "*.spec.ts"

  - id: mcp-only-mocks
    name: Tests With Only Mocks
    severity: info
    type: regex
    pattern: 'mock|Mock|jest\.fn|vi\.fn'
    negative_pattern: 'integration|Integration|e2e|E2E|real|Real'
    message: "Tests use mocks heavily. Consider adding integration tests."
    fix_action: "Add integration tests that test real server behavior"
    applies_to:
      - "*.test.ts"
      - "*.spec.ts"

  - id: mcp-no-schema-tests
    name: Missing Schema Tests
    severity: warning
    type: regex
    pattern: 'inputSchema'
    negative_pattern: 'validateSchema|schemaTest|schema.*test'
    message: "Tool schemas defined but not tested. Invalid schemas cause runtime errors."
    fix_action: "Add tests validating all tool schemas"
    applies_to:
      - "*.ts"
      - "*.js"
