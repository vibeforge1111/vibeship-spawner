# Claude Code Commands Validations

validations:
  - id: missing-usage-comment
    name: Command Without Usage Documentation
    severity: medium
    type: regex
    pattern: '^\s*#.*\$ARGUMENTS'
    negative_pattern: '#\s*Usage:|#\s*Example:'
    message: "Command uses $ARGUMENTS but lacks usage documentation."
    fix_action: "Add usage comment: # Usage: /command-name argument-description"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: wrong-arguments-syntax
    name: Incorrect Arguments Variable
    severity: high
    type: regex
    pattern: '\$[Aa]rgument[^sS]|\$ARGUMENT\s|\$\{ARGUMENTS\}|\$[Aa]rguments'
    message: "Wrong $ARGUMENTS syntax. Must be exactly $ARGUMENTS (all caps, with S)."
    fix_action: "Use $ARGUMENTS exactly as written"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: relative-file-reference
    name: Relative Path in File Reference
    severity: medium
    type: regex
    pattern: '@\\.\\.?/'
    message: "@file paths should be relative to project root, not the command file."
    fix_action: "Use @src/file.md not @../src/file.md"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: builtin-command-override
    name: Override of Built-in Command
    severity: high
    type: filename
    pattern: '(help|clear|config|memory|compact|model|bug|hooks|mcp|permissions|init)\\.md$'
    message: "Command file may override built-in Claude Code command."
    fix_action: "Rename to avoid conflict with built-in commands"
    applies_to:
      - ".claude/commands/"
      - "**/commands/"

  - id: no-output-format
    name: Command Without Output Format
    severity: low
    type: regex
    pattern: '##.*Workflow|##.*Process|##.*Steps'
    negative_pattern: '##.*Output|##.*Format|##.*Response'
    message: "Command has workflow steps but no specified output format."
    fix_action: "Add ## Output Format section specifying expected response structure"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: executable-code-without-context
    name: Code Block Without Execution Guidance
    severity: low
    type: regex
    pattern: '```bash\n[^`]+```'
    negative_pattern: 'Run this|Execute|Don.*t run|Example'
    message: "Code block without clear guidance on whether to execute it."
    fix_action: "Add 'Run this command:' or 'Example (don't execute):' before code blocks"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: very-long-command
    name: Command Exceeds Recommended Length
    severity: low
    type: line_count
    threshold: 150
    message: "Command is very long (>150 lines). Consider splitting into smaller commands."
    fix_action: "Break into modular commands or use @file references"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: missing-title
    name: Command Without Title Header
    severity: medium
    type: regex
    pattern: '^[^#]'
    message: "Command doesn't start with a title header."
    fix_action: "Start command with # Title describing the workflow"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: hardcoded-absolute-path
    name: Hardcoded Absolute Path in Command
    severity: medium
    type: regex
    pattern: '(/Users/|/home/|C:\\\\|/var/)'
    message: "Hardcoded absolute path won't work on other machines."
    fix_action: "Use relative paths or $ARGUMENTS for dynamic paths"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"

  - id: unclosed-checklist
    name: Checklist Items All Unchecked
    severity: low
    type: regex
    pattern: '- \\[ \\].*\n- \\[ \\].*\n- \\[ \\]'
    negative_pattern: '- \\[x\\]'
    message: "Multiple unchecked items. Claude will try to complete these - ensure that's intended."
    fix_action: "Verify checklist items are meant to be completed by Claude"
    applies_to:
      - ".claude/commands/*.md"
      - "**/commands/*.md"
