id: pixel-art-sprites
skill: Pixel Art & Sprites
version: "1.0"

validations:
  - id: check-pixel-art-mode
    name: Pixel Art Rendering Mode
    description: Game should use pixelated/crisp rendering
    pattern: "pixelArt|antialias|roundPixels|image-rendering"
    file_glob: "**/*.{js,ts,css}"
    match: present
    context_pattern: "true|pixelated|crisp-edges"
    message: "Enable pixel-perfect rendering (pixelArt: true, antialias: false)"
    severity: error
    autofix: false

  - id: check-integer-scaling
    name: Integer Scaling
    description: Sprites should use integer scale values
    pattern: "setScale|scale\\s*\\(|transform.*scale"
    file_glob: "**/*.{js,ts}"
    match: present
    context_pattern: "\\b[1-9]\\b|Math\\.floor|Math\\.round|\\|\\s*0"
    message: "Use integer scaling for pixel art (1x, 2x, 3x, not 1.5x)"
    severity: warning
    autofix: false

  - id: check-sprite-sheet-config
    name: Sprite Sheet Configuration
    description: Sprite sheets should specify frame dimensions
    pattern: "spritesheet|load.*sprite|atlas"
    file_glob: "**/*.{js,ts}"
    match: present
    context_pattern: "frameWidth|frameHeight|frame.*[Ww]idth"
    message: "Specify frameWidth and frameHeight for sprite sheets"
    severity: error
    autofix: false

  - id: check-animation-timing
    name: Animation Timing Values
    description: Animations should have explicit timing/duration
    pattern: "anims\\.create|createAnimation|animation"
    file_glob: "**/*.{js,ts}"
    match: present
    context_pattern: "duration|frameRate|delay"
    message: "Specify animation timing (duration or frameRate)"
    severity: warning
    autofix: false

  - id: check-png-format
    name: PNG Format for Sprites
    description: Sprite assets should be PNG format
    pattern: "load\\.image|load\\.spritesheet|load\\.atlas|src.*="
    file_glob: "**/*.{js,ts,html}"
    match: present
    context_pattern: "\\.png|\\.PNG"
    message: "Use PNG format for pixel art sprites (not JPEG)"
    severity: warning
    autofix: false

  - id: check-no-jpeg-sprites
    name: No JPEG Sprites
    description: JPEG should not be used for pixel art
    pattern: "\\.(jpg|jpeg|JPG|JPEG)"
    file_glob: "**/*.{js,ts,html}"
    match: absent
    message: "JPEG destroys pixel art - use PNG instead"
    severity: error
    autofix: false

  - id: check-consistent-frame-size
    name: Consistent Frame Sizes
    description: All frames in animation should be same size
    pattern: "frameWidth|frame_width|spriteWidth"
    file_glob: "**/*.{js,ts,json}"
    match: present
    message: "Ensure all animation frames have consistent dimensions"
    severity: info
    autofix: false

  - id: check-animation-loop-config
    name: Animation Loop Configuration
    description: Animations should specify repeat behavior
    pattern: "anims\\.create|createAnimation"
    file_glob: "**/*.{js,ts}"
    match: present
    context_pattern: "repeat|loop|yoyo"
    message: "Specify animation repeat behavior (loop, once, yoyo)"
    severity: info
    autofix: false

pre_commit:
  - id: sprite-dimensions
    name: Sprite Dimension Validation
    command: "npm run validate:sprites"
    description: Check all sprites have valid power-of-2 or standard dimensions

  - id: palette-check
    name: Color Palette Validation
    command: "npm run validate:palette"
    description: Verify sprites use consistent color palette

  - id: format-check
    name: Image Format Check
    command: "npm run validate:formats"
    description: Ensure all sprites are PNG format

ci_checks:
  - id: sprite-sheet-integrity
    name: Sprite Sheet Integrity
    command: "npm run test:sprites"
    description: Validate sprite sheets match JSON metadata
    required: true

  - id: animation-coverage
    name: Animation Coverage
    command: "npm run test:animations"
    description: Check all required animations exist for entities
    required: false

  - id: visual-regression
    name: Sprite Visual Regression
    command: "npm run test:visual"
    description: Compare sprites against approved references
    required: false
