# Shader Programming Collaboration
# How this skill works with other specialists

id: shader-programming-collaboration
skill: shader-programming
version: 1.0.0

# ============================================================================
# RECEIVES FROM (Who delegates TO this skill)
# ============================================================================
receives_from:
  - skill: unity-development
    context: "Unity project needs custom shaders or visual effects"
    receives:
      - "Render pipeline context (URP, HDRP, Built-in)"
      - "Target platforms (mobile, console, PC)"
      - "Performance budget and quality targets"
      - "Existing material/shader setup"
      - "Art style reference"
    provides: "ShaderLab/HLSL shaders optimized for Unity pipeline"

  - skill: unreal-engine
    context: "Unreal project needs material functions or custom shaders"
    receives:
      - "Target rendering features"
      - "Platform requirements"
      - "Material instance parameters needed"
      - "LOD/quality tier requirements"
    provides: "HLSL custom nodes, material functions, or USF shaders"

  - skill: threejs-3d-graphics
    context: "Three.js project needs custom materials or post-processing"
    receives:
      - "WebGL version requirements (1/2)"
      - "Performance constraints"
      - "Integration with existing materials"
      - "Browser compatibility needs"
    provides: "GLSL shaders for ShaderMaterial or post-processing"

  - skill: game-development
    context: "Game needs specific visual effects"
    receives:
      - "Effect description and reference"
      - "Game engine/framework"
      - "Performance requirements"
      - "Art direction guidelines"
    provides: "Implementation of visual effects"

  - skill: performance-hunter
    context: "Shader identified as performance bottleneck"
    receives:
      - "Profiling data (GPU time, memory)"
      - "Problem shaders identified"
      - "Target performance metrics"
    provides: "Optimized shader implementations"

  - skill: ui-design
    context: "UI needs custom shader effects"
    receives:
      - "Visual effect requirements"
      - "Animation specifications"
      - "Platform targets"
    provides: "UI shader effects (blur, glow, transitions)"

# ============================================================================
# DELEGATION TRIGGERS
# ============================================================================
delegation_triggers:
  - trigger: "Unity|URP|HDRP|Built-in|ShaderGraph"
    delegate_to: unity-development
    pattern: sequential
    context: "Shader needs Unity-specific implementation guidance"
    handoff_data:
      - "Shader code or concept"
      - "Target render pipeline"
      - "Integration requirements"
    receive: "Unity project integration"

  - trigger: "Unreal|UE5|UE4|Material Editor|Niagara"
    delegate_to: unreal-engine
    pattern: sequential
    context: "Shader needs Unreal implementation"
    handoff_data:
      - "Shader algorithm"
      - "Parameter requirements"
      - "Performance targets"
    receive: "Unreal material implementation"

  - trigger: "Three.js|WebGL|JavaScript|browser"
    delegate_to: threejs-3d-graphics
    pattern: sequential
    context: "Shader needs Three.js integration"
    handoff_data:
      - "GLSL shader code"
      - "Uniform requirements"
      - "Blending/depth settings"
    receive: "Three.js material setup"

  - trigger: "profile|benchmark|frame time|GPU bound|slow"
    delegate_to: performance-hunter
    pattern: parallel
    context: "Need performance analysis of shader"
    handoff_data:
      - "Shader code"
      - "Current performance metrics"
      - "Target platforms"
    receive: "Profiling insights and bottleneck identification"

  - trigger: "game design|gameplay|mechanic|player feedback"
    delegate_to: game-development
    pattern: sequential
    context: "Visual effect needs game design context"
    handoff_data:
      - "Effect capabilities"
      - "Performance cost"
      - "Technical constraints"
    receive: "Gameplay requirements for effect"

  - trigger: "art direction|color palette|style guide|visual design"
    delegate_to: ui-design
    pattern: sequential
    context: "Shader needs visual design direction"
    handoff_data:
      - "Technical capabilities"
      - "Parameter ranges"
      - "Platform constraints"
    receive: "Visual design specifications"

  - trigger: "compute|GPGPU|parallel processing|simulation"
    delegate_to: codebase-optimization
    pattern: parallel
    context: "Compute shader optimization needed"
    handoff_data:
      - "Algorithm description"
      - "Data layout"
      - "Performance requirements"
    receive: "Algorithm optimization strategies"

# ============================================================================
# FEEDBACK LOOPS
# ============================================================================
feedback_loops:
  receives_feedback_from:
    - skill: performance-hunter
      signal: "Shader is the bottleneck"
      action: "Apply GPU-specific optimizations, reduce complexity"

    - skill: unity-development
      signal: "Shader breaks in specific render pipeline"
      action: "Adjust for pipeline-specific requirements"

    - skill: unreal-engine
      signal: "Material compile errors or warnings"
      action: "Fix HLSL compatibility issues"

    - skill: threejs-3d-graphics
      signal: "WebGL errors or compatibility issues"
      action: "Adjust for WebGL limitations and browser differences"

    - skill: qa-engineering
      signal: "Visual artifacts on certain hardware"
      action: "Add precision handling, fallbacks for older GPUs"

  sends_feedback_to:
    - skill: game-development
      signal: "Effect not achievable within performance budget"
      action: "Simplify effect requirements or increase budget"

    - skill: ui-design
      signal: "Requested effect too expensive for target platform"
      action: "Provide alternative visual approaches"

    - skill: performance-hunter
      signal: "Shader optimized but still slow"
      action: "Need broader system optimization"

# ============================================================================
# CROSS-DOMAIN INSIGHTS
# ============================================================================
cross_domain_insights:
  - domain: Demoscene
    insight: |
      Demoscene coders know extreme optimization:
      - Every byte and cycle counts
      - Procedural over stored data
      - Math as art (fractals, SDF, noise)
      - Real-time requires real trade-offs
      Shaders are demoscene running everywhere.
    applies_when: "Optimizing shaders to their absolute limit"

  - domain: Photography
    insight: |
      Photographers know light:
      - Exposure, contrast, color grading
      - Bokeh and depth of field
      - Lens artifacts (flare, chromatic aberration)
      - Film grain and processing
      Post-processing is digital photography.
    applies_when: "Creating post-processing effects or color grading"

  - domain: Traditional Art
    insight: |
      Painters know stylization:
      - Edge handling (sharp vs lost edges)
      - Color temperature and harmony
      - Value structure before color
      - Abstraction communicates essence
      NPR shaders are paintings that move.
    applies_when: "Creating stylized or non-photorealistic rendering"

  - domain: Physics
    insight: |
      Physicists know simulation:
      - Conservation laws constrain solutions
      - Approximations must preserve behavior
      - Scale matters (micro vs macro)
      - Numerical stability is essential
      PBR is physics running in real-time.
    applies_when: "Implementing physically-based rendering or simulations"

  - domain: Signal Processing
    insight: |
      Signal engineers know frequency:
      - Aliasing from undersampling
      - Filtering trades sharpness for artifacts
      - Convolution is everywhere
      - Noise has useful properties
      Shaders are signal processors on images.
    applies_when: "Anti-aliasing, blur effects, or frequency-domain operations"

# ============================================================================
# COMMON COMBINATIONS
# ============================================================================
common_combinations:
  - name: Unity Visual Effects Pipeline
    skills:
      - shader-programming
      - unity-development
      - ui-design
      - performance-hunter
    workflow: |
      1. Visual design specs (ui-design)
      2. Shader prototype (shader-programming)
      3. Unity integration (unity-development)
      4. Performance validation (performance-hunter)
      5. Iterate until targets met

  - name: Web 3D Graphics
    skills:
      - shader-programming
      - threejs-3d-graphics
      - frontend
    workflow: |
      1. GLSL shader development (shader-programming)
      2. Three.js integration (threejs-3d-graphics)
      3. Web optimization (frontend)
      4. Cross-browser testing

  - name: Unreal Material Creation
    skills:
      - shader-programming
      - unreal-engine
      - ui-design
    workflow: |
      1. Visual design reference (ui-design)
      2. HLSL custom expressions (shader-programming)
      3. Material graph integration (unreal-engine)
      4. LOD and platform variants

  - name: Mobile Shader Optimization
    skills:
      - shader-programming
      - performance-hunter
      - unity-development
    workflow: |
      1. Profile existing shaders (performance-hunter)
      2. Identify precision and feature cuts (shader-programming)
      3. Platform-specific variants (unity-development)
      4. Validate on target devices

  - name: Procedural Effects
    skills:
      - shader-programming
      - game-development
      - codebase-optimization
    workflow: |
      1. Effect design (game-development)
      2. Noise/SDF implementation (shader-programming)
      3. Parameter tuning (shader-programming)
      4. Performance optimization (codebase-optimization)

# ============================================================================
# HANDOFF PROTOCOLS
# ============================================================================
handoff_protocols:
  to_unity:
    required_context:
      - "Target render pipeline (URP/HDRP/Built-in)"
      - "Target platforms"
      - "Shader type (surface/vertex-fragment/compute)"
    deliverables:
      - "Complete ShaderLab code"
      - "Material property definitions"
      - "Performance characteristics"

  to_unreal:
    required_context:
      - "Target Unreal version"
      - "Material domain (surface/deferred/post)"
      - "Integration method (custom node/USF)"
    deliverables:
      - "HLSL code or custom expressions"
      - "Input/output parameter specs"
      - "Performance notes"

  to_threejs:
    required_context:
      - "WebGL version requirement"
      - "ShaderMaterial vs RawShaderMaterial"
      - "Integration with postprocessing library"
    deliverables:
      - "Complete GLSL vertex/fragment shaders"
      - "Uniform definitions with types"
      - "Blending and depth configuration"

  from_performance:
    expected_data:
      - "GPU profiler output"
      - "Frame time breakdown"
      - "Memory bandwidth usage"
      - "Shader complexity metrics"
    response:
      - "Optimized shader code"
      - "Explanation of changes"
      - "Expected improvement metrics"
