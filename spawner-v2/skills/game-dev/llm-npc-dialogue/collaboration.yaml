id: llm-npc-dialogue-collaboration
skill: llm-npc-dialogue
version: 1.0.0

# ============================================================================
# RECEIVES FROM (Who delegates TO this skill)
# ============================================================================
receives_from:
  - skill: game-development
    context: "Game needs AI-powered NPC dialogue"
    receives:
      - "Game engine being used"
      - "NPC requirements (personality, role)"
      - "Performance constraints"
      - "Target platforms"
    provides: "Complete NPC dialogue system implementation"

  - skill: unity-llm-integration
    context: "Unity game needs character dialogue"
    receives:
      - "Unity project structure"
      - "Existing dialogue system"
      - "Character definitions"
    provides: "LLM dialogue patterns for Unity NPCs"

  - skill: godot-llm-integration
    context: "Godot game needs character dialogue"
    receives:
      - "GDScript/C# preference"
      - "Scene structure"
      - "Character nodes"
    provides: "LLM dialogue patterns for Godot NPCs"

  - skill: llm-architect
    context: "NPC system needs model selection"
    receives:
      - "Model recommendations"
      - "Quantization guidance"
      - "Token optimization strategies"
    provides: "NPC-specific implementation of LLM recommendations"

  - skill: product-management
    context: "Game needs engaging NPC interactions"
    receives:
      - "Player engagement requirements"
      - "Character depth needs"
      - "Budget constraints"
    provides: "NPC dialogue system design and cost analysis"

# ============================================================================
# DELEGATION TRIGGERS
# ============================================================================
delegation_triggers:
  - trigger: "unity|c#|monobehaviour"
    delegate_to: unity-llm-integration
    pattern: sequential
    context: "User needs Unity-specific implementation"
    handoff_data:
      - "NPC design patterns"
      - "Memory management approach"
      - "Prompt templates"
    receive: "Unity-specific code and integration"

  - trigger: "godot|gdscript|godot engine"
    delegate_to: godot-llm-integration
    pattern: sequential
    context: "User needs Godot-specific implementation"
    handoff_data:
      - "NPC design patterns"
      - "Signal-based dialogue flow"
      - "Character node structure"
    receive: "Godot-specific code and integration"

  - trigger: "unreal|blueprint|c\\+\\+"
    delegate_to: unreal-llm-integration
    pattern: sequential
    context: "User needs Unreal-specific implementation"
    handoff_data:
      - "NPC design patterns"
      - "Async blueprint nodes"
      - "Character subsystem design"
    receive: "Unreal-specific code and integration"

  - trigger: "model selection|quantization|which model|gguf"
    delegate_to: llm-architect
    pattern: sequential
    context: "User needs help choosing LLM"
    handoff_data:
      - "Performance requirements"
      - "Memory constraints"
      - "Quality expectations"
    receive: "Model recommendations with reasoning"

  - trigger: "behavior tree|ai behavior|decision making"
    delegate_to: game-ai-behavior-trees
    pattern: parallel
    context: "NPC needs behavior beyond dialogue"
    handoff_data:
      - "Character role"
      - "Actions available"
      - "Dialogue integration points"
    receive: "Behavior tree with dialogue hooks"

  - trigger: "voice|text to speech|tts|speech synthesis"
    delegate_to: ai-audio-production
    pattern: parallel
    context: "NPC dialogue needs voice"
    handoff_data:
      - "Character voice requirements"
      - "Dialogue output format"
      - "Real-time vs pre-generated"
    receive: "TTS integration approach"

# ============================================================================
# FEEDBACK LOOPS
# ============================================================================
feedback_loops:
  receives_feedback_from:
    - skill: qa-engineering
      signal: "NPC breaks character during testing"
      action: "Strengthen guardrails and add failing test cases"

    - skill: codebase-optimization
      signal: "Dialogue system causing performance issues"
      action: "Optimize token usage, add caching, reduce model size"

    - skill: product-management
      signal: "Players complaining about NPC quality"
      action: "Improve prompts, add more memory, use better model"

  sends_feedback_to:
    - skill: llm-architect
      signal: "Model too slow for real-time dialogue"
      action: "Need faster/smaller model recommendations"

    - skill: game-development
      signal: "Dialogue integration requirements"
      action: "Document NPC system API and events"

    - skill: devops
      signal: "API cost concerns"
      action: "Need infrastructure for local LLM deployment"

# ============================================================================
# CROSS-DOMAIN INSIGHTS
# ============================================================================
cross_domain_insights:
  - domain: Theater/Acting
    insight: |
      Actors know character consistency:
      - Characters have backstories that inform reactions
      - Emotional memory carries between scenes
      - Breaking character ruins the performance
      - Great characters have flaws and contradictions
      NPCs are digital actors—write them that way.
    applies_when: "Designing NPC personalities and responses"

  - domain: Screenwriting
    insight: |
      Screenwriters know dialogue:
      - Subtext matters more than text
      - Characters have distinct voices
      - Dialogue reveals character, doesn't just convey info
      - Less is more—brevity creates impact
      NPC dialogue should feel written, not generated.
    applies_when: "Crafting NPC response style and personality"

  - domain: Cognitive Psychology
    insight: |
      Psychologists know memory:
      - Working memory is limited (7±2 items)
      - Important facts get consolidated to long-term
      - Recency and primacy effects shape recall
      - Emotional memories persist longer
      NPC memory should mirror human memory patterns.
    applies_when: "Implementing NPC memory systems"

  - domain: Improv Comedy
    insight: |
      Improvisers know "Yes, and...":
      - Never deny the reality established
      - Build on what the player says
      - Stay in the scene even when surprised
      - Commit fully to the character
      NPCs should follow improv rules for natural dialogue.
    applies_when: "Handling unexpected player inputs"

# ============================================================================
# COMMON COMBINATIONS
# ============================================================================
common_combinations:
  - name: Unity AI NPC Game
    skills:
      - llm-npc-dialogue
      - unity-llm-integration
      - game-development
      - game-ai-behavior-trees
    workflow: |
      1. Design NPC personalities and knowledge (llm-npc-dialogue)
      2. Implement Unity dialogue system (unity-llm-integration)
      3. Integrate with game events (game-development)
      4. Add non-dialogue behaviors (game-ai-behavior-trees)
      5. Test and refine responses (llm-npc-dialogue)

  - name: Godot AI Character Game
    skills:
      - llm-npc-dialogue
      - godot-llm-integration
      - game-development
    workflow: |
      1. Define character system prompts (llm-npc-dialogue)
      2. Implement NobodyWho/local LLM integration (godot-llm-integration)
      3. Create dialogue UI and triggers (game-development)
      4. Add memory and context management (llm-npc-dialogue)

  - name: Voice-Enabled NPCs
    skills:
      - llm-npc-dialogue
      - ai-audio-production
      - game-development
    workflow: |
      1. Design dialogue system (llm-npc-dialogue)
      2. Integrate TTS for voice output (ai-audio-production)
      3. Handle voice timing and lip sync (game-development)
      4. Optimize for latency (llm-npc-dialogue)

  - name: Multi-Agent NPC World
    skills:
      - llm-npc-dialogue
      - autonomous-agents
      - game-development
    workflow: |
      1. Define NPC personalities (llm-npc-dialogue)
      2. Create NPC-to-NPC communication (autonomous-agents)
      3. Build world simulation (game-development)
      4. Handle player interruption (llm-npc-dialogue)
