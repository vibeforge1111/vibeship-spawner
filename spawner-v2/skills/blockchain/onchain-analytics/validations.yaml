# Validations - Onchain Analytics
version: 1.0.0
skill_id: onchain-analytics

validations:
  - id: hardcoded-decimals
    name: Hardcoded token decimals
    severity: warning
    type: regex
    pattern:
      - 'POWER\(10,\s*18\)|1e18|10\^18'
    message: "Token decimals vary - query from tokens.erc20"
    fix_action: "JOIN tokens.erc20 and use decimals column"
    applies_to:
      - "*.sql"

  - id: no-blockchain-filter
    name: Missing blockchain filter in cross-chain query
    severity: warning
    type: regex
    pattern:
      - 'FROM\s+\w+\s+WHERE(?!.*blockchain)'
    message: "Specify blockchain for cross-chain tables"
    fix_action: "Add WHERE blockchain = 'ethereum' or similar"
    applies_to:
      - "*.sql"

best_practices:
  query_optimization:
    recommendation: |
      Dune Query Best Practices:
      [ ] Filter by block_time first (partitioned)
      [ ] Use specific columns, not SELECT *
      [ ] Limit results during development
      [ ] Join on blockchain + contract_address
      [ ] Handle NULL decimals gracefully
