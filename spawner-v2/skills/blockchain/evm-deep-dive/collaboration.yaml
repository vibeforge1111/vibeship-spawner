id: evm-deep-dive
skill: EVM Deep Dive
version: "1.0"

receives_from:
  - skill: blockchain-defi
    receives:
      - DeFi protocol requirements
      - Gas budget constraints
      - Transaction frequency estimates
    provides:
      - Gas-optimized implementations
      - Storage layout recommendations
      - Batch operation patterns

  - skill: token-launch
    receives:
      - Token functionality requirements
      - Expected transaction volume
      - Upgrade requirements
    provides:
      - Optimized token contracts
      - Proxy pattern recommendations
      - Gas cost analysis

  - skill: layer2-scaling
    receives:
      - L2-specific constraints
      - Calldata optimization needs
      - Bridge integration requirements
    provides:
      - L2-optimized contracts
      - Calldata packing strategies
      - Cross-layer patterns

  - skill: web3-security-audit
    receives:
      - Security review feedback
      - Vulnerability reports
      - Best practice recommendations
    provides:
      - Secure optimizations
      - Attack surface analysis
      - Gas/security trade-offs

delegation_triggers:
  - pattern: "security.*audit|vulnerability|exploit"
    delegate_to: web3-security-audit
    context: "Optimized code needs security review"

  - pattern: "solana|anchor|spl"
    delegate_to: solana-development
    context: "Non-EVM chain development"

  - pattern: "layer.?2|rollup|optimism|arbitrum"
    delegate_to: layer2-scaling
    context: "L2-specific optimizations needed"

  - pattern: "nft|erc721|erc1155|collection"
    delegate_to: nft-systems
    context: "NFT-specific optimization patterns"

common_combinations:
  - name: DeFi Gas Optimization
    skills:
      - evm-deep-dive
      - blockchain-defi
      - web3-security-audit
    workflow: |
      1. Design DeFi protocol (blockchain-defi)
      2. Optimize gas usage (evm-deep-dive)
      3. Security audit (web3-security-audit)

  - name: Token Launch Optimization
    skills:
      - evm-deep-dive
      - token-launch
      - tokenomics-design
    workflow: |
      1. Design tokenomics (tokenomics-design)
      2. Implement contracts (token-launch)
      3. Gas optimization pass (evm-deep-dive)

  - name: L2 dApp Development
    skills:
      - evm-deep-dive
      - layer2-scaling
      - frontend
    workflow: |
      1. Design for L2 constraints (layer2-scaling)
      2. Optimize contracts (evm-deep-dive)
      3. Build frontend (frontend)

cross_domain_insights:
  - domain: Compiler Design
    insight: Understanding Solidity compiler output enables better optimization
    application: Analyze bytecode to find optimization opportunities

  - domain: Database Systems
    insight: Storage access patterns mirror database indexing strategies
    application: Design storage layouts like database schemas

  - domain: Embedded Systems
    insight: Resource constraints similar to microcontroller programming
    application: Apply embedded best practices for memory/storage efficiency

  - domain: Game Development
    insight: Frame budget thinking applies to gas budget
    application: Profile and optimize hot paths like game loops

  - domain: Financial Engineering
    insight: Precision requirements for financial calculations
    application: Fixed-point math patterns for DeFi

ecosystem_alternatives:
  development:
    - name: Foundry
      when: Maximum performance, Solidity testing
      tradeoff: Steeper learning curve
    - name: Hardhat
      when: JavaScript ecosystem, plugins
      tradeoff: Slower compilation
    - name: Brownie
      when: Python developers
      tradeoff: Less maintained

  analysis:
    - name: Slither
      when: Static analysis, vulnerability detection
      tradeoff: False positives
    - name: Mythril
      when: Symbolic execution
      tradeoff: Slow, resource intensive
    - name: Echidna
      when: Fuzzing, invariant testing
      tradeoff: Configuration complexity

  debugging:
    - name: Tenderly
      when: Transaction debugging, simulation
      tradeoff: Requires account
    - name: Foundry debugger
      when: Local debugging
      tradeoff: CLI only
    - name: Remix debugger
      when: Quick debugging
      tradeoff: Limited features

feedback_loops:
  - from: web3-security-audit
    incorporates:
      - Security findings
      - Optimization risks
      - Best practice updates
    into: Safer optimization patterns

  - from: blockchain-defi
    incorporates:
      - Real-world gas usage data
      - User transaction patterns
      - Protocol requirements
    into: Targeted optimizations

  - from: layer2-scaling
    incorporates:
      - L2-specific costs
      - Calldata pricing changes
      - Sequencer requirements
    into: L2-aware optimization strategies

prerequisites:
  required_skills:
    - Solidity intermediate level
    - Basic EVM understanding
    - Smart contract development experience

  recommended_tools:
    - Foundry (forge, cast, anvil)
    - VS Code with Solidity extension
    - evm.codes reference
    - Tenderly account

  environment_setup: |
    # Install Foundry
    curl -L https://foundry.paradigm.xyz | bash
    foundryup

    # Create optimized project
    forge init my_project
    cd my_project

    # Configure optimizer in foundry.toml
    [profile.default]
    optimizer = true
    optimizer_runs = 200

    # For production (more runs = cheaper execution, larger bytecode)
    [profile.production]
    optimizer = true
    optimizer_runs = 10000
