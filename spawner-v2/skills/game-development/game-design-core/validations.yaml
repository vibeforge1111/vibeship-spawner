# Game Design Core Validations
# Checks for design documents and game design specifications

validations:
  # ============================================================================
  # GAME DESIGN DOCUMENT (GDD) CHECKS
  # ============================================================================

  - id: gdd-missing-core-loop
    name: GDD Missing Core Loop Definition
    severity: critical
    type: regex
    pattern:
      - '(?i)^(?!.*core\s*loop).*game\s*design\s*document'
      - '(?i)^(?!.*gameplay\s*loop).*design\s*spec'
    message: "Game design document without core loop definition. The core loop must be defined before any other systems."
    fix_action: |
      Add a Core Loop section that answers:
      - What does the player do second-to-second?
      - What does the player do minute-to-minute?
      - What keeps players coming back hour after hour?
    applies_to:
      - "**/gdd*.md"
      - "**/design*.md"
      - "**/game-design*.md"

  - id: gdd-missing-target-audience
    name: GDD Missing Target Audience
    severity: error
    type: regex
    pattern:
      - '(?i)^(?!.*target\s*audience|player\s*persona).*game\s*design'
    message: "No target audience defined. You must know who you're designing for."
    fix_action: |
      Add a Target Audience section including:
      - Player persona with name and description
      - Gaming habits and preferences
      - Skill level expectations
      - Time investment expectations
    applies_to:
      - "**/gdd*.md"
      - "**/design*.md"

  - id: gdd-missing-risk-assessment
    name: GDD Missing Design Risks
    severity: warning
    type: regex
    pattern:
      - '(?i)^(?!.*risk|concern|assumption).*game\s*design\s*document'
    message: "No design risks or assumptions documented. Every design has unknowns that should be tested."
    fix_action: |
      Add a Design Risks section:
      - What assumptions are we making?
      - What needs to be validated through playtesting?
      - What could go wrong with this design?
    applies_to:
      - "**/gdd*.md"
      - "**/design*.md"

  - id: gdd-missing-success-metrics
    name: GDD Missing Success Criteria
    severity: warning
    type: regex
    pattern:
      - '(?i)^(?!.*success\s*metric|success\s*criteria|KPI).*game\s*design'
    message: "No success metrics defined. How will you know if the design works?"
    fix_action: |
      Add measurable success criteria:
      - Session length targets
      - Retention metrics
      - Player behavior goals
      - Playtesting benchmarks
    applies_to:
      - "**/gdd*.md"
      - "**/design*.md"

  # ============================================================================
  # MECHANIC DESIGN CHECKS
  # ============================================================================

  - id: mechanic-no-tradeoff
    name: Mechanic Without Trade-off
    severity: warning
    type: regex
    pattern:
      - '(?i)better\s+(in\s+)?every\s+way'
      - '(?i)strictly\s+better'
      - '(?i)no\s+downside'
      - '(?i)always\s+(the\s+)?best'
    message: "Design describes an option with no downsides. Meaningful choices require trade-offs."
    fix_action: |
      Add trade-offs:
      - What does the player give up by choosing this?
      - In what situations is this NOT the best choice?
      - How does this interact with other choices?
    applies_to:
      - "**/design*.md"
      - "**/gdd*.md"
      - "**/mechanic*.md"

  - id: mechanic-one-right-answer
    name: Mechanic With Obvious Solution
    severity: warning
    type: regex
    pattern:
      - '(?i)optimal\s+(strategy|choice|path)'
      - '(?i)the\s+best\s+(way|option|choice)\s+is'
      - '(?i)always\s+choose'
      - '(?i)never\s+choose'
    message: "Design suggests a dominant strategy. If there's always a right answer, there's no real choice."
    fix_action: |
      Create situational value:
      - When would the opposite choice be correct?
      - What information changes the best choice?
      - How do different playstyles affect the choice?
    applies_to:
      - "**/design*.md"
      - "**/balance*.md"

  # ============================================================================
  # PROGRESSION DESIGN CHECKS
  # ============================================================================

  - id: progression-before-core
    name: Progression Designed Before Core Loop
    severity: error
    type: regex
    pattern:
      - '(?i)progression\s+system(?!.*after\s+core|once\s+core|core.*validated)'
      - '(?i)unlock\s+(system|tree)(?!.*core\s+loop\s+validated)'
    message: "Progression system designed without core loop validation. Progression can't make a boring game fun."
    fix_action: |
      Before designing progression:
      1. Document the core loop
      2. Prototype the core loop
      3. Validate through playtesting
      4. THEN design progression
    applies_to:
      - "**/design*.md"
      - "**/progression*.md"

  - id: progression-no-cap
    name: Infinite Progression Without Cap
    severity: warning
    type: regex
    pattern:
      - '(?i)infinite\s+(scaling|progression|levels)'
      - '(?i)no\s+(level\s+)?cap'
      - '(?i)unlimited\s+(upgrades|power)'
    message: "Infinite progression can break game balance. Consider caps and diminishing returns."
    fix_action: |
      Add progression boundaries:
      - Soft caps with diminishing returns
      - Hard caps for balance
      - Horizontal progression alternatives
      - Prestige/reset systems
    applies_to:
      - "**/design*.md"
      - "**/progression*.md"

  # ============================================================================
  # DIFFICULTY DESIGN CHECKS
  # ============================================================================

  - id: difficulty-no-floor
    name: Difficulty Without Skill Floor Consideration
    severity: warning
    type: regex
    pattern:
      - '(?i)difficult|challenging|hard(?!.*new\s+player|beginner|accessible)'
    message: "Difficulty discussed without new player consideration. Design for skill floor AND ceiling."
    fix_action: |
      Address accessibility:
      - How do new players learn?
      - What's the minimum skill required?
      - Are there assist options?
      - Is failure instructive?
    applies_to:
      - "**/design*.md"
      - "**/difficulty*.md"

  - id: difficulty-punishment-focus
    name: Punitive Death Design
    severity: warning
    type: regex
    pattern:
      - '(?i)lose\s+all\s+(progress|items|gold)'
      - '(?i)harsh\s+(penalty|punishment)'
      - '(?i)permanent\s+(death|loss)'
      - '(?i)you\s+die.*start\s+over'
    message: "Punitive death system detected. Ensure failure teaches, not just punishes."
    fix_action: |
      Balance punishment with learning:
      - Is the cause of death clear?
      - Is restart time fast (<30 seconds)?
      - Does the player know how to improve?
      - Consider roguelike meta-progression
    applies_to:
      - "**/design*.md"
      - "**/death*.md"
      - "**/failure*.md"

  # ============================================================================
  # ECONOMY DESIGN CHECKS
  # ============================================================================

  - id: economy-single-currency
    name: Single Currency Economy
    severity: info
    type: regex
    pattern:
      - '(?i)(?:only|single|one)\s+(currency|resource)'
    message: "Single currency economy may lack depth. Consider if multiple currencies would add meaningful choices."
    fix_action: |
      Evaluate currency complexity:
      - Does adding currency add decisions?
      - Would it just add math?
      - Consider soft vs. hard currency
      - Free-to-play implications
    applies_to:
      - "**/economy*.md"
      - "**/monetization*.md"

  - id: economy-inflation-risk
    name: Economy Without Sink
    severity: warning
    type: regex
    pattern:
      - '(?i)earn\s+(currency|gold|coins)(?!.*spend|sink|remove)'
    message: "Currency earning without spending mechanisms leads to inflation."
    fix_action: |
      Add currency sinks:
      - Consumables
      - Maintenance costs
      - Upgrade costs that scale
      - Cosmetic purchases
    applies_to:
      - "**/economy*.md"
      - "**/design*.md"

  # ============================================================================
  # RETENTION DESIGN CHECKS
  # ============================================================================

  - id: retention-fomo-mechanics
    name: FOMO-Based Retention
    severity: warning
    type: regex
    pattern:
      - '(?i)limited\s+time\s+(only|event|offer)'
      - '(?i)miss\s+(out|this|your\s+chance)'
      - '(?i)disappear(s|ing)?'
      - '(?i)streak\s+(bonus|reward|system)'
      - '(?i)daily\s+(login|reward).*lose'
    message: "FOMO-based retention detected. Consider if this respects player time."
    fix_action: |
      Evaluate retention ethics:
      - Is this creating desire or obligation?
      - Would players feel relieved to miss it?
      - Consider catch-up mechanics
      - Respect player autonomy
    applies_to:
      - "**/retention*.md"
      - "**/monetization*.md"
      - "**/live-ops*.md"

  # ============================================================================
  # PLAYTEST DOCUMENTATION CHECKS
  # ============================================================================

  - id: playtest-no-questions
    name: Playtest Without Research Questions
    severity: warning
    type: regex
    pattern:
      - '(?i)playtest\s+(session|plan)(?!.*question|hypothesis|goal)'
    message: "Playtest planned without specific questions. Know what you're testing."
    fix_action: |
      Define playtest goals:
      - What specific question are we answering?
      - What behavior would confirm/deny our hypothesis?
      - What metrics will we track?
    applies_to:
      - "**/playtest*.md"
      - "**/testing*.md"

  - id: playtest-no-metrics
    name: Playtest Without Metrics
    severity: warning
    type: regex
    pattern:
      - '(?i)playtest(?!.*track|measure|metric|observe)'
    message: "Playtest without defined metrics. Measure behavior, not just feedback."
    fix_action: |
      Add measurable observations:
      - Time to complete sections
      - Number of deaths/failures
      - Time spent in menus vs. gameplay
      - Quit points and retry rates
    applies_to:
      - "**/playtest*.md"

  # ============================================================================
  # ONBOARDING DESIGN CHECKS
  # ============================================================================

  - id: tutorial-text-heavy
    name: Text-Heavy Tutorial
    severity: warning
    type: regex
    pattern:
      - '(?i)tutorial\s+(text|message|popup|dialog)'
      - '(?i)explain\s+(in\s+)?text'
      - '(?i)tell\s+(the\s+)?player'
    message: "Text-based tutorial approach. Players skip text. Design for learning through play."
    fix_action: |
      Replace text with design:
      - Gating that requires mechanic use
      - Safe spaces to experiment
      - Environmental guidance
      - Show, don't tell
    applies_to:
      - "**/tutorial*.md"
      - "**/onboarding*.md"

  - id: tutorial-front-loaded
    name: Front-Loaded Tutorial
    severity: warning
    type: regex
    pattern:
      - '(?i)(all|every)\s+mechanic.*tutorial'
      - '(?i)tutorial\s+(covers|explains|teaches)\s+(all|everything)'
      - '(?i)before\s+play(ing)?.*learn'
    message: "Tutorial teaches everything upfront. Players forget what they don't use immediately."
    fix_action: |
      Implement just-in-time teaching:
      - Teach when the mechanic becomes relevant
      - Space learning over time
      - Let players discover advanced techniques
    applies_to:
      - "**/tutorial*.md"
      - "**/onboarding*.md"

  # ============================================================================
  # BALANCE DESIGN CHECKS
  # ============================================================================

  - id: balance-perfect-target
    name: Perfect Balance as Goal
    severity: info
    type: regex
    pattern:
      - '(?i)perfectly\s+balanced'
      - '(?i)all\s+options\s+equal'
      - '(?i)no\s+tier\s+list'
    message: "Perfect balance may reduce interesting decisions. Consider strategic imbalance."
    fix_action: |
      Evaluate balance philosophy:
      - Does imbalance create discovery?
      - Are there situational advantages?
      - Can meta evolve over time?
    applies_to:
      - "**/balance*.md"
      - "**/design*.md"

  - id: balance-numbers-only
    name: Balance Through Numbers Only
    severity: warning
    type: regex
    pattern:
      - '(?i)increase\s+damage'
      - '(?i)reduce\s+(health|speed)'
      - '(?i)buff.*nerf'
    message: "Balance changes focused on numbers. Consider if the design needs reworking instead."
    fix_action: |
      Consider design changes:
      - Is the mechanic working as intended?
      - Would a redesign work better than number changes?
      - Are we treating symptoms or causes?
    applies_to:
      - "**/balance*.md"
      - "**/patch*.md"
