# Animation Systems Collaboration
# How this skill works with other skills

skill_id: animation-systems
version: "1.0.0"

# Skills that commonly hand off TO this skill
receives_context_from:
  - skill: unity-development
    description: "Unity projects needing animation implementation"
    receives:
      - "Character requirements (humanoid, generic, sprite)"
      - "Movement system type (physics, CharacterController)"
      - "Target platform constraints"
      - "Existing animator controllers"
    expects_format: |
      When receiving from unity-development:
      - Check if using Humanoid or Generic rig
      - Understand physics setup (Rigidbody vs CharacterController)
      - Review existing Animator Controllers
      - Note any timeline/cinemachine integration needs
    response_protocol: |
      1. Assess animation requirements
      2. Design state machine architecture
      3. Specify blend tree structure
      4. Define IK requirements
      5. Document animation events needed

  - skill: unreal-engine
    description: "Unreal projects needing animation blueprints"
    receives:
      - "Character class type"
      - "Movement component configuration"
      - "Network replication requirements"
      - "Existing Animation Blueprints"
    expects_format: |
      When receiving from unreal-engine:
      - Understand Character vs Pawn setup
      - Review Movement Component config
      - Check for Control Rig usage
      - Note multiplayer requirements
    response_protocol: |
      1. Design Anim Blueprint structure
      2. Plan Linked Anim Graph architecture
      3. Specify Blend Space configuration
      4. Define Anim Notify requirements
      5. Document Montage structure

  - skill: game-ai-behavior
    description: "AI system needing animation integration"
    receives:
      - "AI action types that need animation"
      - "Timing requirements for AI decisions"
      - "State machine from behavior tree"
      - "Animation query interface needs"
    expects_format: |
      When receiving from game-ai-behavior:
      - List of AI actions requiring animation
      - Timing constraints (AI waits for animation?)
      - Animation query requirements (can attack? is moving?)
    response_protocol: |
      1. Map AI actions to animation states
      2. Define animation events for AI callbacks
      3. Create animation query interface
      4. Document state machine hooks for AI

  - skill: character-controller
    description: "Movement system needing animation integration"
    receives:
      - "Movement states (walk, run, jump, etc.)"
      - "Velocity and direction data format"
      - "Root motion expectations"
      - "State change events"
    expects_format: |
      When receiving from character-controller:
      - Movement state list with transitions
      - How movement data is exposed (velocity vector, normalized?)
      - Root motion vs code-driven decision
    response_protocol: |
      1. Create animation states matching movement states
      2. Set up parameter bindings
      3. Configure root motion handling
      4. Synchronize state transitions

  - skill: game-physics
    description: "Physics system needing procedural animation"
    receives:
      - "Ragdoll setup requirements"
      - "Secondary motion needs (cloth, hair)"
      - "Physics-driven animation requirements"
      - "Collision response animation"
    expects_format: |
      When receiving from game-physics:
      - Ragdoll bone configuration
      - Physics material constraints
      - Blend between animation and physics needs
    response_protocol: |
      1. Set up ragdoll-to-animation blending
      2. Configure secondary motion bones
      3. Define physics impact reactions
      4. Create procedural animation layers

# Skills this skill hands off TO
provides_context_to:
  - skill: unity-development
    description: "Unity-specific implementation of animation design"
    provides:
      - "Animator Controller structure"
      - "State machine design document"
      - "Blend tree configurations"
      - "IK setup requirements"
      - "Animation event specifications"
    handoff_trigger: "implement in Unity|Unity animator setup"
    context_format: |
      ## Animation Implementation for Unity

      ### Animator Controller Structure
      [Layer definitions, state machine hierarchy]

      ### State Machine
      [States, transitions, conditions]

      ### Blend Trees
      [1D/2D blend configurations, thresholds]

      ### IK Requirements
      [Foot IK, Hand IK, Look At settings]

      ### Animation Events
      [Event names, timing, parameters]

  - skill: unreal-engine
    description: "Unreal-specific implementation of animation design"
    provides:
      - "Anim Blueprint architecture"
      - "State machine design"
      - "Blend space configurations"
      - "Control Rig requirements"
      - "Anim Notify specifications"
    handoff_trigger: "implement in Unreal|UE animation|Animation Blueprint"
    context_format: |
      ## Animation Implementation for Unreal

      ### Anim Blueprint Structure
      [Graph organization, linked graphs]

      ### State Machine
      [States, transitions, rules]

      ### Blend Spaces
      [1D/2D configurations, sample points]

      ### Control Rig Needs
      [IK chains, procedural adjustments]

      ### Anim Notifies
      [Notify events, notify states]

  - skill: game-ai-behavior
    description: "AI integration points for animation"
    provides:
      - "Animation state machine interface"
      - "Available animation actions"
      - "Animation timing data"
      - "Query methods for AI decisions"
    handoff_trigger: "AI needs animation data|behavior tree animation"
    context_format: |
      ## Animation Interface for AI

      ### Available Actions
      [List of triggerable animations with timing]

      ### Query Interface
      ```
      CanAttack() - bool
      IsInRecovery() - bool
      GetCurrentState() - AnimState
      GetTimeInState() - float
      ```

      ### Animation Events for AI
      [Events AI should subscribe to]

  - skill: game-performance
    description: "Animation system optimization needs"
    provides:
      - "Current animation setup details"
      - "Bone counts and complexity"
      - "IK configuration"
      - "State machine complexity"
      - "Update frequency settings"
    handoff_trigger: "animation performance|optimize animation|animation profiling"
    context_format: |
      ## Animation Performance Audit

      ### Current Setup
      - Bone count: [X]
      - Active IK chains: [X]
      - State machine states: [X]
      - Blend tree samples: [X]

      ### Known Hotspots
      [IK costs, blend complexity]

      ### Optimization Opportunities
      [LOD candidates, frequency reductions]

  - skill: game-audio
    description: "Audio sync points in animation"
    provides:
      - "Footstep event timing"
      - "Action sound cue points"
      - "Voice/dialogue sync markers"
      - "Impact and hit events"
    handoff_trigger: "animation audio sync|footstep sounds|animation sound"
    context_format: |
      ## Animation Audio Sync Points

      ### Footstep Events
      [Timing, surface type data]

      ### Action Sounds
      [Attack whooshes, impacts, etc.]

      ### Voice Markers
      [Dialogue sync points]

collaboration_rules:
  inbound:
    - rule: "Always ask about target engine before designing"
      reason: "Unity Mecanim vs Unreal Anim BP have different capabilities"

    - rule: "Clarify root motion vs code-driven movement first"
      reason: "Fundamental architecture decision affects everything"

    - rule: "Get bone count and platform constraints early"
      reason: "Mobile vs PC have very different animation budgets"

    - rule: "Understand networking requirements upfront"
      reason: "Animation in multiplayer requires special handling"

  outbound:
    - rule: "Always provide state machine diagram"
      reason: "Visual representation prevents miscommunication"

    - rule: "Include timing data with all events"
      reason: "Receiving skills need to know animation durations"

    - rule: "Specify blend weights and transition times"
      reason: "Implementation needs exact numbers, not just structure"

    - rule: "Document any root motion expectations"
      reason: "Movement integration depends on this"

integration_patterns:
  with_unity:
    setup: |
      Animation design flows into Unity implementation:
      1. Design state machine → Create Animator Controller
      2. Specify blend trees → Configure Blend Trees
      3. Define IK needs → Set up Avatar and IK layers
      4. List events → Add Animation Events
    common_issues:
      - "Humanoid retargeting scale problems"
      - "OnAnimatorMove vs applyRootMotion confusion"
      - "Layer weight blending artifacts"

  with_unreal:
    setup: |
      Animation design flows into Unreal implementation:
      1. Design state machine → Create Anim Blueprint
      2. Specify blend spaces → Configure Blend Spaces
      3. Define IK needs → Set up Control Rig or IK nodes
      4. List events → Add Anim Notifies
    common_issues:
      - "Animation Blueprint complexity"
      - "Root motion in networked games"
      - "Control Rig performance"

  with_ai:
    setup: |
      Animation provides interface for AI:
      1. Expose animation states as AI actions
      2. Provide query interface for AI decisions
      3. Fire events on animation milestones
      4. Allow AI to interrupt/cancel animations
    common_issues:
      - "AI waiting for animations vs canceling"
      - "Animation timing vs AI tick rate"
      - "State synchronization"

  with_movement:
    setup: |
      Animation integrates with movement system:
      1. Receive velocity/direction from movement
      2. Drive animation parameters
      3. Return root motion or animation speed
      4. Sync state transitions
    common_issues:
      - "Root motion authority conflicts"
      - "Foot sliding from speed mismatch"
      - "State desync between systems"

boundary_definition:
  owns:
    - "Animation state machine design"
    - "Blend tree architecture"
    - "Animation timing and events"
    - "IK system design"
    - "Root motion strategy"
    - "Animation compression decisions"
    - "Retargeting setup"

  does_not_own:
    - "3D model rigging (rigger/technical artist)"
    - "Animation asset creation (animator)"
    - "Engine-specific implementation details"
    - "Physics simulation"
    - "Network synchronization"
    - "Audio implementation"

  gray_areas:
    - area: "Procedural animation"
      guideline: "Own the design, delegate physics-heavy implementation"

    - area: "Ragdoll"
      guideline: "Own blend between ragdoll and animation, delegate ragdoll setup"

    - area: "Motion capture cleanup"
      guideline: "Advise on technical constraints, delegate artistic decisions"

escalation_triggers:
  - trigger: "Performance critical path"
    escalate_to: game-performance
    reason: "May need engine-level optimization beyond animation scope"

  - trigger: "Complex physics interaction"
    escalate_to: game-physics
    reason: "Physics-animation blend needs physics expertise"

  - trigger: "Network synchronization issues"
    escalate_to: multiplayer-netcode
    reason: "Animation sync is subset of larger networking problem"
