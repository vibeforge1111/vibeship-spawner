id: multi-tenancy-collaboration
skill: multi-tenancy
version: 1.0.0

receives_from:
  - skill: enterprise-architecture
    context: "Multi-tenant architecture patterns"
    receives:
      - "Isolation requirements"
      - "Scalability needs"
    provides: "Tenant isolation strategy"

  - skill: gdpr-privacy
    context: "Data privacy per tenant"
    receives:
      - "Data residency requirements"
      - "Deletion requirements"
    provides: "Tenant data isolation and deletion"

delegation_triggers:
  - trigger: "enterprise.architecture|system.design"
    delegate_to: enterprise-architecture
    context: "Overall architecture decisions"

  - trigger: "gdpr|privacy|data.deletion|right.to.erasure"
    delegate_to: gdpr-privacy
    context: "Privacy compliance per tenant"

  - trigger: "disaster.recovery|backup|tenant.restore"
    delegate_to: disaster-recovery
    context: "Per-tenant DR strategy"

  - trigger: "billing|subscription|stripe|payments"
    delegate_to: payments
    context: "Tenant billing integration"

feedback_loops:
  receives_feedback_from:
    - skill: enterprise-architecture
      signal: "Architecture constraints"
      action: "Adjust isolation model"

    - skill: gdpr-privacy
      signal: "Compliance requirements"
      action: "Update data handling policies"

  sends_feedback_to:
    - skill: enterprise-architecture
      signal: "Tenant scalability limits"
      action: "Inform capacity planning"

    - skill: disaster-recovery
      signal: "Per-tenant backup requirements"
      action: "Design tenant-aware DR"

common_combinations:
  - name: SaaS Platform Setup
    skills:
      - multi-tenancy
    workflow: |
      1. Choose isolation model (pooled/schema/database)
      2. Implement tenant context middleware
      3. Add tenant_id to all models
      4. Configure row-level security
      5. Set up per-tenant rate limiting
      6. Implement usage metering
      7. Create tenant lifecycle management

  - name: Tenant Onboarding Flow
    skills:
      - multi-tenancy
    workflow: |
      1. Collect tenant registration info
      2. Provision tenant resources
      3. Create tenant schema/database
      4. Run initial migrations
      5. Create admin user
      6. Configure default settings
      7. Send welcome email
      8. Track onboarding metrics

  - name: Enterprise Tenant Setup
    skills:
      - multi-tenancy
      - gdpr-privacy
    workflow: |
      1. Dedicated database provisioning
      2. Custom domain configuration
      3. SSO integration (SAML/OIDC)
      4. Data residency compliance
      5. Dedicated support channel
      6. Custom SLA configuration
      7. Audit logging setup

  - name: Usage-Based Billing
    skills:
      - multi-tenancy
    workflow: |
      1. Define billable meters
      2. Implement usage tracking
      3. Set up aggregation pipeline
      4. Configure billing periods
      5. Integrate with billing provider
      6. Create usage dashboards
      7. Set up overage alerts

ecosystem:
  identity:
    - "WorkOS"
    - "Frontegg"
    - "Auth0 Organizations"
    - "Clerk"

  databases:
    - "PostgreSQL (RLS)"
    - "Citus"
    - "CockroachDB"
    - "PlanetScale"

  metering:
    - "Orb"
    - "Metronome"
    - "Amberflo"
    - "Stripe Billing"

  infrastructure:
    - "AWS Organizations"
    - "Azure Subscriptions"
    - "GCP Projects"

references:
  guides:
    - "WorkOS Multi-Tenant Architecture Guide"
    - "Azure SaaS Design Patterns"
    - "AWS Multi-Tenancy Best Practices"

  articles:
    - "Stripe's Multi-Tenant Database Architecture"
    - "Slack's Sharding Strategy"
