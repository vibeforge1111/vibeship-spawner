validations:

  - id: missing-adr
    name: Architecture Decision Without Record
    severity: warning
    type: regex
    pattern:
      - "// TODO: document architecture decision"
      - "# DECISION: .*(?!ADR|adr)"
    message: "Architecture decision may not be documented in ADR."
    fix_action: "Create Architecture Decision Record (ADR) for significant decisions"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.py"

  - id: cross-boundary-import
    name: Cross-Context Import
    severity: warning
    type: regex
    pattern:
      - "from.*domains\\.[a-z]+.*import.*(?!interface|event)"
      - "import.*@/domains/[a-z]+/(?!shared|contracts)"
    message: "Importing implementation details across bounded context boundaries."
    fix_action: "Use events or public interfaces for cross-context communication"
    applies_to:
      - "**/*.ts"
      - "**/*.py"

  - id: shared-database-access
    name: Shared Database Table Access
    severity: warning
    type: regex
    pattern:
      - "FROM\\s+(users|customers|orders)\\s+.*JOIN.*WHERE"
    message: "Query may access tables owned by another context."
    fix_action: "Access other context data via API or events, not direct DB"
    applies_to:
      - "**/*.sql"
      - "**/*.ts"
      - "**/*.py"

  - id: hardcoded-technology
    name: Hardcoded Technology Choice
    severity: info
    type: regex
    pattern:
      - "PostgreSQL|MySQL|MongoDB"
      - "Redis|Kafka|RabbitMQ"
    message: "Technology choice may need abstraction for portability."
    fix_action: "Consider abstraction layer for technology-specific code"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: undocumented-api-contract
    name: API Without Contract Documentation
    severity: warning
    type: regex
    pattern:
      - "app\\.get\\(|app\\.post\\((?!.*openapi|.*swagger|.*schema)"
      - "router\\.get\\(|router\\.post\\((?!.*docs)"
    message: "API endpoint may lack contract documentation."
    fix_action: "Document API contract with OpenAPI/Swagger specification"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: missing-capability-mapping
    name: Feature Without Capability Mapping
    severity: info
    type: regex
    pattern:
      - "// Feature:.*(?!Capability:|CAP-)"
      - "# Feature.*(?!maps to|capability)"
    message: "Feature may not be mapped to business capability."
    fix_action: "Map features to business capabilities for traceability"
    applies_to:
      - "**/*.ts"
      - "**/*.py"
      - "**/*.md"
