validations:

  - id: pii-in-logs
    name: PII in Logging Statements
    severity: error
    type: regex
    pattern:
      - "log.*email.*="
      - "print.*ssn|phone|address"
      - "logger.*customer_name"
    message: "Personal data may be written to logs without masking."
    fix_action: "Mask or remove PII before logging"
    applies_to:
      - "**/*.py"
      - "**/*.ts"
      - "**/*.js"

  - id: no-data-classification
    name: Missing Data Classification
    severity: warning
    type: regex
    pattern:
      - "CREATE TABLE(?!.*-- classification:)"
      - "class.*Model(?!.*classification)"
    message: "Data model may lack classification metadata."
    fix_action: "Add data classification comment or attribute"
    applies_to:
      - "**/*.sql"
      - "**/*.py"

  - id: hardcoded-pii-query
    name: Hardcoded PII in Query
    severity: error
    type: regex
    pattern:
      - "WHERE email = '[^']+"
      - "AND phone = '[0-9]+"
      - "customer_name = 'John"
    message: "Hardcoded PII in query - use parameters."
    fix_action: "Use parameterized queries, not hardcoded PII"
    applies_to:
      - "**/*.sql"
      - "**/*.py"
      - "**/*.ts"

  - id: missing-quality-check
    name: Missing Data Quality Check
    severity: warning
    type: regex
    pattern:
      - "INSERT INTO(?!.*check|.*validate|.*assert)"
      - "COPY.*FROM(?!.*quality)"
    message: "Data ingestion may lack quality validation."
    fix_action: "Add data quality checks before ingestion"
    applies_to:
      - "**/*.sql"
      - "**/*.py"

  - id: no-retention-policy
    name: Missing Retention Policy
    severity: info
    type: regex
    pattern:
      - "CREATE TABLE(?!.*retention|.*ttl|.*expire)"
    message: "Table may lack retention policy definition."
    fix_action: "Define data retention policy for table"
    applies_to:
      - "**/*.sql"

  - id: sensitive-data-exposure
    name: Sensitive Data in Response
    severity: warning
    type: regex
    pattern:
      - "return.*password|secret|token"
      - "response.*ssn|credit_card"
    message: "Sensitive data may be exposed in API response."
    fix_action: "Remove or mask sensitive fields from responses"
    applies_to:
      - "**/*.py"
      - "**/*.ts"
      - "**/*.js"

  - id: missing-lineage-tracking
    name: ETL Without Lineage
    severity: info
    type: regex
    pattern:
      - "transform.*(?!lineage|track|audit)"
      - "pipeline.*(?!openlineage|marquez)"
    message: "Data transformation may not track lineage."
    fix_action: "Integrate lineage tracking (OpenLineage/Marquez)"
    applies_to:
      - "**/*.py"
      - "**/*.yaml"
