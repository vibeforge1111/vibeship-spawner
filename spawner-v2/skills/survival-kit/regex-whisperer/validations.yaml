# Regex Whisperer Validations

validations:
  - id: nested-quantifiers
    name: Potential ReDoS Pattern
    severity: high
    type: pattern
    check: "Regex should not have nested quantifiers"
    pattern: "\\([^)]*[+*][^)]*\\)[+*]"
    message: "Pattern has nested quantifiers - potential ReDoS."
    fix_action: "Flatten pattern or use negated character classes"

  - id: missing-anchors
    name: Validation Without Anchors
    severity: medium
    type: conceptual
    check: "Validation patterns should be anchored"
    indicators:
      - "Validation regex without ^ and $"
      - "Partial match allowed"
    message: "Validation pattern may not be properly anchored."
    fix_action: "Add ^ and $ anchors for full string validation"

  - id: no-tests
    name: Untested Regex
    severity: medium
    type: conceptual
    check: "Complex regex should have test cases"
    indicators:
      - "No test file"
      - "No test cases"
      - "Complex pattern without tests"
    message: "Regex has no test coverage."
    fix_action: "Add test cases for valid, invalid, and edge cases"

  - id: uncommented-complex
    name: Complex Regex Without Comments
    severity: medium
    type: conceptual
    check: "Complex patterns should be documented"
    indicators:
      - "Long pattern without comments"
      - "Multiple groups unnamed"
      - "No explanation"
    message: "Complex regex is not documented."
    fix_action: "Add comments, use named groups, or break into parts"

  - id: html-parsing
    name: HTML Parsing With Regex
    severity: high
    type: conceptual
    check: "HTML should not be parsed with regex"
    indicators:
      - "Pattern matching HTML tags"
      - "<.*>"
      - "Extracting from HTML"
    message: "Attempting to parse HTML with regex."
    fix_action: "Use proper HTML parser (DOMParser, cheerio)"

  - id: missing-unicode
    name: May Fail on Unicode
    severity: low
    type: conceptual
    check: "Patterns handling text should consider unicode"
    indicators:
      - "\\w without u flag"
      - "International text expected"
      - "User input"
    message: "Pattern may fail on unicode characters."
    fix_action: "Add 'u' flag and use \\p{L} for unicode letters"
