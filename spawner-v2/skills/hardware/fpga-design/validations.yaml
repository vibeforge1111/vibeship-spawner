validations:

  - id: missing-default-case
    name: Case Statement Without Default
    severity: warning
    type: regex
    pattern:
      - "case\\s*\\([^)]+\\)[^}]*endcase(?!.*default)"
      - "case\\s*\\([^)]+\\)(?![\\s\\S]{0,500}default)"
    message: "Case statement without default may infer latch."
    fix_action: "Add 'default:' clause with explicit assignment"
    applies_to:
      - "**/*.v"
      - "**/*.sv"

  - id: blocking-in-sequential
    name: Blocking Assignment in Sequential Logic
    severity: warning
    type: regex
    pattern:
      - "always\\s*@\\s*\\(\\s*posedge[^)]+\\)[^;]*\\b\\w+\\s*=\\s*(?!.*<=)"
    message: "Use non-blocking (<=) for sequential logic to avoid race conditions."
    fix_action: "Replace = with <= in always @(posedge clk) blocks"
    applies_to:
      - "**/*.v"
      - "**/*.sv"

  - id: direct-cdc-connection
    name: Direct Clock Domain Crossing
    severity: error
    type: regex
    pattern:
      - "always\\s*@\\s*\\(\\s*posedge\\s+clk_b[^}]*\\b(\\w+_a)\\b(?!.*sync)"
    message: "Signal appears to cross clock domains without synchronizer."
    fix_action: "Add 2-FF synchronizer or async FIFO for CDC"
    applies_to:
      - "**/*.v"
      - "**/*.sv"

  - id: initial-block
    name: Initial Block in Synthesizable Code
    severity: warning
    type: regex
    pattern:
      - "^\\s*initial\\s+begin(?![\\s\\S]*\\.tb\\.)"
    message: "Initial blocks don't synthesize. Use reset instead."
    fix_action: "Replace with synchronous reset: always @(posedge clk) if (!rst_n)"
    applies_to:
      - "**/*.v"
      - "**/*.sv"

  - id: incomplete-sensitivity
    name: Incomplete Sensitivity List
    severity: warning
    type: regex
    pattern:
      - "always\\s*@\\s*\\([^*][^)]*\\)\\s*begin[^}]*\\b(\\w+)\\b(?![^}]*@.*\\1)"
    message: "Consider using @(*) for combinational logic to auto-include all signals."
    fix_action: "Replace explicit sensitivity list with always @(*)"
    applies_to:
      - "**/*.v"

  - id: missing-async-reg
    name: Synchronizer Without ASYNC_REG Attribute
    severity: info
    type: regex
    pattern:
      - "reg\\s+\\[\\d+:0\\]\\s+\\w*sync\\w*(?!.*ASYNC_REG)"
    message: "Synchronizer registers should have ASYNC_REG attribute for proper placement."
    fix_action: "Add (* ASYNC_REG = \"TRUE\" *) before register declaration"
    applies_to:
      - "**/*.v"
      - "**/*.sv"

  - id: async-reset-no-sync
    name: Asynchronous Reset Without Synchronizer
    severity: warning
    type: regex
    pattern:
      - "negedge\\s+rst_n(?!.*sync)"
    message: "Asynchronous reset should be synchronized for clean release."
    fix_action: "Use reset synchronizer: async assert, sync release pattern"
    applies_to:
      - "**/*.v"
      - "**/*.sv"

  - id: high-fanout-signal
    name: Signal Driving Many Modules
    severity: info
    type: regex
    pattern:
      - "\\.(\\w+)\\(enable\\)[^;]*\\.(\\w+)\\(enable\\)[^;]*\\.(\\w+)\\(enable\\)"
    message: "High fanout signal may cause timing issues."
    fix_action: "Consider registering signal at each destination or using synthesis directives"
    applies_to:
      - "**/*.v"
      - "**/*.sv"

  - id: missing-clock-constraint
    name: Missing Clock Definition
    severity: warning
    type: regex
    pattern:
      - "get_ports.*clk(?!.*create_clock)"
    message: "Clock port should have create_clock constraint."
    fix_action: "Add: create_clock -period <ns> [get_ports clk]"
    applies_to:
      - "**/*.xdc"
      - "**/*.sdc"

  - id: unconstrained-io
    name: IO Without Delay Constraint
    severity: info
    type: regex
    pattern:
      - "get_ports.*data(?!.*set_input_delay|set_output_delay)"
    message: "Data ports should have input/output delay constraints."
    fix_action: "Add set_input_delay/set_output_delay for all data ports"
    applies_to:
      - "**/*.xdc"
      - "**/*.sdc"

  - id: non-blocking-combinational
    name: Non-Blocking in Combinational Logic
    severity: warning
    type: regex
    pattern:
      - "always\\s*@\\s*\\(\\s*\\*\\s*\\)[^}]*<="
    message: "Use blocking (=) for combinational logic."
    fix_action: "Replace <= with = in always @(*) blocks"
    applies_to:
      - "**/*.v"
      - "**/*.sv"
