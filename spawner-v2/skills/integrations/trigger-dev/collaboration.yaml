id: trigger-dev-collaboration
skill: trigger-dev
version: 1.0.0

# ============================================================================
# RECEIVES FROM (Who delegates TO this skill)
# ============================================================================
receives_from:
  - skill: backend
    context: "Backend needs background job processing"
    receives:
      - "API endpoints that trigger jobs"
      - "Data processing requirements"
      - "Async workflow needs"
    provides: "Reliable task execution"

  - skill: ai-agents-architect
    context: "AI workflows need long-running execution"
    receives:
      - "AI pipeline design"
      - "Model orchestration"
      - "Timeout requirements"
    provides: "Durable AI task execution"

  - skill: nextjs-app-router
    context: "Next.js app needs background processing"
    receives:
      - "Server action triggers"
      - "API route handlers"
      - "Webhook endpoints"
    provides: "Background task integration"

  - skill: email-systems
    context: "Email needs async sending"
    receives:
      - "Email queue requirements"
      - "Template data"
      - "Delivery tracking needs"
    provides: "Reliable email task execution"

  - skill: stripe-integration
    context: "Payment webhooks need processing"
    receives:
      - "Webhook event types"
      - "Processing requirements"
      - "Idempotency needs"
    provides: "Webhook task handlers"

# ============================================================================
# DELEGATION TRIGGERS
# ============================================================================
delegation_triggers:
  - trigger: "redis|bullmq|traditional queue"
    delegate_to: bullmq-specialist
    pattern: parallel
    context: "Need Redis-backed queues instead of managed service"
    handoff_data:
      - "Queue requirements"
      - "Redis infrastructure needs"
      - "Job processing patterns"
    receive: "Redis queue implementation"

  - trigger: "vercel|deployment|serverless"
    delegate_to: vercel-deployment
    pattern: parallel
    context: "Trigger.dev needs deployment config"
    handoff_data:
      - "Environment variables"
      - "Build configuration"
      - "Runtime requirements"
    receive: "Deployment configuration"

  - trigger: "database|postgres|supabase"
    delegate_to: supabase-backend
    pattern: parallel
    context: "Tasks need database access"
    handoff_data:
      - "Data models for tasks"
      - "Connection requirements"
      - "Transaction needs"
    receive: "Database layer"

  - trigger: "openai|anthropic|ai model|llm"
    delegate_to: llm-architect
    pattern: parallel
    context: "Tasks need AI model integration"
    handoff_data:
      - "Model selection"
      - "Prompt design"
      - "Token/cost management"
    receive: "AI integration patterns"

  - trigger: "event-driven|event sourcing|fan out"
    delegate_to: inngest
    pattern: parallel
    context: "Need pure event-driven model"
    handoff_data:
      - "Event types"
      - "Workflow requirements"
      - "Step function needs"
    receive: "Event-driven implementation"

# ============================================================================
# FEEDBACK LOOPS
# ============================================================================
feedback_loops:
  receives_feedback_from:
    - skill: devops
      signal: "Task performance metrics"
      action: "Optimize concurrency and timeouts"

    - skill: backend
      signal: "API integration issues"
      action: "Adjust task triggering patterns"

    - skill: ai-agents-architect
      signal: "AI task failures"
      action: "Improve error handling and chunking"

  sends_feedback_to:
    - skill: backend
      signal: "Task execution patterns"
      action: "Optimize trigger points"

    - skill: vercel-deployment
      signal: "Environment requirements"
      action: "Configure env vars"

    - skill: devops
      signal: "Resource utilization"
      action: "Scale infrastructure"

# ============================================================================
# CROSS-DOMAIN INSIGHTS
# ============================================================================
cross_domain_insights:
  - domain: Distributed Systems
    insight: |
      Distributed systems engineers know durability:
      - Tasks must survive failures
      - Retries are inevitable
      - Idempotency prevents duplicates
      - Timeouts are mandatory
      Trigger.dev provides durable execution primitives.
    applies_when: "Designing task architecture"

  - domain: Queue Theory
    insight: |
      Queue architects know throughput:
      - Concurrency limits protect downstream
      - Backpressure prevents overload
      - Dead letter queues catch failures
      - Observability is critical
      Background jobs follow queue patterns.
    applies_when: "Configuring task queues"

  - domain: AI Engineering
    insight: |
      AI engineers know long-running tasks:
      - LLM calls can take minutes
      - Token limits require chunking
      - Costs accumulate quickly
      - Failures need graceful handling
      AI tasks need special consideration.
    applies_when: "Building AI pipelines"

# ============================================================================
# COMMON COMBINATIONS
# ============================================================================
common_combinations:
  - name: AI Background Processing
    skills:
      - trigger-dev
      - llm-architect
      - nextjs-app-router
      - supabase-backend
    workflow: |
      1. User triggers via UI (nextjs-app-router)
      2. Task queued (trigger-dev)
      3. AI processing (llm-architect)
      4. Results stored (supabase-backend)

  - name: Webhook Processing Pipeline
    skills:
      - trigger-dev
      - stripe-integration
      - email-systems
      - supabase-backend
    workflow: |
      1. Webhook received (stripe-integration)
      2. Task triggered (trigger-dev)
      3. Database updated (supabase-backend)
      4. Notification sent (email-systems)

  - name: Batch Data Processing
    skills:
      - trigger-dev
      - supabase-backend
      - backend
    workflow: |
      1. Batch job triggered (backend)
      2. Data chunked and processed (trigger-dev)
      3. Results aggregated (supabase-backend)

  - name: Scheduled Reports
    skills:
      - trigger-dev
      - supabase-backend
      - email-systems
    workflow: |
      1. Cron triggers task (trigger-dev)
      2. Data aggregated (supabase-backend)
      3. Report generated and sent (email-systems)
