id: inngest-collaboration
skill: inngest
version: 1.0.0

# ============================================================================
# RECEIVES FROM (Who delegates TO this skill)
# ============================================================================
receives_from:
  - skill: backend
    context: "Backend needs background job processing"
    receives:
      - "Job requirements"
      - "Processing logic"
      - "Error handling needs"
    provides: "Event-driven background processing"

  - skill: nextjs-app-router
    context: "Next.js needs async processing"
    receives:
      - "Long-running task requirements"
      - "Webhook handling needs"
      - "Scheduled job requirements"
    provides: "Durable serverless functions"

  - skill: ai-agents-architect
    context: "AI workflows need reliable execution"
    receives:
      - "Multi-step AI pipelines"
      - "LLM call orchestration"
      - "Retry requirements for API failures"
    provides: "Durable AI workflow execution"

  - skill: email-systems
    context: "Email needs reliable delivery"
    receives:
      - "Email sending requirements"
      - "Drip campaign logic"
      - "Transactional email triggers"
    provides: "Reliable email job processing"

  - skill: stripe-integration
    context: "Payments need webhook handling"
    receives:
      - "Webhook event types"
      - "Payment processing logic"
      - "Subscription lifecycle handling"
    provides: "Idempotent webhook processing"

  - skill: supabase-backend
    context: "Database triggers need async handling"
    receives:
      - "Database event triggers"
      - "Data processing requirements"
      - "Async operation needs"
    provides: "Event-driven data processing"

# ============================================================================
# DELEGATION TRIGGERS
# ============================================================================
delegation_triggers:
  - trigger: "redis|queue infrastructure|bullmq"
    delegate_to: bullmq-specialist
    pattern: sequential
    context: "Need Redis-based queue with existing infrastructure"
    handoff_data:
      - "Queue requirements"
      - "Why serverless might not fit"
      - "Redis infrastructure details"
    receive: "Redis queue implementation"

  - trigger: "saga|compensation|rollback|long-running workflow"
    delegate_to: temporal-craftsman
    pattern: sequential
    context: "Need complex workflow orchestration with compensation"
    handoff_data:
      - "Workflow complexity"
      - "Compensation requirements"
      - "State machine definition"
    receive: "Temporal workflow design"

  - trigger: "event sourcing|event store|cqrs"
    delegate_to: event-architect
    pattern: parallel
    context: "Need event sourcing patterns"
    handoff_data:
      - "Event schema"
      - "Aggregate design"
      - "Projection requirements"
    receive: "Event sourcing architecture"

  - trigger: "vercel|deploy|production"
    delegate_to: vercel-deployment
    pattern: parallel
    context: "Need deployment configuration"
    handoff_data:
      - "Function configuration"
      - "Environment variables"
      - "Timeout requirements"
    receive: "Vercel deployment setup"

  - trigger: "database|schema|data model"
    delegate_to: supabase-backend
    pattern: parallel
    context: "Need database for event data"
    handoff_data:
      - "Job state schema"
      - "Event logging tables"
      - "Idempotency tracking"
    receive: "Database layer"

  - trigger: "api|endpoint|route"
    delegate_to: backend
    pattern: parallel
    context: "Need API to trigger events"
    handoff_data:
      - "Event trigger endpoints"
      - "API authentication"
      - "Event payload structure"
    receive: "API routes"

# ============================================================================
# FEEDBACK LOOPS
# ============================================================================
feedback_loops:
  receives_feedback_from:
    - skill: vercel-deployment
      signal: "Function timeout issues"
      action: "Adjust step boundaries or concurrency"

    - skill: backend
      signal: "Processing bottlenecks"
      action: "Optimize concurrency and fan-out patterns"

    - skill: stripe-integration
      signal: "Webhook failures"
      action: "Improve idempotency and error handling"

    - skill: performance-hunter
      signal: "Slow execution times"
      action: "Optimize step granularity"

  sends_feedback_to:
    - skill: backend
      signal: "Job completion status"
      action: "Update application state"

    - skill: frontend
      signal: "Processing progress"
      action: "Update UI with progress"

    - skill: email-systems
      signal: "Email job results"
      action: "Handle bounces and failures"

    - skill: stripe-integration
      signal: "Payment processing results"
      action: "Update subscription state"

# ============================================================================
# CROSS-DOMAIN INSIGHTS
# ============================================================================
cross_domain_insights:
  - domain: Distributed Systems
    insight: |
      Distributed systems engineers know:
      - Exactly-once is impossible, at-least-once is achievable
      - Idempotency is the solution to duplicate delivery
      - Steps are your transaction boundaries
      - Failure is normal, design for recovery
      Inngest embodies these principles in its design.
    applies_when: "Designing event-driven workflows"

  - domain: Event-Driven Architecture
    insight: |
      Event architects know:
      - Events describe what happened, not what to do
      - Payloads should be small and reference data
      - Fan-out enables parallel processing
      - Decoupling enables independent scaling
      Inngest is event-first by design.
    applies_when: "Structuring event payloads and triggers"

  - domain: Serverless Computing
    insight: |
      Serverless engineers know:
      - Cold starts are real, plan for them
      - Timeouts kill long operations
      - State doesn't persist between invocations
      - Steps provide durable state boundaries
      Inngest solves serverless durability problems.
    applies_when: "Handling long-running operations"

# ============================================================================
# COMMON COMBINATIONS
# ============================================================================
common_combinations:
  - name: Vercel Background Jobs
    skills:
      - inngest
      - nextjs-app-router
      - vercel-deployment
    workflow: |
      1. Define Inngest functions (inngest)
      2. Set up serve handler in Next.js (nextjs-app-router)
      3. Configure function timeouts (vercel-deployment)
      4. Deploy and test (vercel-deployment)

  - name: AI Pipeline
    skills:
      - inngest
      - ai-agents-architect
      - supabase-backend
    workflow: |
      1. Design AI workflow steps (ai-agents-architect)
      2. Implement with Inngest durability (inngest)
      3. Store results in database (supabase-backend)
      4. Handle retries for API failures (inngest)

  - name: Webhook Processing
    skills:
      - inngest
      - stripe-integration
      - backend
    workflow: |
      1. Receive webhook (backend)
      2. Send to Inngest with idempotency (inngest)
      3. Process payment logic (stripe-integration)
      4. Update application state (backend)

  - name: Email Automation
    skills:
      - inngest
      - email-systems
      - supabase-backend
    workflow: |
      1. Trigger event from user action (inngest)
      2. Schedule drip emails with step.sleep (inngest)
      3. Send emails with retry (email-systems)
      4. Track email status (supabase-backend)

  - name: Scheduled Tasks
    skills:
      - inngest
      - backend
      - analytics-architecture
    workflow: |
      1. Define cron triggers (inngest)
      2. Implement processing logic (backend)
      3. Aggregate and report data (analytics-architecture)
      4. Handle failures with alerting (inngest)
