id: trading-psychology
skill: Trading Psychology
version: "1.0"

validations:
  - id: check-pre-trade-checklist
    name: Pre-Trade Checklist Exists
    description: Trading systems should include pre-trade emotional check
    pattern: "trade|entry|position"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "checklist|emotional|state|assessment"
    message: "Include pre-trade emotional state assessment"
    severity: warning
    autofix: false

  - id: check-journal-logging
    name: Trade Journaling Implementation
    description: Trades should be logged with psychological notes
    pattern: "trade|order|execute"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "journal|log|record|note"
    message: "Implement trade journaling for psychological analysis"
    severity: info
    autofix: false

  - id: check-daily-limits
    name: Daily Loss Limits
    description: Trading systems should enforce daily loss limits
    pattern: "daily.*limit|max.*loss|stop.*trading"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "trade|strategy"
    message: "Implement daily loss limits to prevent tilt"
    severity: warning
    autofix: false

  - id: check-cooldown-period
    name: Post-Loss Cooldown
    description: Systems should enforce cooldown after losses
    pattern: "cooldown|wait|break|pause"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "loss|after.*trade"
    message: "Implement mandatory cooldown period after losses"
    severity: info
    autofix: false

  - id: check-max-trades
    name: Maximum Trades Per Day
    description: Limit number of trades to prevent overtrading
    pattern: "max.*trades|trade.*limit|trades.*per.*day"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "daily|session"
    message: "Implement maximum trades per day limit"
    severity: info
    autofix: false

  - id: check-size-rules
    name: Position Size Rules
    description: Size should be systematic, not emotional
    pattern: "position.*size|size.*calc"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "system|rule|formula"
    message: "Use systematic position sizing, not discretionary"
    severity: warning
    autofix: false

  - id: check-stop-immutable
    name: Stop Loss Immutability
    description: Stops should not be moveable after entry
    pattern: "move.*stop|change.*stop|widen.*stop"
    file_glob: "**/*.{py,js,ts}"
    match: present
    message: "Warning: Moving stops is a common psychological trap"
    severity: warning
    autofix: false

  - id: check-tilt-detection
    name: Tilt Detection System
    description: Implement automated tilt detection
    pattern: "tilt|consecutive.*loss|revenge"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "detect|monitor|track"
    message: "Implement tilt detection to prevent spiral losses"
    severity: info
    autofix: false

pre_commit:
  - id: journal-complete
    name: Journal Completion Check
    command: "python scripts/check_journal.py"
    description: Verify all trades have journal entries

  - id: limit-check
    name: Daily Limits Active
    command: "python scripts/verify_limits.py"
    description: Verify daily limits are properly configured

ci_checks:
  - id: psychology-metrics
    name: Psychology Metrics Analysis
    command: "python scripts/analyze_psychology.py"
    description: Analyze psychological patterns in trading data
    required: false

  - id: adherence-analysis
    name: Rule Adherence Analysis
    command: "python scripts/analyze_adherence.py"
    description: Calculate plan adherence rate

  - id: tilt-pattern-detection
    name: Tilt Pattern Detection
    command: "python scripts/detect_tilt_patterns.py"
    description: Identify historical tilt patterns in trading data
