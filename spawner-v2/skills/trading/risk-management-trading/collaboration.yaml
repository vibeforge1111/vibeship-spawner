id: risk-management-trading
skill: Risk Management for Trading
version: "1.0"

receives_context_from:
  - skill: technical-analysis
    receives:
      - Entry and exit levels
      - Stop loss placement (structure-based)
      - Target levels
    provides:
      - Position sizing for given stops
      - Risk/reward calculations
      - Trade viability assessment

  - skill: quantitative-research
    receives:
      - Backtest statistics (win rate, avg win/loss)
      - Strategy drawdown history
      - Edge quantification
    provides:
      - Kelly criterion sizing
      - Risk of ruin calculations
      - Strategy risk budget

  - skill: execution-algorithms
    receives:
      - Expected slippage
      - Execution costs
      - Fill probabilities
    provides:
      - Slippage-adjusted risk calculations
      - True cost of stops
      - Execution risk assessment

  - skill: portfolio-optimization
    receives:
      - Portfolio composition
      - Correlation structure
      - Allocation weights
    provides:
      - Position-level risk limits
      - Correlation-adjusted sizing
      - Portfolio VaR contribution

delegation_triggers:
  - pattern: "backtest|edge|statistical|win.*rate"
    delegate_to: quantitative-research
    context: "Need statistics for risk calculations"

  - pattern: "technical|chart|stop.*placement"
    delegate_to: technical-analysis
    context: "Need technical levels for stop placement"

  - pattern: "execute|slippage|fill|order"
    delegate_to: execution-algorithms
    context: "Need execution analysis for risk assessment"

  - pattern: "portfolio|allocation|correlation"
    delegate_to: portfolio-optimization
    context: "Portfolio-level risk analysis needed"

  - pattern: "emotion|psychology|discipline"
    delegate_to: trading-psychology
    context: "Psychological aspects of following risk rules"

common_combinations:
  - name: Complete Trade Risk Assessment
    skills:
      - risk-management-trading
      - technical-analysis
      - quantitative-research
    workflow: |
      1. Identify setup and stop level (technical-analysis)
      2. Get system statistics (quantitative-research)
      3. Calculate position size and validate (risk-management-trading)

  - name: Portfolio Risk Management
    skills:
      - risk-management-trading
      - portfolio-optimization
      - quantitative-research
    workflow: |
      1. Analyze portfolio correlation (portfolio-optimization)
      2. Calculate strategy-level risk (quantitative-research)
      3. Set position limits and monitor (risk-management-trading)

  - name: Execution-Aware Risk
    skills:
      - risk-management-trading
      - execution-algorithms
      - technical-analysis
    workflow: |
      1. Define entry/exit levels (technical-analysis)
      2. Estimate execution costs (execution-algorithms)
      3. Adjust risk calculations for slippage (risk-management-trading)

cross_domain_insights:
  - domain: Insurance Actuarial Science
    insight: Risk pooling and diversification principles apply to trading portfolios
    application: Treat each trade as an "insured event" in a portfolio of bets

  - domain: Casino Gaming
    insight: Kelly Criterion was developed for gambling, applies perfectly to trading
    application: Optimal bet sizing for positive expectancy games

  - domain: Aviation Safety
    insight: Defense in depth - multiple layers of protection
    application: Stop loss + position size + portfolio limits + drawdown rules

  - domain: Nuclear Power
    insight: Fail-safe design assumes worst case
    application: Size for the worst historical drawdown Ã— 2

  - domain: Epidemiology
    insight: Fat-tailed distributions dominate extreme events
    application: Normal VaR is worthless; focus on tail risk

ecosystem_alternatives:
  position_sizing:
    - name: Fixed Fractional
      when: Standard approach, simple to implement
      tradeoff: Doesn't adapt to changing conditions
    - name: Kelly Criterion
      when: Have reliable statistics, want mathematical optimum
      tradeoff: Very aggressive, requires accurate inputs
    - name: Volatility Targeting
      when: Want consistent portfolio volatility
      tradeoff: More complex, requires volatility estimation

  risk_metrics:
    - name: VaR (Value at Risk)
      when: Regulatory requirements, common language
      tradeoff: Ignores tail risk
    - name: CVaR (Expected Shortfall)
      when: Better tail risk capture
      tradeoff: Less intuitive, harder to compute
    - name: Maximum Drawdown
      when: Simple, meaningful to traders
      tradeoff: Backward-looking only

  stop_methods:
    - name: Fixed Percentage
      when: Simple, easy to implement
      tradeoff: Doesn't adapt to volatility
    - name: ATR-Based
      when: Want volatility-adjusted stops
      tradeoff: Requires ATR calculation
    - name: Structure-Based
      when: Want stops at meaningful levels
      tradeoff: Requires technical analysis skill

feedback_loops:
  - from: quantitative-research
    incorporates:
      - Updated strategy statistics
      - Drawdown history
      - Edge decay analysis
    into: Position sizing parameters and limits

  - from: execution-algorithms
    incorporates:
      - Actual slippage data
      - Execution costs
      - Fill rate analysis
    into: Slippage assumptions in risk models

  - from: trading-psychology
    incorporates:
      - Behavioral patterns during drawdowns
      - Rule-following analysis
      - Emotional state correlations
    into: Circuit breaker thresholds and rules

prerequisites:
  required_knowledge:
    - Basic probability and statistics
    - Compound interest mathematics
    - Spreadsheet proficiency

  recommended_tools:
    - Excel/Google Sheets (quick calculations)
    - Python with numpy, scipy
    - Position size calculator
    - Risk monitoring dashboard

  environment_setup: |
    # Python risk management setup
    pip install numpy scipy pandas matplotlib

    # Basic position size calculator
    def position_size(account, risk_pct, entry, stop):
        risk_amount = account * risk_pct
        risk_per_share = abs(entry - stop)
        return int(risk_amount / risk_per_share)

    # Example usage
    account = 100000
    risk_pct = 0.01  # 1%
    entry = 50.00
    stop = 47.00

    shares = position_size(account, risk_pct, entry, stop)
    print(f"Position: {shares} shares")
    print(f"Value: ${shares * entry:,.2f}")
    print(f"Risk: ${shares * (entry - stop):,.2f}")
