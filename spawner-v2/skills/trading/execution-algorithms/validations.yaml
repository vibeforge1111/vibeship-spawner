id: execution-algorithms
skill: Execution Algorithms
version: "1.0"

validations:
  - id: check-slippage-modeling
    name: Slippage Modeling Required
    description: Execution code must include realistic slippage estimates
    pattern: "order|execute|trade|fill"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "slippage|impact|cost"
    message: "Include realistic slippage/impact modeling in execution logic"
    severity: error
    autofix: false

  - id: check-market-order-size
    name: Market Order Size Check
    description: Large market orders should be flagged
    pattern: "market.*order|marketOrder|type.*market"
    file_glob: "**/*.{py,js,ts}"
    match: present
    message: "Market orders on large sizes cause significant slippage - consider splitting"
    severity: warning
    autofix: false

  - id: check-participation-rate
    name: Participation Rate Limits
    description: Trading should respect volume participation limits
    pattern: "volume|adv|participation"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "order|trade|execute"
    message: "Track participation rate - exceeding 5-10% of volume causes impact"
    severity: warning
    autofix: false

  - id: check-order-timing-randomization
    name: Timing Randomization
    description: Execution timing should be randomized to prevent gaming
    pattern: "random|jitter|noise"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "execute|schedule|twap|vwap"
    message: "Add timing randomization to prevent execution pattern detection"
    severity: info
    autofix: false

  - id: check-fill-tracking
    name: Fill Quality Tracking
    description: Execution should track fill quality metrics
    pattern: "fill.*rate|slippage.*track|execution.*quality"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "execute|order"
    message: "Track fill quality metrics for execution analysis"
    severity: info
    autofix: false

  - id: check-venue-selection
    name: Multi-Venue Routing
    description: Orders should consider multiple venues
    pattern: "venue|exchange|route"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "order|execute"
    message: "Consider smart order routing across multiple venues"
    severity: info
    autofix: false

  - id: check-overfill-prevention
    name: Overfill Prevention
    description: Multi-leg execution needs overfill protection
    pattern: "pending|outstanding|overfill"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "slice|child|parent.*order"
    message: "Implement overfill prevention when splitting orders"
    severity: warning
    autofix: false

  - id: check-cancel-logic
    name: Cancel and Replace Logic
    description: Stale orders should be cancelled
    pattern: "cancel|timeout|stale"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "limit.*order|resting"
    message: "Implement cancel logic for stale limit orders"
    severity: info
    autofix: false

  - id: check-latency-not-overoptimized
    name: Latency Over-Optimization Warning
    description: Non-HFT should not over-optimize for latency
    pattern: "microsecond|nanosecond|latency.*critical"
    file_glob: "**/*.{py,js,ts}"
    match: present
    message: "Unless HFT, focus on algo quality over microsecond latency"
    severity: info
    autofix: false

pre_commit:
  - id: execution-logic-test
    name: Execution Logic Tests
    command: "python -m pytest tests/test_execution.py -v"
    description: Verify execution algorithm logic

  - id: slippage-model-test
    name: Slippage Model Validation
    command: "python -m pytest tests/test_slippage.py -v"
    description: Verify slippage models are realistic

ci_checks:
  - id: execution-quality-analysis
    name: Execution Quality Analysis
    command: "python scripts/analyze_execution.py"
    description: Analyze historical execution quality
    required: true

  - id: benchmark-comparison
    name: Benchmark Comparison
    command: "python scripts/compare_benchmarks.py"
    description: Compare execution vs VWAP/TWAP benchmarks

  - id: venue-analysis
    name: Venue Performance Analysis
    command: "python scripts/analyze_venues.py"
    description: Analyze fill quality by venue
