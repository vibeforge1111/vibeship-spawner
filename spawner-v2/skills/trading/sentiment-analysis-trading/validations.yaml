id: sentiment-analysis-trading
skill: Sentiment Analysis for Trading
version: "1.0"

validations:
  - id: check-sentiment-backtested
    name: Sentiment Signal Backtested
    description: Sentiment signals must be backtested before use
    pattern: "sentiment|social|twitter|reddit|news"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "backtest|test|validate|ic|correlation"
    message: "Backtest sentiment signals before using in production"
    severity: error
    autofix: false

  - id: check-lag-analysis
    name: Lead/Lag Analysis Required
    description: Must analyze if sentiment leads or lags price
    pattern: "sentiment.*signal|sentiment.*trade"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "lag|lead|granger|causality"
    message: "Analyze lead/lag relationship - sentiment often lags price"
    severity: warning
    autofix: false

  - id: check-data-quality-filter
    name: Data Quality Filtering
    description: Social data needs quality filters (bots, spam)
    pattern: "twitter|reddit|social|discord"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "filter|quality|bot|spam|account.*age"
    message: "Filter for data quality - bots and spam are prevalent"
    severity: warning
    autofix: false

  - id: check-multiple-sources
    name: Multiple Data Sources
    description: Don't rely on single sentiment source
    pattern: "sentiment.*index|composite.*sentiment"
    file_glob: "**/*.{py,js,ts}"
    match: absent
    context_pattern: "single.*source|only.*twitter"
    message: "Use multiple sentiment sources for robustness"
    severity: info
    autofix: false

  - id: check-manipulation-detection
    name: Manipulation Detection
    description: Check for coordinated manipulation campaigns
    pattern: "twitter|reddit|social"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "coordinate|manipulate|campaign|bot.*detect"
    message: "Implement manipulation detection for social signals"
    severity: info
    autofix: false

  - id: check-news-latency
    name: News Latency Awareness
    description: Account for news processing latency
    pattern: "news.*trade|headline|breaking"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "latency|delay|speed|fast"
    message: "Account for news latency - by the time you read it, price has moved"
    severity: warning
    autofix: false

  - id: check-onchain-verification
    name: On-Chain Data Verification
    description: Verify on-chain data interpretation
    pattern: "on.*chain|whale|exchange.*flow"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "verify|label|known|exchange.*wallet"
    message: "Verify on-chain data labels and interpretations"
    severity: info
    autofix: false

  - id: check-extreme-persistence
    name: Extreme Sentiment Persistence
    description: Account for persistent extremes in strategy
    pattern: "extreme|contrarian|fear|greed"
    file_glob: "**/*.{py,js,ts}"
    match: present
    context_pattern: "duration|persist|confirm|wait"
    message: "Account for sentiment extreme persistence in contrarian trades"
    severity: info
    autofix: false

pre_commit:
  - id: sentiment-signal-test
    name: Sentiment Signal Tests
    command: "python -m pytest tests/test_sentiment.py -v"
    description: Verify sentiment signal logic

  - id: data-quality-test
    name: Data Quality Tests
    command: "python -m pytest tests/test_data_quality.py -v"
    description: Verify data quality filtering

ci_checks:
  - id: sentiment-ic-check
    name: Information Coefficient Analysis
    command: "python scripts/analyze_sentiment_ic.py"
    description: Analyze sentiment signal IC over time
    required: true

  - id: lead-lag-analysis
    name: Lead/Lag Analysis
    command: "python scripts/analyze_lead_lag.py"
    description: Check if signals lead or lag price

  - id: manipulation-scan
    name: Manipulation Detection Scan
    command: "python scripts/detect_manipulation.py"
    description: Scan for potential manipulation campaigns
