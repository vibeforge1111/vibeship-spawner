validations:

  - id: stale-tle-check
    name: TLE Age Not Validated
    severity: error
    type: regex
    pattern:
      - "TLE(?!.*age|epoch|update)"
      - "propagate.*tle(?!.*valid)"
      - "predict.*pass(?!.*tle.*fresh)"
    message: "TLE-based predictions may not check TLE age"
    fix_action: "Validate TLE age before prediction (< 3 days for LEO)"
    applies_to:
      - "**/*.py"

  - id: no-command-echo
    name: Command Without Echo Verification
    severity: error
    type: regex
    pattern:
      - "send_command(?!.*echo|verify)"
      - "uplink(?!.*confirm)"
      - "command\\.execute(?!.*check)"
    message: "Command uplink may lack echo verification"
    fix_action: "Always verify command echo before execution acknowledgment"
    applies_to:
      - "**/*.py"

  - id: no-link-margin-check
    name: Link Budget Without Margin Verification
    severity: warning
    type: regex
    pattern:
      - "link_budget(?!.*margin)"
      - "signal_to_noise(?!.*threshold)"
      - "eb_n0(?!.*required)"
    message: "Link analysis may not verify adequate margin"
    fix_action: "Check Eb/N0 > required + 3 dB margin"
    applies_to:
      - "**/*.py"

  - id: no-weather-consideration
    name: Scheduling Without Weather Check
    severity: warning
    type: regex
    pattern:
      - "schedule.*pass(?!.*weather)"
      - "contact.*plan(?!.*rain|attenuation)"
      - "link.*loss(?!.*atmospheric)"
    message: "Contact scheduling may not account for weather"
    fix_action: "Include weather-based attenuation in link budget"
    applies_to:
      - "**/*.py"

  - id: no-telemetry-limits
    name: Telemetry Without Limit Checking
    severity: warning
    type: regex
    pattern:
      - "TelemetryPoint\\((?!.*limit)"
      - "process.*telemetry(?!.*check|status)"
      - "calibrat(?!.*limit)"
    message: "Telemetry processing may lack limit checking"
    fix_action: "Define warning and critical limits for all telemetry"
    applies_to:
      - "**/*.py"

  - id: no-data-archive
    name: Telemetry Without Archive
    severity: warning
    type: regex
    pattern:
      - "process.*frame(?!.*store|archive|history)"
      - "telemetry.*latest(?!.*history)"
      - "TelemetryProcessor(?!.*history)"
    message: "Telemetry processing may not archive historical data"
    fix_action: "Archive all telemetry for trending and anomaly investigation"
    applies_to:
      - "**/*.py"

  - id: no-conflict-resolution
    name: Scheduler Without Conflict Resolution
    severity: warning
    type: regex
    pattern:
      - "schedule.*contact(?!.*conflict)"
      - "generate_schedule(?!.*overlap)"
      - "pass.*list(?!.*priority)"
    message: "Contact scheduler may not handle conflicts"
    fix_action: "Add priority-based conflict resolution"
    applies_to:
      - "**/*.py"

  - id: hardcoded-min-elevation
    name: Hardcoded Minimum Elevation
    severity: info
    type: regex
    pattern:
      - "min_elevation\\s*=\\s*[0-9](?!.*config)"
      - "elevation.*>\\s*5(?!.*parameter)"
    message: "Minimum elevation may be hardcoded"
    fix_action: "Make minimum elevation configurable per station"
    applies_to:
      - "**/*.py"
