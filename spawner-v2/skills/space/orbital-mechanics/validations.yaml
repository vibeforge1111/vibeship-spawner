validations:

  - id: no-j2-for-leo
    name: Missing J2 Perturbation for LEO
    severity: error
    type: regex
    pattern:
      - "propagate.*altitude.*<.*2000(?!.*j2)"
      - "LEO.*propagat(?!.*perturbation)"
      - "two_body.*low.*earth"
    message: "LEO propagation may be missing J2 perturbation - predictions will diverge quickly"
    fix_action: "Add J2 perturbation for any orbit below 2000 km altitude"
    applies_to:
      - "**/*.py"

  - id: hardcoded-mu
    name: Hardcoded Gravitational Parameter
    severity: warning
    type: regex
    pattern:
      - "mu\\s*=\\s*398600(?!.*comment)"
      - "GM\\s*=\\s*3\\.986"
      - "\\*\\s*398600\\.4"
    message: "Gravitational parameter appears hardcoded - use named constant"
    fix_action: "Define MU_EARTH or similar as named constant with units documented"
    applies_to:
      - "**/*.py"

  - id: kepler-no-convergence-check
    name: Kepler Solver Without Convergence Check
    severity: error
    type: regex
    pattern:
      - "while.*kepler(?!.*max_iter)"
      - "for.*newton(?!.*converge)"
      - "eccentric_anomaly.*=(?!.*try)"
    message: "Kepler equation solver may lack convergence checking"
    fix_action: "Add maximum iteration limit and convergence tolerance check"
    applies_to:
      - "**/*.py"

  - id: plane-change-at-periapsis
    name: Plane Change at Periapsis
    severity: warning
    type: regex
    pattern:
      - "plane_change.*periapsis"
      - "inclination.*change.*at.*periapsis"
      - "delta_v.*incl(?!.*apoapsis)"
    message: "Plane change at periapsis is inefficient - consider apoapsis"
    fix_action: "Evaluate performing plane changes at apoapsis to minimize delta-v"
    applies_to:
      - "**/*.py"

  - id: unbounded-propagation
    name: Unbounded Orbit Propagation
    severity: warning
    type: regex
    pattern:
      - "propagate\\((?!.*max_time)"
      - "integrate.*orbit(?!.*limit)"
      - "while.*True.*propagat"
    message: "Orbit propagation may run unbounded"
    fix_action: "Set maximum propagation time or step limit"
    applies_to:
      - "**/*.py"

  - id: division-by-zero-orbit
    name: Potential Division by Zero in Orbital Calculations
    severity: error
    type: regex
    pattern:
      - "/\\s*\\(.*\\+.*\\)(?!.*!=\\s*0)"
      - "1\\s*/\\s*e(?!.*if.*e)"
      - "sqrt\\(1\\s*-\\s*e\\*\\*2\\)(?!.*e\\s*<\\s*1)"
    message: "Orbital calculation may divide by zero for edge cases (circular orbit, parabolic)"
    fix_action: "Add checks for e=0 (circular), e=1 (parabolic), sum denominators"
    applies_to:
      - "**/*.py"

  - id: wrong-units-orbit
    name: Possible Unit Mismatch in Orbital Calculations
    severity: warning
    type: regex
    pattern:
      - "deg.*rad(?!.*convert)"
      - "km.*m(?!.*1000)"
      - "radians.*degrees(?!.*np\\.)"
    message: "Potential unit mismatch in orbital calculations"
    fix_action: "Verify consistent units (km, rad) and explicit conversions"
    applies_to:
      - "**/*.py"
