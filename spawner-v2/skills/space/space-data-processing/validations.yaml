validations:

  - id: no-atmospheric-correction
    name: Surface Analysis Without Atmospheric Correction
    severity: error
    type: regex
    pattern:
      - "ndvi.*level_1(?!.*correct)"
      - "surface.*reflectance(?!.*atmospheri)"
      - "toa.*analysis(?!.*correct)"
    message: "Surface analysis may be using TOA data without atmospheric correction"
    fix_action: "Apply atmospheric correction before surface reflectance analysis"
    applies_to:
      - "**/*.py"

  - id: no-cloud-mask
    name: Analysis Without Cloud Masking
    severity: error
    type: regex
    pattern:
      - "classify(?!.*cloud|mask|qa)"
      - "spectral.*index(?!.*cloud)"
      - "ndvi.*=(?!.*mask)"
    message: "Classification/analysis may not apply cloud masking"
    fix_action: "Apply cloud and shadow mask before analysis"
    applies_to:
      - "**/*.py"

  - id: sar-no-speckle-filter
    name: SAR Analysis Without Speckle Filtering
    severity: warning
    type: regex
    pattern:
      - "sar.*classify(?!.*filter|speckle)"
      - "sigma0.*analysis(?!.*lee|frost|multilook)"
      - "backscatter(?!.*denoise)"
    message: "SAR analysis may not include speckle filtering"
    fix_action: "Apply Lee, Frost, or multilooking before SAR classification"
    applies_to:
      - "**/*.py"

  - id: division-zero-index
    name: Spectral Index Division by Zero
    severity: error
    type: regex
    pattern:
      - "\\(nir\\s*-\\s*red\\)\\s*/\\s*\\(nir\\s*\\+\\s*red\\)(?!.*where|np\\.where)"
      - "ndvi\\s*=(?!.*eps|1e-10|\\+\\s*1)"
    message: "Spectral index calculation may divide by zero for dark pixels"
    fix_action: "Add small epsilon or use np.where to handle zero denominators"
    applies_to:
      - "**/*.py"

  - id: no-validation-accuracy
    name: Classification Without Accuracy Assessment
    severity: warning
    type: regex
    pattern:
      - "predict.*land_cover(?!.*accuracy|valid)"
      - "classifier\\.fit(?!.*test|valid)"
      - "classification.*output(?!.*assess)"
    message: "Classification may lack accuracy assessment"
    fix_action: "Calculate confusion matrix and accuracy metrics on validation set"
    applies_to:
      - "**/*.py"

  - id: single-scene-training
    name: Training on Single Scene Only
    severity: warning
    type: regex
    pattern:
      - "train.*single.*scene"
      - "training_data.*=.*load\\((?!.*multi|list)"
    message: "Training on single scene may not generalize"
    fix_action: "Include training samples from multiple scenes/dates"
    applies_to:
      - "**/*.py"

  - id: no-radiometric-cal
    name: Missing Radiometric Calibration
    severity: warning
    type: regex
    pattern:
      - "raw.*dn.*analysis"
      - "digital.*number(?!.*calibrat)"
      - "band.*data(?!.*radiance|reflect)"
    message: "Analysis may be using uncalibrated DN values"
    fix_action: "Convert DN to radiance or reflectance before analysis"
    applies_to:
      - "**/*.py"

  - id: no-units-documented
    name: Processing Output Without Units
    severity: info
    type: regex
    pattern:
      - "save.*result(?!.*units|metadata)"
      - "write.*tif(?!.*scale|description)"
      - "output(?!.*document)"
    message: "Output products may lack unit documentation"
    fix_action: "Document units and scale factors in output metadata"
    applies_to:
      - "**/*.py"
