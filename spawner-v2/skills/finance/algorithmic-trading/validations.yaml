validations:

  - id: no-walk-forward
    name: Optimization Without Walk-Forward
    severity: warning
    type: regex
    pattern:
      - "optimize.*(?!walk.?forward|time.?series.?split)"
      - "grid.?search(?!.*TimeSeriesSplit)"
    message: "Use walk-forward validation for time series to prevent overfitting."
    fix_action: "Use: TimeSeriesSplit for cross-validation"
    applies_to:
      - "**/*backtest*.py"
      - "**/*strategy*.py"

  - id: missing-slippage
    name: Backtest Without Slippage Model
    severity: warning
    type: regex
    pattern:
      - "backtest\\((?!.*slippage|.*commission|.*cost)"
    message: "Include realistic transaction costs in backtest."
    fix_action: "Add slippage and commission parameters"
    applies_to:
      - "**/*.py"

  - id: no-signal-shift
    name: Signal Without Time Shift
    severity: error
    type: regex
    pattern:
      - "position.*=.*signal(?!.*shift)"
      - "trade.*=.*indicator(?!.*shift)"
    message: "Shift signals to avoid look-ahead bias - can't trade on today's close."
    fix_action: "Add: signal.shift(1) before generating positions"
    applies_to:
      - "**/*strategy*.py"

  - id: hardcoded-parameters
    name: Hardcoded Strategy Parameters
    severity: info
    type: regex
    pattern:
      - "lookback\\s*=\\s*\\d+[^#]*$"
      - "threshold\\s*=\\s*[0-9.]+[^#]*$"
    message: "Consider making parameters configurable for optimization."
    fix_action: "Use config dict or dataclass for parameters"
    applies_to:
      - "**/*strategy*.py"

  - id: no-max-drawdown-check
    name: No Maximum Drawdown Limit
    severity: warning
    type: regex
    pattern:
      - "class.*Strategy(?!.*max_drawdown|.*drawdown_limit)"
    message: "Implement maximum drawdown limit for risk management."
    fix_action: "Add drawdown monitoring and position reduction"
    applies_to:
      - "**/*strategy*.py"

  - id: no-position-sizing
    name: Fixed Position Sizing
    severity: info
    type: regex
    pattern:
      - "position.*=.*1\\.0|position.*=.*-1\\.0"
      - "shares.*=.*\\d+\\s*$"
    message: "Use risk-based position sizing instead of fixed sizes."
    fix_action: "Implement Kelly criterion or volatility-adjusted sizing"
    applies_to:
      - "**/*.py"
