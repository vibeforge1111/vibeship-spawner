validations:

  - id: too-few-simulations
    name: Monte Carlo with Few Simulations
    severity: warning
    type: regex
    pattern:
      - "random.*\\((\\d{1,4})\\)"
      - "n_sim.*=.*\\d{1,4}$"
      - "num_paths.*=.*\\d{1,4}$"
    message: "Monte Carlo with < 10,000 simulations gives high variance VaR estimates."
    fix_action: "Use minimum 100,000 simulations for VaR, apply variance reduction"
    applies_to:
      - "**/*monte*.py"
      - "**/*simulation*.py"

  - id: normal-var-only
    name: VaR Using Only Normal Distribution
    severity: warning
    type: regex
    pattern:
      - "norm\\.ppf.*var"
      - "stats\\.norm.*ppf(?!.*t\\.ppf)"
    message: "Parametric VaR with normal distribution underestimates fat tails."
    fix_action: "Use t-distribution, historical simulation, or EVT for tail estimation"
    applies_to:
      - "**/*var*.py"
      - "**/*risk*.py"

  - id: no-expected-shortfall
    name: VaR Without Expected Shortfall
    severity: info
    type: regex
    pattern:
      - "class.*VaR(?!.*ES|.*CVaR|.*expected_shortfall)"
      - "def.*var(?!.*cvar|.*expected)"
    message: "VaR alone doesn't capture tail severity. Consider adding ES/CVaR."
    fix_action: "Implement Expected Shortfall alongside VaR"
    applies_to:
      - "**/*risk*.py"

  - id: static-correlation-matrix
    name: Using Static Correlation Matrix
    severity: info
    type: regex
    pattern:
      - "\\.corr\\(\\)(?!.*stress|.*crisis|.*rolling)"
    message: "Static correlation may underestimate risk during market stress."
    fix_action: "Add stressed correlation scenarios from crisis periods"
    applies_to:
      - "**/*risk*.py"
      - "**/*portfolio*.py"

  - id: no-variance-reduction
    name: Monte Carlo Without Variance Reduction
    severity: info
    type: regex
    pattern:
      - "random\\.normal.*for.*in.*range(?!.*antithetic)"
    message: "Consider variance reduction techniques for Monte Carlo."
    fix_action: "Add antithetic variates, control variates, or stratified sampling"
    applies_to:
      - "**/*monte*.py"
      - "**/*simulation*.py"

  - id: no-backtest
    name: Risk Model Without Backtesting
    severity: warning
    type: regex
    pattern:
      - "class.*RiskModel(?!.*backtest|.*validate|.*kupiec)"
    message: "Risk models should include backtesting validation."
    fix_action: "Implement Kupiec POF test and exception monitoring"
    applies_to:
      - "**/*risk*.py"
      - "**/*var*.py"
