validations:

  - id: historical-vol-pricing
    name: Using Historical Vol for Pricing
    severity: warning
    type: regex
    pattern:
      - "returns\\.std\\(\\).*black_scholes"
      - "historical.*vol.*price"
    message: "Using historical volatility for option pricing ignores market expectations."
    fix_action: "Extract implied volatility from market prices"
    applies_to:
      - "**/*option*.py"
      - "**/*pricing*.py"

  - id: single-vol-all-strikes
    name: Same Vol for All Strikes
    severity: warning
    type: regex
    pattern:
      - "for.*strike.*in.*:\\s*.*black_scholes.*(?!vol_surface|get_vol)"
    message: "Using same volatility for all strikes ignores smile/skew."
    fix_action: "Build volatility surface, use strike-specific vol"
    applies_to:
      - "**/*option*.py"

  - id: black-scholes-american
    name: Black-Scholes for American Options
    severity: warning
    type: regex
    pattern:
      - "american.*black.?scholes"
      - "black.?scholes.*american"
    message: "Black-Scholes doesn't price American early exercise correctly."
    fix_action: "Use binomial trees or LSM for American options"
    applies_to:
      - "**/*.py"

  - id: no-put-call-parity-check
    name: No Put-Call Parity Verification
    severity: info
    type: regex
    pattern:
      - "def.*price.*option(?!.*put_call_parity|.*parity_check)"
    message: "Consider verifying put-call parity as consistency check."
    fix_action: "Add: C - P = S*exp(-qT) - K*exp(-rT)"
    applies_to:
      - "**/*pricing*.py"

  - id: no-numerical-greek-check
    name: Greeks Without Numerical Verification
    severity: info
    type: regex
    pattern:
      - "def.*delta|def.*gamma|def.*vega(?!.*bump|.*numerical)"
    message: "Consider numerical verification of analytical Greeks."
    fix_action: "Add bump-and-reprice check for Greek formulas"
    applies_to:
      - "**/*greeks*.py"
      - "**/*option*.py"

  - id: barrier-no-bridge
    name: Barrier Options Without Brownian Bridge
    severity: warning
    type: regex
    pattern:
      - "barrier.*monte.?carlo(?!.*bridge|.*continuous)"
    message: "Discrete monitoring misses barrier crossings between steps."
    fix_action: "Use Brownian bridge correction for barrier options"
    applies_to:
      - "**/*exotic*.py"
      - "**/*barrier*.py"
