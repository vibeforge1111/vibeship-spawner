# Validations - Zapier & Make Patterns
# Checklists and quality checks for no-code automations

version: 1.0.0
skill_id: zapier-make-patterns

# Note: These are conceptual validations for reviewing automation designs
# No-code platforms don't have code to scan, so these are review checklists

automation_design_checks:
  # Naming and Documentation
  - id: descriptive-naming
    name: Automation Has Descriptive Name
    severity: warning
    description: Names should describe trigger, action, and purpose
    check: |
      Good: "New Typeform Lead → HubSpot CRM + Slack #sales"
      Bad: "My Zap", "Test", "New Zap 3"
    message: "Use descriptive names: 'Trigger → Actions' format"

  - id: documented-purpose
    name: Purpose is Documented
    severity: info
    description: Each automation should have documented purpose
    check: |
      Add description explaining:
      - What business process this automates
      - Who owns/maintains it
      - When it was last reviewed
    message: "Document the purpose and owner of each automation"

  # Testing
  - id: tested-with-real-data
    name: Tested with Real Sample Data
    severity: error
    description: Automation must be tested before going live
    check: |
      Verify:
      - Ran test with actual sample data (not placeholder)
      - All paths/branches tested
      - Error scenarios tested
      - Output verified in destination apps
    message: "Test with real data before enabling in production"

  - id: error-handling-present
    name: Error Handling Configured
    severity: warning
    description: Production automations need error handling
    check: |
      Required for production:
      - Error notification configured (email/Slack)
      - Critical actions have fallback paths
      - External API calls have timeout handling
    message: "Add error handling for production reliability"

  # Authentication
  - id: service-account-used
    name: Using Service Account for Connections
    severity: warning
    description: Personal accounts should not be used for team automations
    check: |
      Verify:
      - Connection uses shared/service account
      - Account won't be affected by user offboarding
      - Multiple admins have access to connection
    message: "Use service accounts, not personal accounts, for connections"

  # Efficiency
  - id: filter-before-action
    name: Filters Applied Before Expensive Actions
    severity: info
    description: Filter unnecessary runs early to save tasks/operations
    check: |
      Add filters when:
      - Only some records need processing
      - Duplicate detection needed
      - Conditional processing based on data
    message: "Add filters early to prevent unnecessary task consumption"

  - id: batch-when-possible
    name: Using Batch Operations When Available
    severity: info
    description: Batch operations are more efficient than loops
    check: |
      Instead of looping:
      - Use "Create Multiple" actions
      - Use bulk API endpoints
      - Aggregate data before sending
    message: "Use batch operations instead of loops when possible"

pre_deployment_checklist:
  critical:
    - "Tested with real sample data"
    - "All field mappings verified (no 'unknown' fields)"
    - "Authentication is fresh and working"
    - "Error handling configured"

  important:
    - "Descriptive name assigned"
    - "Purpose documented"
    - "Owner identified"
    - "Using service account (not personal)"
    - "Filters added to prevent unnecessary runs"

  recommended:
    - "Alert configured for failures"
    - "Change log started"
    - "Review date scheduled"
    - "Duplicate detection if webhook trigger"

post_deployment_monitoring:
  first_24_hours:
    - "Check Task History for errors"
    - "Verify data appearing in destination"
    - "Confirm no duplicate processing"
    - "Check task/operation consumption"

  first_week:
    - "Review error rate"
    - "Check for edge cases missed in testing"
    - "Verify all paths are executing as expected"
    - "Monitor API rate limit usage"

  ongoing:
    - "Weekly: Check Task History for errors"
    - "Monthly: Review task consumption vs budget"
    - "Quarterly: Review if automation still needed"
    - "After app updates: Test affected automations"

best_practices:
  - id: one-purpose-per-automation
    name: Single Purpose Per Automation
    check: |
      Each Zap/Scenario should do one logical thing.
    recommendation: |
      Split multi-purpose automations:

      # Instead of:
      "New order → update inventory + send email + create task + update CRM"

      # Use:
      Zap 1: "New order → Update inventory"
      Zap 2: "New order → Send confirmation email"
      Zap 3: "New order → Create fulfillment task"
      Zap 4: "New order → Update CRM"

      Benefits:
      - Easier to debug
      - One failure doesn't break everything
      - Independent modification

  - id: use-lookup-tables
    name: Use Lookup Tables for Mappings
    check: |
      Don't hardcode mappings in automation logic.
    recommendation: |
      Store mappings in a Google Sheet or database:

      | Status Code | Status Name |
      |-------------|-------------|
      | 1           | Active      |
      | 2           | Pending     |
      | 3           | Closed      |

      Then use "Lookup" action to get the value:
      - More maintainable
      - Non-technical users can update
      - Change once, update everywhere

  - id: log-important-events
    name: Log Important Events
    check: |
      Critical automations should log execution.
    recommendation: |
      Add logging action for:
      - What was processed (record ID, timestamp)
      - What action was taken
      - Success/failure status

      Log to:
      - Google Sheets (simple)
      - Airtable (structured)
      - Database (high volume)

      Enables:
      - Debugging failures
      - Audit trail
      - Metrics collection

  - id: version-control-configs
    name: Version Control Automation Configs
    check: |
      Track changes to automations over time.
    recommendation: |
      Since platforms don't have version control:

      1. Before major changes: Duplicate the automation
         - Name: "[BACKUP 2024-01-15] Original Name"

      2. Keep a change log:
         | Date | Change | Reason | Changed By |
         |------|--------|--------|------------|

      3. Export configurations when possible:
         - Make: Export scenarios as JSON
         - Document configurations in wiki

  - id: schedule-reviews
    name: Schedule Regular Reviews
    check: |
      Automations can become stale or broken.
    recommendation: |
      Quarterly review process:

      1. Is this automation still needed?
      2. Are the connected accounts still valid?
      3. Has any connected app updated?
      4. Is error rate acceptable?
      5. Is task/operation usage appropriate?
      6. Is documentation current?

      Set calendar reminders for review.

platform_selection_guide:
  use_zapier_when:
    - "You need maximum app integration coverage (7000+ apps)"
    - "Simple trigger → action workflows"
    - "Non-technical users building automations"
    - "Quick setup is priority over cost"
    - "Need AI features (Zapier Agents, Copilot)"

  use_make_when:
    - "Complex workflows with branching"
    - "Data transformation required"
    - "Budget-conscious (operations vs tasks pricing)"
    - "Visual workflow design matters"
    - "Power users who want more control"

  use_code_when:
    - "Performance is critical"
    - "Complex business logic"
    - "Need version control"
    - "High volume processing"
    - "Custom integrations"
    - "Regulatory requirements for code review"

common_troubleshooting:
  zap_not_triggering:
    - "Check if Zap is turned on"
    - "Verify trigger conditions match data"
    - "Check polling interval (may be 15 min)"
    - "Verify authentication is valid"
    - "Test trigger manually"

  action_failing:
    - "Check Task History for specific error"
    - "Verify all required fields mapped"
    - "Check dropdown values are IDs not text"
    - "Verify authentication not expired"
    - "Test action with sample data"

  data_not_appearing:
    - "Check filter conditions"
    - "Verify data format matches expected"
    - "Check field mapping in destination"
    - "Look for partial success (some records)"
    - "Check for duplicate detection blocking"

  high_error_rate:
    - "Identify most common error type"
    - "Check if source data format changed"
    - "Verify API hasn't been updated"
    - "Check rate limit errors"
    - "Add validation filters to prevent bad data"
