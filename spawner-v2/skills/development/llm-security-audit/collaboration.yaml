id: llm-security-audit-collaboration
skill: llm-security-audit
version: 1.0.0

receives_from:
  - skill: ai-code-security
    context: "Need comprehensive security assessment"
    receives:
      - "Application architecture"
      - "Known vulnerabilities"
      - "Current security controls"
    provides: "Full audit report with prioritized findings"

  - skill: prompt-injection-defense
    context: "Need to validate injection defenses"
    receives:
      - "Current defense implementation"
      - "Known bypass attempts"
    provides: "Penetration test results against defenses"

  - skill: mcp-server-development
    context: "MCP server needs security audit"
    receives:
      - "Server implementation"
      - "Tool definitions"
      - "Authentication setup"
    provides: "MCP-specific security findings"

delegation_triggers:
  - trigger: "fix vulnerability|implement control"
    delegate_to: ai-code-security
    pattern: sequential
    context: "Need to implement security fix"

  - trigger: "prompt injection|jailbreak"
    delegate_to: prompt-injection-defense
    pattern: sequential
    context: "Need specialized injection defense"

  - trigger: "mcp|tool security"
    delegate_to: mcp-security
    pattern: sequential
    context: "Need MCP-specific security patterns"

feedback_loops:
  receives_feedback_from:
    - skill: ai-code-security
      signal: "New vulnerability patterns"
      action: "Update audit test cases"

    - skill: prompt-injection-defense
      signal: "New injection techniques"
      action: "Add to penetration testing suite"

  sends_feedback_to:
    - skill: ai-code-security
      signal: "Audit findings and gaps"
      action: "Inform security control priorities"

    - skill: prompt-injection-defense
      signal: "Successful injection attempts"
      action: "Update detection patterns"

    - skill: mcp-security
      signal: "MCP-specific vulnerabilities"
      action: "Improve MCP security guidance"

cross_domain_insights:
  from_domains:
    - domain: web-application-security
      insight: "OWASP methodology applies to LLM apps"
      application: "Use OWASP testing guide adapted for AI"

    - domain: penetration-testing
      insight: "Black box + white box testing both valuable"
      application: "Combine automated scanning with manual testing"

    - domain: compliance-auditing
      insight: "Evidence collection is critical"
      application: "Document all findings with reproduction steps"

    - domain: risk-management
      insight: "Prioritize by business impact, not just technical severity"
      application: "Consider business context when rating findings"

common_combinations:
  - name: Complete LLM Security Program
    skills:
      - llm-security-audit
      - ai-code-security
      - prompt-injection-defense
    workflow: |
      1. Conduct comprehensive security audit
      2. Implement security controls based on findings
      3. Add specialized prompt injection defenses
      4. Establish continuous monitoring
      5. Schedule regular re-audits

  - name: Compliance-Driven Security
    skills:
      - llm-security-audit
      - ai-code-security
    workflow: |
      1. Map compliance requirements
      2. Conduct gap analysis
      3. Implement required controls
      4. Audit for compliance
      5. Document evidence

  - name: Pre-Launch Security Review
    skills:
      - llm-security-audit
      - prompt-injection-defense
      - mcp-security
    workflow: |
      1. Full security audit
      2. Penetration testing
      3. Fix critical/high issues
      4. Verify fixes
      5. Sign-off for launch
