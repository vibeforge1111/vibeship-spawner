# Conversation Memory Validations

validations:
  - id: memory-no-user-isolation
    name: No User Isolation in Memory
    severity: critical
    type: regex
    pattern: 'memory\.add|memory\.store|addMemory'
    negative_pattern: 'userId|user_id|ownerId|owner_id'
    message: "Memory operations without user isolation. Privacy vulnerability."
    fix_action: "Add userId to all memory operations, filter by user on retrieval"
    applies_to:
      - "*.ts"
      - "*.js"
      - "*.py"

  - id: memory-no-importance-filter
    name: No Importance Filtering
    severity: warning
    type: regex
    pattern: 'memory\.add|addMemory|store.*memory'
    negative_pattern: 'importance|score|filter|worthy'
    message: "Storing memories without importance filtering. May cause memory explosion."
    fix_action: "Score importance before storing, filter low-importance content"
    applies_to:
      - "*.ts"
      - "*.js"
      - "*.py"

  - id: memory-no-retrieval
    name: Memory Storage Without Retrieval
    severity: warning
    type: regex
    pattern: 'memory\.add|store.*memory'
    negative_pattern: 'search|retrieve|query|get.*relevant'
    message: "Storing memories but no retrieval logic. Memories won't be used."
    fix_action: "Implement memory retrieval and include in prompts"
    applies_to:
      - "*.ts"
      - "*.js"
      - "*.py"

  - id: memory-no-cleanup
    name: No Memory Cleanup
    severity: info
    type: regex
    pattern: 'memory\.add|addMemory'
    negative_pattern: 'cleanup|consolidate|expire|limit|max'
    message: "No memory cleanup mechanism. Storage will grow unbounded."
    fix_action: "Implement consolidation and cleanup based on age/importance"
    applies_to:
      - "*.ts"
      - "*.js"
      - "*.py"
