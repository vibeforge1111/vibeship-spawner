# CrewAI Validations

validations:
  - id: agent-missing-backstory
    name: Agent Without Backstory
    severity: medium
    type: regex
    pattern: 'Agent\([^)]*role[^)]*goal[^)]*\)'
    negative_pattern: 'backstory'
    message: "Agent without backstory may lack context for decisions."
    fix_action: "Add backstory explaining agent's expertise and approach"
    applies_to:
      - "*.py"

  - id: task-missing-expected-output
    name: Task Without Expected Output
    severity: high
    type: regex
    pattern: 'Task\([^)]*description[^)]*\)'
    negative_pattern: 'expected_output'
    message: "Task without expected_output leads to inconsistent results."
    fix_action: "Add expected_output describing the deliverable format"
    applies_to:
      - "*.py"

  - id: task-missing-context
    name: Sequential Tasks Without Context
    severity: medium
    type: regex
    pattern: 'Task\([^)]*\)\s*\n\s*Task\('
    negative_pattern: 'context\s*='
    message: "Sequential tasks may need context to pass outputs."
    fix_action: "Add context=[previous_task] to chain task outputs"
    applies_to:
      - "*.py"

  - id: crew-no-process
    name: Crew Without Explicit Process
    severity: low
    type: regex
    pattern: 'Crew\([^)]*\)'
    negative_pattern: 'process\s*='
    message: "Crew without explicit process uses default. Be intentional."
    fix_action: "Add process=Process.sequential or Process.hierarchical"
    applies_to:
      - "*.py"

  - id: hierarchical-no-manager
    name: Hierarchical Without Manager LLM
    severity: high
    type: regex
    pattern: 'Process\.hierarchical'
    negative_pattern: 'manager_llm'
    message: "Hierarchical process requires manager_llm."
    fix_action: "Add manager_llm=ChatOpenAI(...) to Crew"
    applies_to:
      - "*.py"

  - id: vague-agent-role
    name: Vague Agent Role
    severity: low
    type: regex
    pattern: 'role\s*=\s*["\'](?:Agent|Assistant|Helper|Worker)["\']'
    message: "Agent role is too generic. Be specific about expertise."
    fix_action: "Use specific role like 'Senior Python Developer' or 'Market Research Analyst'"
    applies_to:
      - "*.py"
      - "*.yaml"

  - id: no-max-iterations
    name: Agent Without Iteration Limit
    severity: medium
    type: regex
    pattern: 'Agent\([^)]*\)'
    negative_pattern: 'max_iter|max_iterations'
    message: "Agent without max_iter may loop excessively."
    fix_action: "Add max_iter=15 or appropriate limit"
    applies_to:
      - "*.py"

  - id: yaml-key-mismatch
    name: YAML Config Key Style
    severity: low
    type: regex
    pattern: '^\s+[A-Z][a-zA-Z]+:'
    message: "YAML keys should be snake_case, not PascalCase."
    fix_action: "Use researcher: not Researcher:"
    applies_to:
      - "config/agents.yaml"
      - "config/tasks.yaml"
