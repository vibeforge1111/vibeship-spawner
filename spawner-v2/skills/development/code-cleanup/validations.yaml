# Code Cleanup Validations
# Automated checks to catch dead code and cleanup anti-patterns

validations:
  - id: cleanup-unused-imports
    name: Unused Imports
    severity: warning
    type: regex
    pattern:
      - "import\\s+\\{[^}]+\\}\\s+from\\s+['\"][^'\"]+['\"];?(?!.*\\n.*\\b\\w+\\b)"
    message: "Potentially unused import. Remove or use the imported module."
    fix_action: "Remove unused imports or use them in code"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
      - "**/*.js"
      - "**/*.jsx"

  - id: cleanup-commented-code
    name: Commented Out Code Blocks
    severity: warning
    type: regex
    pattern:
      - "//\\s*(const|let|var|function|class|if|for|while|return)\\s+\\w+"
      - "/\\*[\\s\\S]{50,}?(function|class|const|let|var)[\\s\\S]*?\\*/"
    message: "Large block of commented code detected. Remove or document why it's kept."
    fix_action: "Delete commented code - use git history for recovery"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.tsx"
      - "**/*.jsx"

  - id: cleanup-console-log
    name: Console.log in Production Code
    severity: warning
    type: regex
    pattern:
      - "console\\.log\\("
      - "console\\.debug\\("
      - "console\\.info\\("
    message: "Console statement in production code. Remove or replace with proper logger."
    fix_action: "Remove or replace with logger.debug(...)"
    applies_to:
      - "src/**/*.ts"
      - "src/**/*.js"
      - "app/**/*.tsx"
      - "app/**/*.jsx"

  - id: cleanup-todo-without-ticket
    name: TODO Without Ticket Reference
    severity: info
    type: regex
    pattern:
      - "//\\s*TODO(?!.*#\\d+|.*JIRA-|.*[A-Z]+-\\d+|.*http)"
      - "//\\s*FIXME(?!.*#\\d+|.*JIRA-|.*[A-Z]+-\\d+)"
      - "//\\s*HACK(?!.*#\\d+|.*JIRA-|.*[A-Z]+-\\d+)"
    message: "TODO/FIXME/HACK without tracking ticket. Add ticket reference or fix it."
    fix_action: "Add ticket: // TODO: JIRA-123 - description or fix immediately"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.tsx"
      - "**/*.jsx"

  - id: cleanup-unused-function
    name: Potentially Unused Function
    severity: info
    type: regex
    pattern:
      - "(?:function|const)\\s+(\\w+)(?!.*export)(?!.*\\b\\1\\b.*\\()"
    message: "Function defined but not exported or used. Remove if truly unused."
    fix_action: "Remove unused function or export if needed elsewhere"
    applies_to:
      - "**/*.ts"
      - "**/*.js"

  - id: cleanup-empty-file
    name: Empty or Near-Empty File
    severity: warning
    type: file_size
    max_lines: 5
    message: "File has fewer than 5 lines. Remove if unused."
    fix_action: "Delete empty/placeholder files"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.tsx"
      - "**/*.jsx"

  - id: cleanup-duplicate-type
    name: Duplicate Type Definition
    severity: warning
    type: regex
    pattern:
      - "type\\s+(\\w+)\\s*=.*\\n[\\s\\S]{0,500}type\\s+\\1\\s*="
      - "interface\\s+(\\w+)\\s*\\{[\\s\\S]{0,500}interface\\s+\\1\\s*\\{"
    message: "Duplicate type or interface definition detected."
    fix_action: "Consolidate into single definition or rename if different"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"

  - id: cleanup-test-skip
    name: Skipped Tests
    severity: warning
    type: regex
    pattern:
      - "it\\.skip\\("
      - "test\\.skip\\("
      - "describe\\.skip\\("
      - "xit\\("
      - "xdescribe\\("
    message: "Skipped test found. Fix and unskip or remove if obsolete."
    fix_action: "Fix test or remove: it('test name', () => { ... })"
    applies_to:
      - "**/*.test.ts"
      - "**/*.test.js"
      - "**/*.spec.ts"
      - "**/*.spec.js"

  - id: cleanup-debugger-statement
    name: Debugger Statement
    severity: error
    type: regex
    pattern:
      - "\\bdebugger;?"
    message: "Debugger statement must be removed before commit."
    fix_action: "Remove debugger statement"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.tsx"
      - "**/*.jsx"

  - id: cleanup-old-api-comment
    name: Outdated API Comments
    severity: info
    type: regex
    pattern:
      - "//.*deprecated"
      - "//.*old version"
      - "/\\*.*TODO.*v[0-9]+.*\\*/"
      - "//.*legacy"
    message: "Comment references deprecated/old code. Update or remove."
    fix_action: "Update comment or remove if code is updated"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.tsx"
      - "**/*.jsx"

  - id: cleanup-unused-css
    name: Empty CSS Rules
    severity: info
    type: regex
    pattern:
      - "\\.[a-zA-Z_-]+\\s*\\{\\s*\\}"
      - "#[a-zA-Z_-]+\\s*\\{\\s*\\}"
    message: "Empty CSS rule detected. Remove unused styles."
    fix_action: "Delete empty CSS rules"
    applies_to:
      - "**/*.css"
      - "**/*.scss"
      - "**/*.sass"

  - id: cleanup-large-commented-block
    name: Large Commented Block
    severity: warning
    type: regex
    pattern:
      - "/\\*[\\s\\S]{200,}?\\*/"
    message: "Large commented block (200+ chars). Remove or move to docs."
    fix_action: "Delete or move explanation to docs/README"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.tsx"
      - "**/*.jsx"
