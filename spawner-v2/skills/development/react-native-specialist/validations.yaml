# React Native Specialist Validations
# Automated checks for React Native patterns

validations:
  - id: inline-style-object
    name: Inline Style Object
    severity: warning
    type: regex
    pattern:
      - 'style=\{\{'
      - 'style=\{[^}]+\}\s*>'
    message: "Inline style objects create new objects every render."
    fix_action: "Use StyleSheet.create() or memoize dynamic styles"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"

  - id: console-log-production
    name: Console.log in Production Code
    severity: warning
    type: regex
    pattern:
      - 'console\.log\('
      - 'console\.warn\('
      - 'console\.error\('
    message: "Console statements impact performance in production."
    fix_action: "Remove or use babel-plugin-transform-remove-console"
    applies_to:
      - "**/src/**/*.ts"
      - "**/src/**/*.tsx"
    excludes:
      - "**/__tests__/**"
      - "**/test/**"

  - id: missing-key-prop
    name: Missing Key Prop in List
    severity: error
    type: regex
    pattern:
      - '\.map\([^)]+\)\s*=>\s*<(?!.*key=)'
    message: "List items missing key prop causes performance issues."
    fix_action: "Add unique key prop to list items"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"

  - id: async-storage-large-data
    name: Large Data in AsyncStorage
    severity: info
    type: regex
    pattern:
      - 'AsyncStorage\.setItem.*JSON\.stringify'
    message: "AsyncStorage has size limits and is slow for large data."
    fix_action: "Use MMKV or SQLite for large/complex data"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"

  - id: animated-in-render
    name: Animated Value Created in Render
    severity: error
    type: regex
    pattern:
      - 'new Animated\.Value\('
      - 'useRef\(new Animated\.Value'
    message: "Creating Animated.Value in render causes issues."
    fix_action: "Use useAnimatedValue() or create outside component"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"

  - id: missing-cleanup
    name: Event Listener Without Cleanup
    severity: error
    type: regex
    pattern:
      - 'addListener\([^)]+\)(?!.*remove)'
      - 'addEventListener\([^)]+\)(?!.*removeEventListener)'
    message: "Event listener without cleanup causes memory leaks."
    fix_action: "Return cleanup function from useEffect"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"

  - id: flatlist-without-keyextractor
    name: FlatList Without keyExtractor
    severity: warning
    type: regex
    pattern:
      - '<FlatList(?!.*keyExtractor)'
      - '<FlashList(?!.*keyExtractor)'
    message: "List without keyExtractor uses index, causing issues."
    fix_action: "Add keyExtractor prop with unique identifier"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"

  - id: sync-io-in-component
    name: Synchronous I/O in Component
    severity: warning
    type: regex
    pattern:
      - 'require\([^)]+\.json\)'
      - 'fs\.readFileSync'
    message: "Synchronous I/O blocks JS thread."
    fix_action: "Use async loading with proper loading states"
    applies_to:
      - "**/components/**/*.tsx"
      - "**/screens/**/*.tsx"

  - id: platform-specific-missing
    name: Platform-Specific Style Missing
    severity: info
    type: regex
    pattern:
      - 'shadowColor(?!.*Platform)'
      - 'elevation(?!.*Platform)'
    message: "Shadow/elevation without Platform check may not work cross-platform."
    fix_action: "Use Platform.select() for shadow/elevation"
    applies_to:
      - "**/*.tsx"
      - "**/*.ts"

  - id: hermes-incompatible
    name: Hermes Incompatible Code
    severity: warning
    type: regex
    pattern:
      - 'with\s*\('
      - 'eval\s*\('
    message: "Code pattern not supported by Hermes engine."
    fix_action: "Remove with/eval for Hermes compatibility"
    applies_to:
      - "**/*.js"
      - "**/*.ts"

  - id: navigation-no-type
    name: Navigation Without TypeScript
    severity: info
    type: regex
    pattern:
      - 'useNavigation\(\)(?!.*<)'
      - 'navigation\.navigate\('
    message: "Untyped navigation is error-prone."
    fix_action: "Type navigation with RootStackParamList"
    applies_to:
      - "**/*.tsx"

  - id: image-no-cache
    name: Network Image Without Caching
    severity: info
    type: regex
    pattern:
      - '<Image.*source=\{\{.*uri:'
    message: "Built-in Image doesn't cache well. Consider FastImage."
    fix_action: "Use react-native-fast-image for better caching"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"
