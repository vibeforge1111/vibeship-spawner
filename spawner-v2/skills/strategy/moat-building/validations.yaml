# Moat Building Validations
# Checks for patterns related to competitive advantage

validations:
  - id: missing-viral-hooks
    name: Social Feature Without Sharing
    severity: info
    type: regex
    pattern:
      - "social|Social|community|Community"
      - "collaboration|Collaboration"
      - "team|Team|workspace"
    message: "Social/collaborative feature found. Consider adding sharing and invite mechanics."
    fix_action: "Add invite flows, sharing buttons, and viral loops to collaborative features"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"
    exceptions:
      - "share|Share|invite|Invite|referral"

  - id: no-data-persistence
    name: User Action Without Data Capture
    severity: info
    type: regex
    pattern:
      - "onClick|onSubmit|handleClick"
      - "user.*action"
    message: "User action handler without visible analytics/data capture."
    fix_action: "Ensure valuable user actions are logged for future ML/personalization"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"
    exceptions:
      - "track|log|analytics|capture"

  - id: exportable-data-format
    name: Proprietary Format Without Export
    severity: warning
    type: regex
    pattern:
      - "proprietary.*format"
      - "custom.*format"
      - "\\.myapp|\\.internal"
    message: "Proprietary format detected. Ensure ethical export option exists."
    fix_action: "Provide standard format export (CSV, JSON, etc.) alongside proprietary"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
      - "**/*.js"

  - id: no-integration-api
    name: Product Without Integration Points
    severity: info
    type: regex
    pattern:
      - "export default.*App"
      - "createRoot|render\\("
    message: "Main app without visible API/integration layer. Consider for switching costs."
    fix_action: "Add webhook, API, or integration capabilities for deeper customer embedding"
    applies_to:
      - "**/App.tsx"
      - "**/index.tsx"
      - "**/main.tsx"
    exceptions:
      - "api|API|webhook|integration"

  - id: single-user-only
    name: Single-User Focus Without Team Features
    severity: info
    type: regex
    pattern:
      - "user\\s*=|currentUser|getUser"
    message: "Single-user patterns found. Consider team/org features for network effects."
    fix_action: "Plan team features: shared workspaces, permissions, collaboration"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "team|org|organization|member|workspace"

  - id: no-referral-system
    name: User Signup Without Referral Tracking
    severity: info
    type: regex
    pattern:
      - "signup|signUp|register|createUser"
    message: "User signup without referral tracking. Missing viral loop opportunity."
    fix_action: "Add referral code tracking and attribution for viral growth"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "referral|refer|invite|attribution"

  - id: no-usage-history
    name: Feature Without Usage History
    severity: info
    type: regex
    pattern:
      - "save|Save|create|Create|submit|Submit"
    message: "Create/save action without history accumulation."
    fix_action: "Store user history/activity for personalization and switching cost depth"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "history|log|activity|audit"

  - id: no-personalization
    name: Content Display Without Personalization
    severity: info
    type: regex
    pattern:
      - "getAll|findAll|listAll"
      - "fetch.*all"
    message: "Generic content fetch without personalization. Data moat opportunity."
    fix_action: "Add user preference/behavior-based personalization for data network effects"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "recommend|personalize|preference|score"

  - id: missing-platform-hooks
    name: Core Feature Without Extension Points
    severity: info
    type: regex
    pattern:
      - "export.*function|export.*const"
      - "class.*export"
    message: "Core functionality without extension points. Platform moat opportunity."
    fix_action: "Consider plugin architecture, webhooks, or API for platform network effects"
    applies_to:
      - "**/core/**/*.ts"
      - "**/lib/**/*.ts"
    exceptions:
      - "plugin|hook|extension|middleware"

  - id: easy-migration-pattern
    name: Standard Format Without Lock-in
    severity: info
    type: regex
    pattern:
      - "import.*csv|export.*csv"
      - "import.*json|export.*json"
      - "standard.*format"
    message: "Standard format usage. Good for ethics, consider proprietary value-add layer."
    fix_action: "Balance: Standard format export + proprietary features/integrations"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"

  - id: no-community-features
    name: User-Generated Content Without Community
    severity: info
    type: regex
    pattern:
      - "upload|post|publish|share"
      - "content.*create"
    message: "User content creation without community features."
    fix_action: "Add comments, likes, follows, or reputation for social network effects"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"
    exceptions:
      - "comment|like|follow|community|social"

  - id: no-embedded-workflows
    name: Utility Without Workflow Integration
    severity: info
    type: regex
    pattern:
      - "utility|tool|helper"
      - "standalone.*app"
    message: "Standalone utility pattern. Consider workflow embedding for switching costs."
    fix_action: "Integrate into customer workflows via integrations, plugins, or APIs"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "workflow|integrate|embed|plugin"

  - id: competitive-analysis-missing
    name: Feature Launch Without Competitive Context
    severity: info
    type: regex
    pattern:
      - "launchFeature|releaseFeature|newFeature"
      - "feature.*flag"
    message: "Feature launch detected. Ensure competitive moat assessment."
    fix_action: "Document how this feature affects competitive positioning and moat strength"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
      - "**/feature*"
