# Hiring Strategy Validations
# Checks for patterns related to team building and employee systems

validations:
  - id: no-role-based-access
    name: User System Without Role Definitions
    severity: warning
    type: regex
    pattern:
      - "createUser|addUser|newUser"
      - "userRole|role.*user"
    message: "User creation without role-based access control."
    fix_action: "Implement role-based permissions for team-based products"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "role|Role|admin|Admin|member|permission"

  - id: no-invitation-system
    name: Team Product Without Invite System
    severity: info
    type: regex
    pattern:
      - "team|Team|workspace|Workspace"
      - "organization|Organization"
    message: "Team/org feature without visible invitation system."
    fix_action: "Add invite flow for team growth and PLG expansion"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"
    exceptions:
      - "invite|Invite|invitation|addMember"

  - id: no-onboarding-flow
    name: User Creation Without Onboarding
    severity: info
    type: regex
    pattern:
      - "signup|signUp|register|createAccount"
    message: "User signup without onboarding flow."
    fix_action: "Add onboarding for activation and time-to-value"
    applies_to:
      - "**/*.tsx"
      - "**/*.jsx"
    exceptions:
      - "onboarding|Onboarding|welcome|Welcome|getStarted"

  - id: hardcoded-team-limits
    name: Hardcoded Team Size Limits
    severity: warning
    type: regex
    pattern:
      - "maxUsers.*=.*\\d+"
      - "teamLimit.*=.*\\d+"
      - "seatLimit.*=.*\\d+"
    message: "Hardcoded team limits. Consider configuration-based limits."
    fix_action: "Move team limits to configuration for pricing flexibility"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "config|Config|env|ENV|process\\.env"

  - id: no-seat-tracking
    name: Team Feature Without Seat Tracking
    severity: info
    type: regex
    pattern:
      - "addMember|inviteMember|joinTeam"
    message: "Team membership without seat tracking for billing."
    fix_action: "Track seat count for usage-based or per-seat billing"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "seat|Seat|billing|Billing|subscription"

  - id: no-permission-check
    name: Action Without Permission Check
    severity: warning
    type: regex
    pattern:
      - "delete|Delete|remove|Remove"
      - "update|Update|edit|Edit"
    message: "Destructive action without visible permission check."
    fix_action: "Add permission verification before destructive operations"
    applies_to:
      - "**/api/**/*.ts"
      - "**/routes/**/*.ts"
    exceptions:
      - "permission|authorize|canDelete|isAdmin|hasAccess"

  - id: no-audit-trail
    name: Admin Action Without Audit Log
    severity: info
    type: regex
    pattern:
      - "admin|Admin|superuser"
      - "changeRole|updatePermission"
    message: "Admin action without audit logging."
    fix_action: "Log admin actions for security and compliance"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "audit|log|track|record|history"

  - id: no-email-notifications
    name: Team Event Without Notification
    severity: info
    type: regex
    pattern:
      - "inviteMember|addToTeam|removeFromTeam"
      - "roleChange|permissionUpdate"
    message: "Team change without email notification."
    fix_action: "Send notifications for team membership changes"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "email|notify|notification|sendEmail"

  - id: no-offboarding
    name: Remove User Without Offboarding
    severity: warning
    type: regex
    pattern:
      - "removeUser|deleteUser|deactivateUser"
      - "removeMember|leaveTeam"
    message: "User removal without data handling."
    fix_action: "Handle user data properly on removal (transfer, archive)"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "transfer|archive|reassign|offboard"

  - id: no-sso-support
    name: Enterprise Feature Without SSO
    severity: info
    type: regex
    pattern:
      - "enterprise|Enterprise|organization|Organization"
    message: "Enterprise feature without visible SSO support."
    fix_action: "Plan SSO (SAML/OIDC) for enterprise readiness"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "sso|SSO|saml|SAML|oidc|OIDC"

  - id: no-activity-tracking
    name: User Actions Without Activity Log
    severity: info
    type: regex
    pattern:
      - "create|update|delete"
      - "submit|save|publish"
    message: "User action without activity tracking."
    fix_action: "Track user activity for engagement analysis"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "activity|track|log|analytics|event"

  - id: no-welcome-email
    name: Signup Without Welcome Email
    severity: info
    type: regex
    pattern:
      - "signup|signUp|register|createUser"
    message: "User signup without welcome email."
    fix_action: "Send welcome email to improve activation"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "welcome|sendEmail|notification|email"

  - id: no-trial-management
    name: Team Trial Without Management
    severity: info
    type: regex
    pattern:
      - "trial|Trial|freeTrial"
      - "trialStart|startTrial"
    message: "Trial start without expiration management."
    fix_action: "Track and manage trial expiration and conversion"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
    exceptions:
      - "expir|end|convert|upgrade"
