# Technical Writer Validations
# Checks for documentation quality patterns

validations:
  - id: todo-in-docs
    name: TODO in Documentation
    severity: warning
    type: regex
    pattern:
      - "TODO"
      - "FIXME"
      - "TBD"
      - "WIP"
      - "\\[TODO\\]"
      - "\\[TBD\\]"
    message: "Incomplete documentation shipped. Finish or remove the TODO."
    fix_action: "Complete the section or remove placeholder before publishing"
    applies_to:
      - "**/README.md"
      - "**/docs/**/*.md"
      - "**/*.mdx"

  - id: broken-link-pattern
    name: Potentially Broken Link
    severity: info
    type: regex
    pattern:
      - "\\]\\(\\s*\\)"
      - "\\]\\(#\\)"
      - "\\]\\(http://localhost"
      - "\\]\\(\\.\\./\\.\\./\\.\\./\\.\\."
    message: "Link appears broken or temporary. Verify link destination."
    fix_action: "Replace with actual URL or remove the link"
    applies_to:
      - "**/*.md"
      - "**/*.mdx"

  - id: outdated-version-reference
    name: Hardcoded Version Number
    severity: info
    type: regex
    pattern:
      - "v[0-9]+\\.[0-9]+\\.[0-9]+"
      - "version [0-9]+\\.[0-9]+"
      - "@[0-9]+\\.[0-9]+\\.[0-9]+"
    message: "Hardcoded version in docs. May become outdated. Consider dynamic reference."
    fix_action: "Use version variable or clearly mark which version docs apply to"
    applies_to:
      - "**/README.md"
      - "**/docs/**/*.md"

  - id: no-code-example
    name: API Endpoint Without Example
    severity: warning
    type: regex
    pattern:
      - "## (POST|GET|PUT|DELETE|PATCH)\\s+/[^\\n]+\\n\\n(?!.*```)"
      - "### Endpoint\\n\\n[^`]+\\n\\n(?!.*```)"
    message: "API endpoint documented without code example. Add working example."
    fix_action: "Add curl/code example showing actual usage with expected response"
    applies_to:
      - "**/docs/**/*.md"
      - "**/api/**/*.md"

  - id: placeholder-text
    name: Placeholder Text
    severity: error
    type: regex
    pattern:
      - "lorem ipsum"
      - "foo bar baz"
      - "example\\.com(?!/)"
      - "your-.*-here"
      - "REPLACE_ME"
      - "INSERT_.*_HERE"
    message: "Placeholder text in documentation. Replace with real content."
    fix_action: "Replace placeholders with actual values or realistic examples"
    applies_to:
      - "**/*.md"
      - "**/*.mdx"
    exceptions:
      - "example\\.com/[a-z]"

  - id: missing-prerequisites
    name: Tutorial Without Prerequisites
    severity: info
    type: regex
    pattern:
      - "# Getting Started\\n\\n(?!.*Prerequisites|.*Requirements|.*Before)"
      - "## Quick Start\\n\\n(?!.*need|.*require|.*install)"
    message: "Tutorial may be missing prerequisites section."
    fix_action: "Add Prerequisites section listing required tools, accounts, knowledge"
    applies_to:
      - "**/README.md"
      - "**/docs/**/getting-started.md"
      - "**/docs/**/quickstart.md"

  - id: jsdoc-no-example
    name: Public Function Without Example
    severity: info
    type: regex
    pattern:
      - "/\\*\\*[^*]*@public[^*]*\\*/\\s*(?!.*@example)"
      - "/\\*\\*[^*]*@export[^*]*\\*/\\s*(?!.*@example)"
    message: "Public/exported function without @example in JSDoc."
    fix_action: "Add @example showing typical usage"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
    exceptions:
      - "@example"

  - id: comment-what-not-why
    name: Comment Explaining What Instead of Why
    severity: info
    type: regex
    pattern:
      - "// (loop|iterate|check|get|set|return|call|create|add|remove|delete)s? (the|a|an)? \\w+"
      - "// (increment|decrement|initialize|update|fetch) "
    message: "Comment explains what code does (visible in code). Consider explaining why."
    fix_action: "Either remove comment or change to explain why/context"
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
      - "**/*.js"
      - "**/*.jsx"

  - id: readme-no-quickstart
    name: README Without Quick Start
    severity: warning
    type: regex
    pattern:
      - "^(?!.*Quick Start|.*Getting Started|.*Installation|.*Usage)"
    message: "README may be missing quick start section."
    fix_action: "Add Quick Start section showing minimal working example"
    applies_to:
      - "**/README.md"
    exceptions:
      - "Getting Started|Quick Start|Installation|Usage"

  - id: marketing-in-docs
    name: Marketing Language in Technical Docs
    severity: info
    type: regex
    pattern:
      - "best-in-class"
      - "world-class"
      - "cutting-edge"
      - "revolutionary"
      - "game-changing"
      - "seamless"
      - "powerful and flexible"
      - "unlike the competition"
    message: "Marketing language in technical docs. Keep docs factual and practical."
    fix_action: "Remove marketing language. Focus on what it does and how to use it."
    applies_to:
      - "**/docs/**/*.md"
      - "**/api/**/*.md"

  - id: dead-link-indicator
    name: Potential Dead Link
    severity: warning
    type: regex
    pattern:
      - "\\]\\(.*\\.(html|htm)\\)"
      - "\\]\\(https?://[^)]+/wiki/[^)]+\\)"
      - "\\]\\([^)]*github\\.com[^)]*blob/[^)]+\\)"
    message: "External link that may break over time. Consider archiving or removing."
    fix_action: "Verify link works. For critical docs, consider web.archive.org backup"
    applies_to:
      - "**/*.md"

  - id: screenshot-reference
    name: Screenshot That May Need Updates
    severity: info
    type: regex
    pattern:
      - "!\\[.*\\]\\(.*screenshot.*\\)"
      - "!\\[.*\\]\\(.*\\.png\\)"
      - "!\\[.*\\]\\(.*\\.gif\\)"
      - "<img.*src=.*screenshot"
    message: "Documentation contains screenshots which may become outdated."
    fix_action: "Ensure screenshots are current. Consider if text description would suffice."
    applies_to:
      - "**/*.md"
      - "**/*.mdx"

  - id: undocumented-env-var
    name: Environment Variable Without Documentation
    severity: warning
    type: regex
    pattern:
      - "process\\.env\\.[A-Z_]+(?!.*//.*description)"
      - "Deno\\.env\\.get\\(['\"][A-Z_]+['\"]\\)"
    message: "Environment variable used without nearby documentation."
    fix_action: "Document env vars in .env.example or README with description"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
    exceptions:
      - "NODE_ENV|PATH|HOME|PWD"

  - id: stale-comment-date
    name: Dated Comment That May Be Stale
    severity: info
    type: regex
    pattern:
      - "// (TODO|FIXME|HACK).*20[0-2][0-9]"
      - "# (TODO|FIXME|HACK).*20[0-2][0-9]"
      - "<!-- .*20[0-2][0-2].*-->"
    message: "Comment with date that may indicate stale content."
    fix_action: "Review if this is still relevant. Fix or remove."
    applies_to:
      - "**/*.ts"
      - "**/*.tsx"
      - "**/*.js"
      - "**/*.jsx"
      - "**/*.md"

  - id: deprecated-no-alternative
    name: Deprecated Without Alternative
    severity: warning
    type: regex
    pattern:
      - "@deprecated(?!.*use|.*see|.*replaced|.*instead)"
      - "DEPRECATED(?!.*use|.*see|.*replaced|.*instead)"
    message: "Marked as deprecated but doesn't suggest alternative."
    fix_action: "Add 'Use X instead' or link to migration guide"
    applies_to:
      - "**/*.ts"
      - "**/*.js"
      - "**/*.md"

  - id: readme-no-license
    name: README Without License Reference
    severity: info
    type: regex
    pattern:
      - "^(?!.*LICENSE|.*license|.*MIT|.*Apache|.*GPL)"
    message: "README may be missing license information."
    fix_action: "Add License section or link to LICENSE file"
    applies_to:
      - "**/README.md"
    exceptions:
      - "LICENSE|license|MIT|Apache|GPL|BSD"

  - id: error-doc-no-solution
    name: Error Documentation Without Solution
    severity: warning
    type: regex
    pattern:
      - "## Error:.*\\n\\n(?!.*fix|.*solution|.*resolve|.*cause)"
      - "### .*Error\\n\\n(?!.*fix|.*solution|.*resolve|.*cause)"
    message: "Error documented without fix or explanation."
    fix_action: "Add Cause and Fix sections to error documentation"
    applies_to:
      - "**/docs/**/*.md"
      - "**/TROUBLESHOOTING.md"
