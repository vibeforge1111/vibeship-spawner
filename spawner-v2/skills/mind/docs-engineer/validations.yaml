# Documentation Engineer Validations
# Automated checks for documentation quality

validations:
  - id: missing-readme
    name: Project Without README
    severity: error
    type: regex
    pattern:
      - 'setup\.py(?!.*README)'
      - 'package\.json(?!.*README)'
    message: "Project missing README file."
    fix_action: "Add README.md with quick start and basic usage"
    applies_to:
      - "**/setup.py"
      - "**/package.json"

  - id: readme-no-installation
    name: README Without Installation Instructions
    severity: warning
    type: regex
    pattern:
      - 'README\.md(?!.*install|.*pip|.*npm)'
    message: "README missing installation instructions."
    fix_action: "Add ## Installation section with install command"
    applies_to:
      - "**/README.md"

  - id: hardcoded-secret-in-docs
    name: Hardcoded Secret in Documentation
    severity: error
    type: regex
    pattern:
      - 'api_key\s*=\s*["\']sk-[^"\']+["\']'
      - 'password\s*=\s*["\'][^"\']{8,}["\']'
      - 'token\s*=\s*["\'][A-Za-z0-9]{20,}["\']'
    message: "Documentation contains what looks like a real secret."
    fix_action: "Use placeholder or env var: api_key = os.environ['API_KEY']"
    applies_to:
      - "**/*.md"
      - "**/docs/**/*"

  - id: dead-link-reference
    name: Reference to Non-Existent File
    severity: warning
    type: regex
    pattern:
      - '\[.*\]\(\./[^)]+\.md\)'
      - '\[.*\]\(\.\./[^)]+\.md\)'
    message: "Markdown link to relative file. Verify file exists."
    fix_action: "Check that linked file exists, or use absolute URL"
    applies_to:
      - "**/*.md"

  - id: no-code-example
    name: API Documentation Without Code Example
    severity: info
    type: regex
    pattern:
      - '## API(?!.*```)'
      - '### Method(?!.*```)'
      - '## Usage(?!.*```)'
    message: "API documentation section without code example."
    fix_action: "Add code example showing usage"
    applies_to:
      - "**/*.md"
      - "**/docs/**/*"

  - id: outdated-version-reference
    name: Reference to Old Version
    severity: info
    type: regex
    pattern:
      - 'v[0-9]+\.[0-9]+\.[0-9]+(?!.*current|.*latest)'
      - 'version [0-9]+\.[0-9]+\.[0-9]+'
    message: "Version number in docs. May become outdated."
    fix_action: "Use 'current version' or automate version replacement"
    applies_to:
      - "**/*.md"

  - id: todo-in-docs
    name: TODO in Published Documentation
    severity: warning
    type: regex
    pattern:
      - 'TODO:'
      - 'FIXME:'
      - '\[WIP\]'
      - 'Coming soon'
    message: "Incomplete section in documentation."
    fix_action: "Complete the section or remove placeholder"
    applies_to:
      - "**/*.md"
      - "**/docs/**/*"

  - id: long-paragraph
    name: Very Long Paragraph Without Break
    severity: info
    type: regex
    pattern:
      - '[^\n]{500,}'
    message: "Very long paragraph. Consider breaking up for readability."
    fix_action: "Split into shorter paragraphs or use bullet points"
    applies_to:
      - "**/*.md"

  - id: no-heading-structure
    name: Documentation Without Headings
    severity: info
    type: regex
    pattern:
      - '^(?!#).*\n(?!#).*\n(?!#).*\n(?!#).*\n(?!#).*\n(?!#).*\n(?!#).*'
    message: "Large section without headings. Add structure."
    fix_action: "Add section headings for better navigation"
    applies_to:
      - "**/*.md"

  - id: broken-code-block
    name: Unclosed Code Block
    severity: error
    type: regex
    pattern:
      - '```[^`]*$'
      - '```\w+[^`]*```[^`]*```'
    message: "Code block may not be properly closed."
    fix_action: "Ensure all code blocks have opening and closing ```"
    applies_to:
      - "**/*.md"

  - id: missing-changelog
    name: Project Without Changelog
    severity: info
    type: regex
    pattern:
      - 'version.*bump(?!.*CHANGELOG|.*changelog)'
    message: "Version change without changelog update."
    fix_action: "Add CHANGELOG.md entry for version changes"
    applies_to:
      - "**/*.py"
      - "**/package.json"

  - id: undocumented-public-api
    name: Public Function Without Documentation
    severity: warning
    type: regex
    pattern:
      - 'def [a-z][^_].*\):\s*\n\s+[^"\']'
      - 'export function [a-z].*\{(?!.*\*|.*//)'
    message: "Public function without docstring or comment."
    fix_action: "Add documentation explaining purpose and usage"
    applies_to:
      - "**/*.py"
      - "**/*.ts"
