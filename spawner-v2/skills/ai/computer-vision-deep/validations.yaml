validations:

  - id: no-pretrained-backbone
    name: Vision Model Without Pretrained Weights
    severity: warning
    type: regex
    pattern:
      - "pretrained\\s*=\\s*False"
      - "from_pretrained\\s*=\\s*False"
      - "weights\\s*=\\s*None"
    message: "Training vision models from scratch is rarely optimal. Use pretrained weights."
    fix_action: "Use: pretrained=True or weights='imagenet'"
    applies_to:
      - "**/*.py"

  - id: no-augmentation
    name: Image Training Without Augmentation
    severity: warning
    type: regex
    pattern:
      - "DataLoader\\((?!.*transform|.*augment)"
      - "train_dataset(?!.*transform|.*augment)"
    message: "Data augmentation significantly improves vision model generalization."
    fix_action: "Add augmentation transforms to training data"
    applies_to:
      - "**/*train*.py"

  - id: low-resolution-detection
    name: Object Detection at Low Resolution
    severity: info
    type: regex
    pattern:
      - "imgsz\\s*=\\s*320"
      - "imgsz\\s*=\\s*416"
      - "input_size\\s*=\\s*[23]\\d{2}"
    message: "Low input resolution may miss small objects. Consider 640+ for better detection."
    fix_action: "Use: imgsz=640 or higher for small object detection"
    applies_to:
      - "**/*.py"

  - id: missing-normalize
    name: Image Input Without Normalization
    severity: warning
    type: regex
    pattern:
      - "ToTensor\\(\\)(?!.*Normalize)"
      - "transforms\\.Compose\\(\\[(?!.*Normalize)"
    message: "Most vision models expect normalized input (ImageNet mean/std)."
    fix_action: "Add: transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])"
    applies_to:
      - "**/*.py"

  - id: sam-no-set-image
    name: SAM Prediction Without set_image
    severity: error
    type: regex
    pattern:
      - "predictor\\.predict\\((?!.*set_image)"
      - "SamPredictor.*predict(?!.*set_image)"
    message: "Call predictor.set_image() before predict() for SAM."
    fix_action: "Add: predictor.set_image(image) before predictions"
    applies_to:
      - "**/*.py"

  - id: no-bbox-format
    name: Bounding Box Format Not Specified
    severity: info
    type: regex
    pattern:
      - "BboxParams\\((?!.*format)"
      - "bbox_params\\s*=(?!.*format)"
    message: "Specify bbox format (yolo, pascal_voc, coco) for consistent augmentation."
    fix_action: "Add: format='yolo' or 'pascal_voc' or 'coco'"
    applies_to:
      - "**/*.py"

  - id: video-no-persist
    name: Object Tracking Without Persistence
    severity: warning
    type: regex
    pattern:
      - "\\.track\\((?!.*persist)"
    message: "Enable persist=True for consistent track IDs across frames."
    fix_action: "Add: persist=True in track() call"
    applies_to:
      - "**/*.py"
