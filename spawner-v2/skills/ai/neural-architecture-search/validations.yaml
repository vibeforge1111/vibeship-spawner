validations:

  - id: no-compute-budget
    name: NAS Without Compute Budget
    severity: warning
    type: regex
    pattern:
      - "optimize\\(.*n_trials\\s*=\\s*None"
      - "study\\.optimize(?!.*n_trials|.*timeout)"
    message: "Set compute budget for NAS to prevent runaway resource usage."
    fix_action: "Add: n_trials=100 or timeout=3600"
    applies_to:
      - "**/*.py"

  - id: no-seed-setting
    name: NAS Without Seed Setting
    severity: warning
    type: regex
    pattern:
      - "optuna\\.create_study(?!.*seed)"
      - "random\\.choice(?!.*seed|.*random\\.seed)"
    message: "Set random seeds for reproducible NAS results."
    fix_action: "Add: sampler=optuna.samplers.TPESampler(seed=42)"
    applies_to:
      - "**/*search*.py"
      - "**/*nas*.py"

  - id: no-pruning
    name: NAS Without Early Stopping/Pruning
    severity: info
    type: regex
    pattern:
      - "create_study(?!.*pruner)"
    message: "Enable pruning to stop unpromising trials early."
    fix_action: "Add: pruner=optuna.pruners.MedianPruner()"
    applies_to:
      - "**/*optuna*.py"

  - id: no-experiment-tracking
    name: NAS Without Experiment Tracking
    severity: info
    type: regex
    pattern:
      - "create_study(?!.*storage|.*study_name)"
    message: "Use persistent storage for NAS experiment tracking."
    fix_action: "Add: storage='sqlite:///optuna.db', study_name='experiment'"
    applies_to:
      - "**/*optuna*.py"

  - id: unbounded-search-space
    name: Unbounded Search Space Parameters
    severity: warning
    type: regex
    pattern:
      - "suggest_int.*1,\\s*1000"
      - "suggest_float.*1e-10,\\s*1e10"
      - "suggest_int.*0,\\s*\\d{4,}"
    message: "Very large search ranges may be intractable. Consider constraining."
    fix_action: "Narrow range based on domain knowledge or prior results."
    applies_to:
      - "**/*.py"

  - id: no-validation-check
    name: NAS Without Full Task Validation
    severity: info
    type: regex
    pattern:
      - "best_trial\\.value(?!.*validate|.*full)"
    message: "Validate best NAS result on full task, not just proxy."
    fix_action: "Retrain best architecture on full dataset and evaluate."
    applies_to:
      - "**/*nas*.py"
      - "**/*search*.py"
