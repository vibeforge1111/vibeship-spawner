validations:

  - id: tip-reuse-different-samples
    name: Tip Reuse Between Different Samples
    severity: warning
    type: regex
    pattern:
      - "new_tip.*=.*['\"]?never['\"]?"
      - "for.*sample.*in.*samples(?![\\s\\S]{0,100}pick_up_tip)"
    message: "Change tips between different samples to prevent cross-contamination."
    fix_action: "Use new_tip='always' or add pick_up_tip() in loop"
    applies_to:
      - "**/*.py"

  - id: no-dead-volume-consideration
    name: Reagent Volume Without Dead Volume
    severity: info
    type: regex
    pattern:
      - "volume.*=.*\\d+\\s*\\*\\s*\\d+(?![\\s\\S]{0,100}dead|extra|margin)"
    message: "Add dead volume allowance when calculating reagent needs."
    applies_to:
      - "**/*.py"

  - id: edge-well-controls
    name: Controls in Edge Wells
    severity: info
    type: regex
    pattern:
      - "control.*['\"][AH][1-9]|1[0-2]['\"]"
      - "standard.*A1|H12|A12|H1"
    message: "Consider placing critical controls in inner wells to avoid edge effects."
    applies_to:
      - "**/*.py"
      - "**/*.json"

  - id: no-blow-out
    name: Dispense Without Blow-Out
    severity: info
    type: regex
    pattern:
      - "dispense\\([^)]*\\)(?![\\s\\S]{0,50}blow_out)"
    message: "Consider adding blow_out() after dispense for complete liquid transfer."
    applies_to:
      - "**/*.py"

  - id: hardcoded-deck-position
    name: Hardcoded Deck Position Without Label
    severity: info
    type: regex
    pattern:
      - "load_labware\\([^,]+,\\s*['\"]\\d+['\"]\\s*\\)(?![\\s\\S]{0,50}label)"
    message: "Add descriptive labels to labware for better protocol readability."
    fix_action: "Add label='Descriptive Name' parameter"
    applies_to:
      - "**/*.py"

  - id: no-error-handling
    name: Protocol Without Error Handling
    severity: warning
    type: regex
    pattern:
      - "def run\\(protocol(?![\\s\\S]{0,500}try:|except|pause)"
    message: "Add error handling and pause points for error recovery."
    applies_to:
      - "**/*.py"

  - id: no-protocol-metadata
    name: Protocol Missing Metadata
    severity: info
    type: regex
    pattern:
      - "def run\\(protocol(?![\\s\\S]{0,200}metadata.*=)"
    message: "Include metadata dict with protocolName, author, apiLevel."
    applies_to:
      - "**/*.py"

  - id: aspirate-bottom-zero
    name: Aspirating from Bottom of Well
    severity: info
    type: regex
    pattern:
      - "\\.bottom\\(0\\)|bottom\\(\\s*\\)"
    message: "Aspirate from bottom(1) or higher to avoid tip contact with well bottom."
    fix_action: "Use .bottom(1) instead of .bottom() or .bottom(0)"
    applies_to:
      - "**/*.py"

  - id: viscous-liquid-fast-rate
    name: Fast Rate for Viscous Liquids
    severity: warning
    type: regex
    pattern:
      - "(glycerol|dmso|serum).*aspirate(?![\\s\\S]{0,100}rate.*0\\.[0-3])"
    message: "Use slower aspirate/dispense rates for viscous liquids."
    applies_to:
      - "**/*.py"
