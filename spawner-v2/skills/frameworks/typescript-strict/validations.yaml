# TypeScript Strict Mode Validations
# Checks that run on code to catch issues

validations:
  - id: ts-any-usage
    name: Using 'any' Type
    severity: warning
    type: regex
    pattern:
      - ': any(?!\w)'
      - 'as any'
      - '<any>'
    message: "Using 'any' defeats type safety. Use 'unknown' or define a proper type."
    fix_action: "Replace 'any' with 'unknown' and add type guards, or define specific type"
    applies_to:
      - "*.ts"
      - "*.tsx"

  - id: ts-non-null-assertion
    name: Non-Null Assertion Operator
    severity: warning
    type: regex
    pattern:
      - '\w+!\.'
      - '\w+!\['
      - '\)!\.'
    message: "Non-null assertion (!) can cause runtime errors. Use optional chaining or proper checks."
    fix_action: "Use optional chaining (?.) or add explicit null/undefined check"
    applies_to:
      - "*.ts"
      - "*.tsx"

  - id: ts-ignore-comment
    name: Using @ts-ignore
    severity: error
    type: regex
    pattern:
      - '@ts-ignore'
      - '@ts-nocheck'
    message: "Suppressing TypeScript errors hides bugs. Fix the type error properly."
    fix_action: "Remove @ts-ignore and fix the underlying type issue"
    applies_to:
      - "*.ts"
      - "*.tsx"

  - id: ts-expect-error-no-description
    name: "@ts-expect-error Without Description"
    severity: warning
    type: regex
    pattern:
      - '@ts-expect-error(?!\s+\w)'
    message: "@ts-expect-error should have a description explaining why it's needed."
    fix_action: "Add explanation: // @ts-expect-error - reason why this is expected"
    applies_to:
      - "*.ts"
      - "*.tsx"

  - id: ts-type-assertion-danger
    name: Type Assertion to Complex Type
    severity: warning
    type: regex
    pattern:
      - 'as (?!const)[A-Z][a-zA-Z]+(?:<|\\[|\\{)'
    message: "Type assertion to complex type may hide type mismatches. Consider type guards."
    fix_action: "Use type guard function or Zod schema for runtime validation"
    applies_to:
      - "*.ts"
      - "*.tsx"

  - id: ts-strict-disabled
    name: Strict Mode Disabled
    severity: error
    type: regex
    pattern:
      - '"strict":\s*false'
      - '"noImplicitAny":\s*false'
      - '"strictNullChecks":\s*false'
    message: "TypeScript strict mode flags are disabled. Enable for better type safety."
    fix_action: "Set 'strict': true in tsconfig.json"
    applies_to:
      - "tsconfig.json"
      - "tsconfig.*.json"

  - id: ts-object-type
    name: Using object or Object Type
    severity: warning
    type: regex
    pattern:
      - ': object(?!\w)'
      - ': Object(?!\w)'
    message: "Using 'object' type is too broad. Define a specific interface or use Record."
    fix_action: "Replace with specific interface, Record<string, T>, or unknown"
    applies_to:
      - "*.ts"
      - "*.tsx"

  - id: ts-function-type
    name: Using Function Type
    severity: warning
    type: regex
    pattern:
      - ': Function(?!\w)'
    message: "Using 'Function' type loses parameter and return type information."
    fix_action: "Define specific function signature: (arg: Type) => ReturnType"
    applies_to:
      - "*.ts"
      - "*.tsx"
