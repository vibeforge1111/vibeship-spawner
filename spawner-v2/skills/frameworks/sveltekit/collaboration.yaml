id: sveltekit-collaboration
skill: sveltekit
version: 1.0.0

prerequisites:
  required:
    - name: Node.js
      version: ">=18.0.0"
      check: "node --version"
      install_url: https://nodejs.org/

    - name: npm or pnpm
      check: "npm --version || pnpm --version"

  recommended:
    - name: TypeScript knowledge
      description: SvelteKit works best with TypeScript for type safety in load functions

    - name: Basic Svelte understanding
      description: Understanding Svelte component syntax helps, but Svelte 5 runes are new

    - name: HTTP fundamentals
      description: Understanding of HTTP methods, cookies, headers for form actions and auth

project_setup:
  commands:
    - name: Create new SvelteKit project
      command: "npm create svelte@latest my-app"
      note: "Choose 'Skeleton project' with TypeScript and ESLint"

    - name: Install dependencies
      command: "cd my-app && npm install"

    - name: Start dev server
      command: "npm run dev"

  structure: |
    src/
    ├── routes/           # File-based routing
    │   ├── +page.svelte     # Page component
    │   ├── +page.ts         # Universal load (runs on both)
    │   ├── +page.server.ts  # Server-only load
    │   ├── +layout.svelte   # Layout component
    │   ├── +layout.server.ts
    │   ├── +error.svelte    # Error boundary
    │   └── api/
    │       └── +server.ts   # API endpoint
    ├── lib/              # Shared code ($lib alias)
    │   ├── components/
    │   ├── server/       # Server-only code ($lib/server)
    │   └── utils/
    ├── app.html          # HTML template
    ├── app.d.ts          # Type declarations
    └── hooks.server.ts   # Server hooks (middleware)

delegation_triggers:
  - trigger: "database setup|supabase|prisma|drizzle"
    delegate_to: supabase-backend
    context: "User needs database integration with SvelteKit"
    handoff_data:
      - "SvelteKit uses +page.server.ts for database queries"
      - "Never import database clients in +page.ts"
      - "Use hooks.server.ts for connection pooling"

  - trigger: "styling|tailwind|css|design system"
    delegate_to: tailwind-ui
    context: "User needs styling help"
    handoff_data:
      - "SvelteKit uses Vite, Tailwind integrates via postcss"
      - "Use class: directive in Svelte 5 for dynamic classes"

  - trigger: "deploy|vercel|netlify|cloudflare|railway"
    delegate_to: vercel-deployment
    context: "User needs deployment configuration"
    handoff_data:
      - "SvelteKit requires an adapter for each platform"
      - "adapter-auto detects platform but explicit is better"
      - "Environment variables need PUBLIC_ prefix for client access"

  - trigger: "authentication|auth|login|session"
    delegate_to: auth-flow
    context: "User needs authentication implementation"
    handoff_data:
      - "Use hooks.server.ts handle function for session checking"
      - "Store user in event.locals for access in load functions"
      - "Auth checks MUST be in +page.server.ts, never +page.ts"

  - trigger: "payments|stripe|subscriptions"
    delegate_to: stripe-integration
    context: "User needs payment integration"
    handoff_data:
      - "Stripe webhooks go in src/routes/api/webhooks/stripe/+server.ts"
      - "Use request.text() for raw body (signature verification)"
      - "Form actions work great for checkout initiation"

cross_domain_insights:
  - domain: React developers
    insight: |
      Coming from React, these are the key mental model shifts:
      - No useState/useEffect → Use $state and $effect runes
      - No Context → Use $page.data from parent layouts
      - No useRouter → Use goto() and $page from $app/stores
      - No API routes for forms → Use form actions with use:enhance
      - No getServerSideProps → Use +page.server.ts load functions
      - Components are .svelte files with <script>, template, and <style>

  - domain: Vue developers
    insight: |
      Coming from Vue, these translations help:
      - ref() → $state()
      - computed() → $derived()
      - watch() → $effect()
      - <script setup> → <script> with $props()
      - Nuxt pages → +page.svelte files
      - useFetch → +page.ts load functions

  - domain: Next.js developers
    insight: |
      Coming from Next.js, key differences:
      - getServerSideProps → +page.server.ts load function
      - API routes → +server.ts files OR form actions
      - Middleware → hooks.server.ts handle function
      - 'use server' → Not needed, +page.server.ts is always server
      - useRouter → goto() from $app/navigation
      - Image component → Use img with Vite image optimization

  - domain: Backend developers
    insight: |
      For backend devs new to SvelteKit:
      - +page.server.ts is your server code (safe for secrets)
      - +page.ts runs on BOTH server and client (no secrets!)
      - hooks.server.ts is like middleware (runs on every request)
      - Form actions handle POST/PUT/DELETE with automatic CSRF
      - event.locals is your request-scoped storage (like req.locals in Express)
      - SvelteKit does SSR by default, pages are HTML first, then hydrate

common_combinations:
  - name: Full-stack SaaS
    skills:
      - sveltekit
      - supabase-backend
      - tailwind-ui
      - stripe-integration
      - auth-flow
    notes: "Standard SaaS stack with SvelteKit. Auth in hooks, payments via Stripe, Supabase for DB."

  - name: Static marketing site
    skills:
      - sveltekit
      - tailwind-ui
    config:
      adapter: adapter-static
      prerender: true
    notes: "Set ssr=true and prerender=true in +layout.ts for full static generation."

  - name: API with minimal UI
    skills:
      - sveltekit
      - supabase-backend
    notes: "Heavy use of +server.ts files. Consider if you even need SvelteKit vs plain Hono/Express."

version_compatibility:
  svelte: ">=5.0.0"
  sveltekit: ">=2.0.0"
  vite: ">=5.0.0"
  node: ">=18.0.0"
  notes: |
    This skill is for Svelte 5 with runes. Key changes from Svelte 4:
    - export let → $props()
    - $: reactive → $derived()
    - $: statements → $effect()
    - on:click → onclick
    - slot → @render with snippets

    If working with Svelte 4 code, migration guide: https://svelte.dev/docs/svelte/v5-migration-guide
