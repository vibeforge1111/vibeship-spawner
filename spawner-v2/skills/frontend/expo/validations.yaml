# Expo Validations

validations:
  - id: missing-scheme
    name: Missing URL Scheme
    severity: medium
    type: regex
    pattern: '"expo"\s*:\s*\{'
    negative_pattern: '"scheme"\s*:'
    message: "App should have URL scheme for deep linking."
    fix_action: "Add 'scheme': 'myapp' to expo config"
    applies_to:
      - "app.json"
      - "app.config.js"

  - id: hardcoded-api-key
    name: Hardcoded API Key in Config
    severity: high
    type: regex
    pattern: '(apiKey|API_KEY|secret)["\']?\s*[:=]\s*["\'][a-zA-Z0-9_-]{20,}'
    message: "API keys should not be hardcoded. Use environment variables."
    fix_action: "Use EAS secrets or expo-constants for runtime config"
    applies_to:
      - "*.json"
      - "*.js"
      - "*.ts"

  - id: no-error-boundary
    name: Missing Error Boundary
    severity: medium
    type: regex
    pattern: 'export default function \w+Layout'
    negative_pattern: 'ErrorBoundary'
    message: "Root layout should have error boundary for crash protection."
    fix_action: "Add ErrorBoundary component to catch rendering errors"
    applies_to:
      - "_layout.tsx"
      - "_layout.js"

  - id: console-log-production
    name: Console Logs in Production Code
    severity: low
    type: regex
    pattern: 'console\.(log|debug|info)\('
    negative_pattern: '__DEV__|if.*DEV'
    message: "Console logs should be wrapped in __DEV__ check."
    fix_action: "Use if (__DEV__) console.log() or remove"
    applies_to:
      - "*.tsx"
      - "*.ts"
      - "*.jsx"
      - "*.js"

  - id: react-native-image
    name: Using React Native Image for Remote
    severity: medium
    type: regex
    pattern: "import.*Image.*from ['\"]react-native['\"]"
    message: "expo-image is faster and has caching for remote images."
    fix_action: "Use Image from 'expo-image' for remote images"
    applies_to:
      - "*.tsx"
      - "*.jsx"

  - id: flatlist-no-keyextractor
    name: FlatList Without keyExtractor
    severity: medium
    type: regex
    pattern: '<FlatList[^>]*data='
    negative_pattern: 'keyExtractor'
    message: "FlatList needs keyExtractor for performance."
    fix_action: "Add keyExtractor={(item) => item.id}"
    applies_to:
      - "*.tsx"
      - "*.jsx"

  - id: no-splash-config
    name: Missing Splash Screen Config
    severity: low
    type: regex
    pattern: '"expo"\s*:'
    negative_pattern: '"splash"\s*:'
    message: "App should have splash screen configuration."
    fix_action: "Add splash configuration with image and backgroundColor"
    applies_to:
      - "app.json"

  - id: no-runtime-version
    name: Missing Runtime Version for Updates
    severity: medium
    type: regex
    pattern: '"updates"\s*:'
    negative_pattern: '"runtimeVersion"\s*:'
    message: "EAS Updates needs runtimeVersion configured."
    fix_action: "Add runtimeVersion policy in expo config"
    applies_to:
      - "app.json"
      - "app.config.js"
