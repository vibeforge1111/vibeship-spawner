id: security-hardening-collaboration
skill: security-hardening
version: 1.0.0

# ============================================================================
# RECEIVES FROM (Who delegates TO this skill)
# ============================================================================
receives_from:
  - skill: backend
    context: "Backend code needs security review"
    receives:
      - "API endpoints"
      - "Authentication logic"
      - "Database queries"
      - "Input handling"
    provides: "Security-hardened code patterns and vulnerability fixes"

  - skill: frontend
    context: "Frontend needs XSS prevention and secure coding"
    receives:
      - "User input handling"
      - "DOM manipulation code"
      - "API token storage"
      - "Form submissions"
    provides: "XSS prevention, secure storage patterns, CSRF protection"

  - skill: api-design-architect
    context: "API design needs security considerations"
    receives:
      - "API specifications"
      - "Authentication requirements"
      - "Authorization model"
    provides: "Secure API patterns, auth best practices, rate limiting"

  - skill: database-schema-design
    context: "Database needs security hardening"
    receives:
      - "Schema designs"
      - "Access patterns"
      - "Sensitive data fields"
    provides: "Encryption strategies, access control, data protection"

  - skill: ci-cd-pipeline
    context: "Pipeline needs security scanning"
    receives:
      - "Workflow files"
      - "Secret handling"
      - "Deployment targets"
    provides: "Security scanning integration, secret management, supply chain protection"

# ============================================================================
# DELEGATION TRIGGERS
# ============================================================================
delegation_triggers:
  - trigger: "api|endpoint|backend"
    delegate_to: backend
    pattern: sequential
    context: "Need backend implementation to secure"
    handoff_data:
      - "Security requirements"
      - "Threat model"
      - "Compliance needs"
    receive: "Backend code for security review"

  - trigger: "frontend|client|ui"
    delegate_to: frontend
    pattern: sequential
    context: "Need frontend implementation to secure"
    handoff_data:
      - "XSS prevention patterns"
      - "Secure storage requirements"
      - "CSRF protection needs"
    receive: "Frontend code for security review"

  - trigger: "database|schema|storage"
    delegate_to: database-schema-design
    pattern: sequential
    context: "Need database design for security"
    handoff_data:
      - "Encryption requirements"
      - "Access control patterns"
      - "Data classification"
    receive: "Database schema for security review"

  - trigger: "ci/cd|pipeline|deployment"
    delegate_to: ci-cd-pipeline
    pattern: parallel
    context: "Pipeline needs security integration"
    handoff_data:
      - "Security scanning tools"
      - "Secret management approach"
      - "Supply chain requirements"
    receive: "Pipeline configuration for security review"

  - trigger: "infrastructure|cloud|network"
    delegate_to: infrastructure-as-code
    pattern: parallel
    context: "Infrastructure needs security configuration"
    handoff_data:
      - "Network security requirements"
      - "IAM policies"
      - "Encryption at rest/transit"
    receive: "Infrastructure code for security review"

# ============================================================================
# FEEDBACK LOOPS
# ============================================================================
feedback_loops:
  receives_feedback_from:
    - skill: observability-sre
      signal: "Security events detected in production"
      action: "Analyze attack patterns, improve defenses"

    - skill: ci-cd-pipeline
      signal: "Security scan failures"
      action: "Fix vulnerabilities, update patterns"

    - skill: backend
      signal: "Authentication bypass or injection found"
      action: "Patch vulnerability, add validation"

    - skill: frontend
      signal: "XSS or data exposure reported"
      action: "Fix encoding, improve sanitization"

  sends_feedback_to:
    - skill: backend
      signal: "SQL injection or insecure query pattern"
      action: "Use parameterized queries, add validation"

    - skill: frontend
      signal: "XSS vulnerability or insecure DOM usage"
      action: "Use safe rendering methods, add sanitization"

    - skill: ci-cd-pipeline
      signal: "Secret exposure or supply chain risk"
      action: "Add secret scanning, pin dependencies"

    - skill: database-schema-design
      signal: "Sensitive data unencrypted"
      action: "Add encryption, review access patterns"

    - skill: api-design-architect
      signal: "Missing authentication or authorization"
      action: "Add auth middleware, define access rules"

# ============================================================================
# CROSS-DOMAIN INSIGHTS
# ============================================================================
cross_domain_insights:
  - domain: Incident Response
    insight: |
      Incident responders know the true cost of vulnerabilities:
      - A single SQL injection can expose entire database
      - Credential stuffing targets the weakest link
      - Mean time to detect breaches: 200+ days average
      - Recovery costs 10-100x prevention costs
      Security is about preventing the worst case.
    applies_when: "Prioritizing security investments"

  - domain: Compliance Engineering
    insight: |
      Compliance engineers see security through regulatory lens:
      - GDPR, SOC2, HIPAA have real penalties
      - Security controls must be auditable
      - Logging and monitoring are required
      - Data classification drives protection levels
      Compliance is minimum baseline, not ceiling.
    applies_when: "Meeting regulatory requirements"

  - domain: Penetration Testing
    insight: |
      Pentesters know what attackers target:
      - Authentication is always tested first
      - IDOR is most commonly found vulnerability
      - Default credentials still work surprisingly often
      - Social engineering bypasses technical controls
      Think like an attacker to defend like one.
    applies_when: "Identifying attack surface"

  - domain: DevOps Engineering
    insight: |
      DevOps engineers see security in the pipeline:
      - Secrets in logs is #1 exposure source
      - Dependencies are the biggest attack vector
      - Runtime configuration differs from test
      - Containers inherit host vulnerabilities
      Secure the pipeline, secure the product.
    applies_when: "Securing deployment processes"

  - domain: Site Reliability Engineering
    insight: |
      SREs understand security as reliability:
      - DDoS is an availability attack
      - Breaches cause outages
      - Security patches require deployment capability
      - Incident response needs observability
      Security and reliability are inseparable.
    applies_when: "Building resilient systems"

# ============================================================================
# COMMON COMBINATIONS
# ============================================================================
common_combinations:
  - name: Secure API Development
    skills:
      - security-hardening
      - backend
      - api-design-architect
    workflow: |
      1. Design API with security in mind (api-design-architect)
      2. Implement with secure patterns (backend)
      3. Review for vulnerabilities (security-hardening)
      4. Add authentication and authorization
      5. Configure security headers

  - name: Full-Stack Security
    skills:
      - security-hardening
      - frontend
      - backend
    workflow: |
      1. Secure frontend input handling (frontend)
      2. Secure backend processing (backend)
      3. Security review of both layers (security-hardening)
      4. XSS prevention on frontend
      5. Injection prevention on backend

  - name: Secure Database Integration
    skills:
      - security-hardening
      - database-schema-design
      - backend
    workflow: |
      1. Design schema with encryption (database-schema-design)
      2. Implement secure queries (backend)
      3. Review for injection and access control (security-hardening)
      4. Add data masking for sensitive fields
      5. Configure database security

  - name: Security-First CI/CD
    skills:
      - security-hardening
      - ci-cd-pipeline
      - infrastructure-as-code
    workflow: |
      1. Configure secret management (ci-cd-pipeline)
      2. Add security scanning (security-hardening)
      3. Secure infrastructure deployment (infrastructure-as-code)
      4. Pin all dependencies
      5. Configure supply chain protection

  - name: Authentication System
    skills:
      - security-hardening
      - backend
      - database-schema-design
    workflow: |
      1. Design user schema with password hashing (database-schema-design)
      2. Implement auth endpoints (backend)
      3. Security review of auth flow (security-hardening)
      4. Add rate limiting and lockout
      5. Configure secure session handling

# ============================================================================
# ECOSYSTEM
# ============================================================================
ecosystem:
  primary_tools:
    - "OWASP ZAP - Web application security scanner"
    - "Snyk - Dependency vulnerability scanning"
    - "Trivy - Container security scanning"
    - "Gitleaks - Secret detection"
    - "Semgrep/Opengrep - Static analysis"
    - "Burp Suite - Penetration testing"

  security_frameworks:
    - name: OWASP Top 10
      use_when: "Understanding common web vulnerabilities"
      focus: "Injection, XSS, broken auth, IDOR, misconfig"

    - name: CWE/SANS Top 25
      use_when: "Comprehensive vulnerability classification"
      focus: "Memory safety, injection, auth issues"

    - name: NIST Cybersecurity Framework
      use_when: "Enterprise security program"
      focus: "Identify, protect, detect, respond, recover"

    - name: OWASP ASVS
      use_when: "Application security verification"
      focus: "Verification requirements by level"

  auth_solutions:
    - name: bcrypt
      use_when: "Password hashing in any language"
      avoid_when: "Need extreme performance (use argon2id)"

    - name: argon2id
      use_when: "Modern password hashing, memory-hard requirement"
      avoid_when: "Legacy system compatibility needed"

    - name: JWT
      use_when: "Stateless auth, microservices, APIs"
      avoid_when: "Need immediate token revocation"

    - name: Session cookies
      use_when: "Traditional web apps, need revocation"
      avoid_when: "Stateless architecture required"

  scanning_tools:
    - name: Snyk
      use_when: "Dependency scanning, developer-friendly"
      integrates: "GitHub, npm, pip, Docker"

    - name: Dependabot
      use_when: "GitHub-native, automatic PRs for updates"
      integrates: "GitHub only"

    - name: Trivy
      use_when: "Container and IaC scanning, open source"
      integrates: "CI/CD, Kubernetes"

    - name: Semgrep/Opengrep
      use_when: "Custom static analysis rules"
      integrates: "CI/CD, IDE"

    - name: Gitleaks
      use_when: "Pre-commit secret detection"
      integrates: "Git hooks, CI/CD"

  compliance_frameworks:
    - name: SOC 2
      requires: "Access controls, encryption, monitoring, incident response"

    - name: GDPR
      requires: "Data protection, consent, right to erasure, breach notification"

    - name: HIPAA
      requires: "PHI protection, access logging, encryption"

    - name: PCI DSS
      requires: "Cardholder data protection, network security, access control"

