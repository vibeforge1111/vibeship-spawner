id: prompt-injection-defense-collaboration
skill: prompt-injection-defense
version: 1.0.0

receives_from:
  - skill: ai-code-security
    context: "Need specialized prompt injection defense"
    receives:
      - "LLM application architecture"
      - "Current security posture"
      - "Input sources to protect"
    provides: "Injection detection and prevention implementation"

  - skill: rag-implementation
    context: "RAG system needs injection protection"
    receives:
      - "Document retrieval pipeline"
      - "Content sources"
      - "Context building approach"
    provides: "Content sanitization and isolation strategy"

  - skill: context-window-management
    context: "Context handling needs injection awareness"
    receives:
      - "Context structure"
      - "Message handling"
    provides: "Injection-resistant context management"

delegation_triggers:
  - trigger: "code vulnerability|security scan"
    delegate_to: ai-code-security
    pattern: sequential
    context: "Need broader code security review"

  - trigger: "security audit|compliance"
    delegate_to: llm-security-audit
    pattern: sequential
    context: "Need comprehensive security assessment"

  - trigger: "mcp|tool security"
    delegate_to: mcp-security
    pattern: sequential
    context: "Need MCP-specific security patterns"

feedback_loops:
  receives_feedback_from:
    - skill: llm-security-audit
      signal: "New injection vectors discovered"
      action: "Update detection patterns and defense layers"

    - skill: ai-code-security
      signal: "Injection successful in production"
      action: "Analyze and add to detection rules"

  sends_feedback_to:
    - skill: rag-implementation
      signal: "Document injection patterns"
      action: "Improve document sanitization"

    - skill: context-window-management
      signal: "Context-based injection techniques"
      action: "Enhance context isolation"

    - skill: ai-code-security
      signal: "Defense effectiveness metrics"
      action: "Inform overall security posture"

cross_domain_insights:
  from_domains:
    - domain: sql-injection-defense
      insight: "Parameterized queries separate code from data"
      application: "Separate instructions from user content structurally"

    - domain: xss-prevention
      insight: "Output encoding prevents injection execution"
      application: "Sanitize and encode LLM outputs before use"

    - domain: threat-modeling
      insight: "Assume breach mentality"
      application: "Design for injection successâ€”limit blast radius"

common_combinations:
  - name: Complete Injection Defense Stack
    skills:
      - prompt-injection-defense
      - ai-code-security
      - llm-security-audit
    workflow: |
      1. Implement multi-layer input detection
      2. Add output behavior monitoring
      3. Limit LLM capabilities and tool access
      4. Regular security audits and red teaming

  - name: Secure RAG Pipeline
    skills:
      - prompt-injection-defense
      - rag-implementation
      - context-window-management
    workflow: |
      1. Sanitize all retrieved documents
      2. Isolate external content with markers
      3. Monitor for indirect injection patterns
      4. Validate LLM behavior post-retrieval

  - name: Secure Agent Development
    skills:
      - prompt-injection-defense
      - autonomous-agents
      - mcp-security
    workflow: |
      1. Implement tool call validation
      2. Limit agent capabilities to minimum
      3. Monitor for anomalous tool usage
      4. Human-in-the-loop for sensitive actions
