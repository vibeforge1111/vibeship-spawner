validations:

  - id: fixed-agent-order
    name: Fixed Agent Update Order
    severity: warning
    type: regex
    pattern:
      - "for\\s+agent\\s+in\\s+agents:\\s*\\n\\s+agent\\.(step|update|act)"
      - "for\\s+agent\\s+in\\s+self\\.agents(?!.*shuffle)"
    message: "Fixed agent order creates synchronization artifacts. Shuffle each step."
    fix_action: "Add: np.random.shuffle(agents) or random.shuffle(agents) before loop"
    applies_to:
      - "**/*.py"

  - id: quadratic-neighbor-search
    name: O(N^2) Neighbor Search
    severity: warning
    type: regex
    pattern:
      - "for.*agent.*in.*agents.*:\\s*\\n.*for.*other.*in.*agents"
      - "for.*in.*agents.*:\\s*\\n.*distance\\(.*,.*\\)"
    message: "O(N^2) neighbor search doesn't scale. Use spatial data structures."
    fix_action: "Use cKDTree, spatial hashing, or grid-based lookups"
    applies_to:
      - "**/*.py"

  - id: no-random-seed
    name: ABM Without Reproducible Random Seed
    severity: info
    type: regex
    pattern:
      - "class.*Environment.*:(?!.*seed|random_state)"
      - "def\\s+run.*simulation(?!.*seed)"
    message: "ABM results should be reproducible. Accept and use random seed."
    fix_action: "Add seed parameter: def __init__(self, seed=None): self.rng = np.random.default_rng(seed)"
    applies_to:
      - "**/*.py"

  - id: no-boundary-handling
    name: Missing Boundary Condition Handling
    severity: info
    type: regex
    pattern:
      - "position\\s*\\+=.*velocity(?!.*wrap|bound|clamp|periodic)"
    message: "Agent movement should handle environment boundaries."
    fix_action: "Add boundary handling: position = np.clip(position, 0, env_size) or periodic wrap"
    applies_to:
      - "**/*.py"

  - id: global-agent-list
    name: Global Mutable Agent List
    severity: warning
    type: regex
    pattern:
      - "^agents\\s*=\\s*\\[|^AGENTS\\s*="
      - "global\\s+agents"
    message: "Global agent list causes issues with multiple simulations."
    fix_action: "Use instance variable: self.agents in Environment class"
    applies_to:
      - "**/*.py"

  - id: no-metrics-collection
    name: Simulation Without Metrics Collection
    severity: info
    type: regex
    pattern:
      - "def\\s+step\\(.*\\):(?!.*metric|log|record|history)"
    message: "Collect metrics during simulation for analysis and validation."
    fix_action: "Add: self.history.append({'step': self.step, 'population': len(agents), ...})"
    applies_to:
      - "**/*.py"

  - id: deterministic-behavior
    name: Fully Deterministic Agent Behavior
    severity: info
    type: regex
    pattern:
      - "def\\s+decide\\(.*\\):(?!.*random|prob|np\\.random)"
    message: "Consider adding stochasticity to agent decisions for realism."
    fix_action: "Add exploration: if np.random.random() < epsilon: random_action()"
    applies_to:
      - "**/*.py"

  - id: no-validation-data
    name: ABM Without Validation Against Data
    severity: info
    type: regex
    pattern:
      - "class.*Model.*:(?!.*validate|empirical|target)"
    message: "ABM should be validated against empirical data or known patterns."
    fix_action: "Add validation: def validate(self, empirical_data): compare metrics"
    applies_to:
      - "**/*.py"

  - id: hardcoded-parameters
    name: Hardcoded Agent Parameters
    severity: info
    type: regex
    pattern:
      - "vision_range\\s*=\\s*\\d+\\.?\\d*(?!.*config|param)"
      - "speed\\s*=\\s*\\d+\\.?\\d*(?!.*config)"
    message: "Agent parameters should be configurable for sensitivity analysis."
    fix_action: "Accept parameters: def __init__(self, config): self.speed = config.speed"
    applies_to:
      - "**/*.py"

  - id: single-run-analysis
    name: Drawing Conclusions From Single Run
    severity: warning
    type: regex
    pattern:
      - "result\\s*=\\s*run_simulation\\(\\)\\s*\\n.*print.*result(?!.*replicate|mean)"
    message: "ABM results are stochastic. Run multiple replications for statistics."
    fix_action: "Run replications: results = [run() for _ in range(100)]; report mean, std"
    applies_to:
      - "**/*.py"
