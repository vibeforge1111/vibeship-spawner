# Next.js App Router Skill Test Cases
# Tests for: spawner-v2/skills/frameworks/nextjs-app-router

skill_id: nextjs-app-router
skill_path: frameworks/nextjs-app-router

tests:
  # Open-ended test - holistic skill application
  - id: nextjs-open-01
    type: open-ended
    name: Build a blog with App Router
    prompt: |
      Create a simple blog using Next.js App Router with:
      - A home page listing recent posts
      - Individual post pages with dynamic routes
      - Posts stored in markdown files
      - SEO metadata for each page

      Show the folder structure and key files needed.
    evaluation_criteria:
      - Correct use of Server vs Client Components
      - Proper file-based routing structure
      - Metadata API usage for SEO
      - Data fetching patterns (no unnecessary client-side fetching)
      - Understanding of when 'use client' is needed

  # Trap test 1 - targets async-client-component sharp edge
  - id: nextjs-trap-01
    type: trap
    name: Fix async client component error
    sharp_edge_targeted: nextjs-async-client-component
    prompt: |
      This component throws an error. The developer wants to fetch user data
      and show a button that uses onClick. Fix it:

      ```tsx
      'use client'

      async function UserCard({ userId }) {
        const user = await fetch(`/api/users/${userId}`).then(r => r.json())

        return (
          <div className="card">
            <h2>{user.name}</h2>
            <p>{user.email}</p>
            <button onClick={() => alert(`Hello ${user.name}!`)}>
              Greet
            </button>
          </div>
        )
      }

      export default UserCard
      ```
    expected_catch: |
      Should identify:
      1. Client Components cannot be async - they return Promise not JSX
      2. Explain WHY (browser execution, React component contract)
      3. Provide solution: useEffect + useState, or SWR/React Query, or
         split into Server Component parent + Client Component child
      Not just "remove async" without explaining the architecture.

  # Trap test 2 - targets server-import-in-client sharp edge
  - id: nextjs-trap-02
    type: trap
    name: Fix server import in client component
    sharp_edge_targeted: nextjs-server-import-in-client
    prompt: |
      This component fails to build with "Module not found" error. The developer
      wants to read from the database and have interactive features. Fix it:

      ```tsx
      'use client'

      import { db } from '@/lib/database'
      import { cookies } from 'next/headers'
      import { useState } from 'react'

      export default function Dashboard() {
        const [filter, setFilter] = useState('all')
        const session = cookies().get('session')
        const data = db.query('SELECT * FROM stats')

        return (
          <div>
            <select value={filter} onChange={(e) => setFilter(e.target.value)}>
              <option value="all">All</option>
              <option value="active">Active</option>
            </select>
            <StatsTable data={data} filter={filter} />
          </div>
        )
      }
      ```
    expected_catch: |
      Should identify:
      1. Can't import server-only modules (db, next/headers) in 'use client'
      2. Explain the Server/Client component boundary
      3. Provide architectural solution:
         - Server Component parent for data fetching
         - Client Component child for interactivity
         - Or Server Action pattern
      Not just "remove 'use client'" without handling the useState need.
