# Telegram Mini App Validations

validations:
  - id: no-init-validation
    name: No initData Validation
    severity: high
    type: conceptual
    check: "Backend should validate initData"
    indicators:
      - "No hash validation"
      - "Trusting initDataUnsafe"
      - "No server-side verification"
    message: "Not validating initData - security vulnerability."
    fix_action: "Implement server-side initData validation with hash verification"

  - id: no-telegram-script
    name: Missing Telegram Web App Script
    severity: high
    type: pattern
    check: "Should include Telegram Web App script"
    pattern: "telegram-web-app\\.js"
    indicators:
      - "No Telegram script loaded"
      - "window.Telegram undefined"
      - "tg.ready() fails"
    message: "Telegram Web App script not included."
    fix_action: "Add <script src='https://telegram.org/js/telegram-web-app.js'></script>"

  - id: no-tg-ready
    name: Not Calling tg.ready()
    severity: medium
    type: pattern
    check: "Should call tg.ready() on load"
    pattern: "tg\\.ready\\(\\)|WebApp\\.ready\\(\\)"
    indicators:
      - "No ready() call"
      - "App doesn't load properly"
      - "Telegram shows loading"
    message: "Not calling tg.ready() - Telegram may show loading state."
    fix_action: "Call window.Telegram.WebApp.ready() when app is ready"

  - id: no-theme-support
    name: Not Using Telegram Theme
    severity: medium
    type: pattern
    check: "Should adapt to Telegram theme"
    pattern: "tg-theme|themeParams"
    indicators:
      - "Hardcoded colors"
      - "No theme variables"
      - "Looks different from Telegram"
    message: "Not adapting to Telegram theme colors."
    fix_action: "Use CSS variables from tg.themeParams for colors"

  - id: no-viewport-meta
    name: Missing Viewport Meta Tag
    severity: medium
    type: pattern
    check: "Should have mobile viewport meta"
    pattern: "viewport.*width=device-width"
    indicators:
      - "No viewport meta"
      - "Zooming issues"
      - "Layout broken on mobile"
    message: "Missing viewport meta tag for mobile."
    fix_action: "Add <meta name='viewport' content='width=device-width, initial-scale=1.0'>"
